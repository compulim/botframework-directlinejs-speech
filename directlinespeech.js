window.DirectLine=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=98)}([function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o}));class n extends Error{constructor(e){super(e),this.name="ArgumentNull",this.message=e}}class i extends Error{constructor(e){super(e),this.name="InvalidOperation",this.message=e}}class o extends Error{constructor(e,t){super(t),this.name=e+"ObjectDisposed",this.message=t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(130);t.AudioConfig=n.AudioConfig;var i=r(31);t.AudioStreamFormat=i.AudioStreamFormat;var o=r(71);t.AudioInputStream=o.AudioInputStream,t.PullAudioInputStream=o.PullAudioInputStream,t.PushAudioInputStream=o.PushAudioInputStream;var s=r(131);t.CancellationReason=s.CancellationReason;var c=r(132);t.PullAudioInputStreamCallback=c.PullAudioInputStreamCallback;var a=r(133);t.KeywordRecognitionModel=a.KeywordRecognitionModel;var u=r(134);t.SessionEventArgs=u.SessionEventArgs;var p=r(135);t.RecognitionEventArgs=p.RecognitionEventArgs;var h=r(136);t.OutputFormat=h.OutputFormat;var l=r(137);t.IntentRecognitionEventArgs=l.IntentRecognitionEventArgs;var f=r(138);t.RecognitionResult=f.RecognitionResult;var v=r(139);t.SpeechRecognitionResult=v.SpeechRecognitionResult;var d=r(140);t.IntentRecognitionResult=d.IntentRecognitionResult;var g=r(141);t.LanguageUnderstandingModel=g.LanguageUnderstandingModel;var y=r(142);t.SpeechRecognitionEventArgs=y.SpeechRecognitionEventArgs;var m=r(143);t.SpeechRecognitionCanceledEventArgs=m.SpeechRecognitionCanceledEventArgs;var S=r(144);t.TranslationRecognitionEventArgs=S.TranslationRecognitionEventArgs;var b=r(145);t.TranslationSynthesisEventArgs=b.TranslationSynthesisEventArgs;var R=r(146);t.TranslationRecognitionResult=R.TranslationRecognitionResult;var w=r(147);t.TranslationSynthesisResult=w.TranslationSynthesisResult;var C=r(148);t.ResultReason=C.ResultReason;var P=r(149);t.SpeechConfig=P.SpeechConfig;var I=r(150);t.SpeechTranslationConfig=I.SpeechTranslationConfig;var E=r(151);t.PropertyCollection=E.PropertyCollection;var A=r(152);t.PropertyId=A.PropertyId;var O=r(153);t.Recognizer=O.Recognizer;var T=r(154);t.SpeechRecognizer=T.SpeechRecognizer;var _=r(156);t.IntentRecognizer=_.IntentRecognizer;var D=r(157);t.TranslationRecognizer=D.TranslationRecognizer;var x=r(158);t.Translations=x.Translations;var M=r(159);t.NoMatchReason=M.NoMatchReason;var N=r(160);t.NoMatchDetails=N.NoMatchDetails;var z=r(161);t.TranslationRecognitionCanceledEventArgs=z.TranslationRecognitionCanceledEventArgs;var j=r(162);t.IntentRecognitionCanceledEventArgs=j.IntentRecognitionCanceledEventArgs;var k=r(163);t.CancellationDetails=k.CancellationDetails;var L=r(164);t.CancellationErrorCode=L.CancellationErrorCode;var B=r(165);t.ConnectionEventArgs=B.ConnectionEventArgs;var F=r(166);t.Connection=F.Connection;var q=r(167);t.PhraseListGrammar=q.PhraseListGrammar},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(127)),n(r(128)),n(r(45)),n(r(129)),n(r(46)),n(r(168)),n(r(170)),n(r(171)),n(r(72)),n(r(172)),n(r(173)),n(r(174)),n(r(175)),n(r(176)),n(r(177)),n(r(178)),n(r(179)),n(r(180)),n(r(181)),n(r(182)),n(r(183)),n(r(184)),n(r(185)),n(r(186)),n(r(187)),n(r(189)),n(r(190)),t.OutputFormatPropertyName="OutputFormat",t.CancellationErrorCodePropertyName="CancellationErrorCode"},,function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(117)),n(r(118)),n(r(66)),n(r(119)),n(r(11)),n(r(120)),n(r(67)),n(r(18)),n(r(121)),n(r(68)),n(r(43)),n(r(69)),n(r(70)),n(r(122)),n(r(123)),n(r(124));var i=r(44);t.TranslationStatus=i.TranslationStatus,n(r(125))},function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return u}));var n,i=r(0);!function(e){e[e.None=0]="None",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(n||(n={}));class o{constructor(e){this.throwIfError=()=>{if(this.isError)throw this.error},e.on(e=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=e)},e=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=e)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}class s{constructor(){this.setResult=e=>{this.privOnSetResult(e)},this.setError=e=>{this.privOnSetError(e)},this.on=(e,t)=>{this.privOnSetResult=e,this.privOnSetError=t}}}class c{}c.whenAll=e=>{if(!e||0===e.length)throw new i.a("promises");const t=new u,r=[];let n=0;const o=()=>{++n===e.length&&(0===r.length?t.resolve(!0):t.reject(r.join(", ")))};for(const t of e)t.on(e=>{o()},e=>{r.push(e),o()});return t.promise()},c.fromResult=e=>{const t=new u;return t.resolve(e),t.promise()},c.fromError=e=>{const t=new u;return t.reject(e),t.promise()};class a{constructor(e){this.result=()=>this.privSink.result,this.continueWith=e=>{if(!e)throw new i.a("continuationCallback");const t=new u;return this.privSink.on(r=>{try{const r=e(this.privSink.result);t.resolve(r)}catch(e){t.reject(e)}},r=>{try{const r=e(this.privSink.result);t.resolve(r)}catch(e){t.reject(`'Error handler for error ${r} threw error ${e}'`)}}),t.promise()},this.onSuccessContinueWith=e=>{if(!e)throw new i.a("continuationCallback");const t=new u;return this.privSink.on(r=>{try{const n=e(r);t.resolve(n)}catch(e){t.reject(e)}},e=>{t.reject(e)}),t.promise()},this.continueWithPromise=e=>{if(!e)throw new i.a("continuationCallback");const t=new u;return this.privSink.on(r=>{try{const r=e(this.privSink.result);if(!r)throw new Error("'Continuation callback did not return promise'");r.on(e=>{t.resolve(e)},e=>{t.reject(e)})}catch(e){t.reject(e)}},r=>{try{const r=e(this.privSink.result);if(!r)throw new Error("Continuation callback did not return promise");r.on(e=>{t.resolve(e)},e=>{t.reject(e)})}catch(e){t.reject(`'Error handler for error ${r} threw error ${e}'`)}}),t.promise()},this.onSuccessContinueWithPromise=e=>{if(!e)throw new i.a("continuationCallback");const t=new u;return this.privSink.on(r=>{try{const n=e(r);if(!n)throw new Error("Continuation callback did not return promise");n.on(e=>{t.resolve(e)},e=>{t.reject(e)})}catch(e){t.reject(e)}},e=>{t.reject(e)}),t.promise()},this.on=(e,t)=>{if(!e)throw new i.a("successCallback");if(!t)throw new i.a("errorCallback");return this.privSink.on(e,t),this},this.finally=e=>{if(!e)throw new i.a("callback");const t=t=>{e()};return this.on(t,t)},this.privSink=e}}class u{constructor(){this.state=()=>this.privSink.state,this.promise=()=>this.privPromise,this.resolve=e=>(this.privSink.resolve(e),this),this.reject=e=>(this.privSink.reject(e),this),this.privSink=new p,this.privPromise=new a(this.privSink)}}class p{constructor(){this.privState=n.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.resolve=e=>{if(this.privState!==n.None)throw new Error("'Cannot resolve a completed promise'");this.privState=n.Resolved,this.privPromiseResultEvents.setResult(e);for(let t=0;t<this.privSuccessHandlers.length;t++)this.executeSuccessCallback(e,this.privSuccessHandlers[t],this.privErrorHandlers[t]);this.detachHandlers()},this.reject=e=>{if(this.privState!==n.None)throw new Error("'Cannot reject a completed promise'");this.privState=n.Rejected,this.privPromiseResultEvents.setError(e);for(const t of this.privErrorHandlers)this.executeErrorCallback(e,t);this.detachHandlers()},this.on=(e,t)=>{null==e&&(e=e=>{}),this.privState===n.None?(this.privSuccessHandlers.push(e),this.privErrorHandlers.push(t)):(this.privState===n.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,e,t):this.privState===n.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,t),this.detachHandlers())},this.executeSuccessCallback=(e,t,r)=>{try{t(e)}catch(e){this.executeErrorCallback(`'Unhandled callback error: ${e}'`,r)}},this.executeErrorCallback=(e,t)=>{if(!t)throw new Error(`'Unhandled error: ${e}'`);try{t(e)}catch(t){throw new Error(`'Unhandled callback error: ${t}. InnerError: ${e}'`)}},this.detachHandlers=()=>{this.privErrorHandlers=[],this.privSuccessHandlers=[]},this.privPromiseResultEvents=new s,this.privPromiseResult=new o(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}}},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));const n=()=>{let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)})},i=()=>n().replace(new RegExp("-","g"),"").toUpperCase()},function(e,t,r){(function(t){var r="object",n=function(e){return e&&e.Math==Math&&e};e.exports=n(typeof globalThis==r&&globalThis)||n(typeof window==r&&window)||n(typeof self==r&&self)||n(typeof t==r&&t)||Function("return this")()}).call(this,r(63))},function(e,t,r){var n=r(8),i=r(34),o=r(84),s=r(225),c=n.Symbol,a=i("wks");e.exports=function(e){return a[e]||(a[e]=s&&c[e]||(s?c:o)("Symbol."+e))}},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"}(n||(n={}))},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var r=e.call(this,t)||this;return r.name="ArgumentNull",r.message=t,r}return i(t,e),t}(Error);t.ArgumentNullError=o;var s=function(e){function t(t){var r=e.call(this,t)||this;return r.name="InvalidOperation",r.message=t,r}return i(t,e),t}(Error);t.InvalidOperationError=s;var c=function(e){function t(t,r){var n=e.call(this,r)||this;return n.name=t+"ObjectDisposed",n.message=r,n}return i(t,e),t}(Error);t.ObjectDisposedError=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.throwIfNullOrUndefined=function(e,t){if(null==e)throw new Error("throwIfNullOrUndefined:"+t)},e.throwIfNull=function(e,t){if(null===e)throw new Error("throwIfNull:"+t)},e.throwIfNullOrWhitespace=function(t,r){if(e.throwIfNullOrUndefined(t,r),(""+t).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+r)},e.throwIfDisposed=function(e){if(e)throw new Error("the object is already disposed")},e.throwIfArrayEmptyOrWhitespace=function(t,r){if(e.throwIfNullOrUndefined(t,r),0===t.length)throw new Error("throwIfArrayEmptyOrWhitespace:"+r);for(var n=0,i=t;n<i.length;n++){var o=i[n];e.throwIfNullOrWhitespace(o,r)}},e.throwIfFileDoesNotExist=function(t,r){e.throwIfNullOrWhitespace(t,r)},e}();t.Contracts=n},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var n=r(19),i=r(20),o=r(47);e.exports=n?function(e,t,r){return i.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var n=r(24);e.exports=function(e){if(!n(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n,i=r(7);!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(n||(n={}));class o{constructor(e,t){this.privName=e,this.privEventId=Object(i.b)(),this.privEventTime=(new Date).toISOString(),this.privEventType=t,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)}))};t.createGuid=n;t.createNoDashGuid=function(){return n().replace(new RegExp("-","g"),"").toUpperCase()}},function(e,t,r){var n=r(23);e.exports=!n((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,r){var n=r(19),i=r(81),o=r(15),s=r(80),c=Object.defineProperty;t.f=n?c:function(e,t,r){if(o(e),t=s(t,!0),o(r),i)try{return c(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return s}));var n,i=r(0),o=r(7);!function(e){e[e.Text=0]="Text",e[e.Binary=1]="Binary"}(n||(n={}));class s{constructor(e,t,r,s){if(this.privBody=null,e===n.Text&&t&&"string"!=typeof t)throw new i.b("Payload must be a string");if(e===n.Binary&&t&&!(t instanceof ArrayBuffer))throw new i.b("Payload must be ArrayBuffer");this.privMessageType=e,this.privBody=t,this.privHeaders=r||{},this.privId=s||Object(o.b)()}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===n.Binary)throw new i.b("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===n.Text)throw new i.b("Not supported for text message");return this.privBody}get id(){return this.privId}}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(116)),n(r(126)),n(r(191)),n(r(192)),n(r(193)),n(r(73)),n(r(197)),n(r(198))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){"use strict";r.d(t,"f",(function(){return o})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return p}));var n=r(16);class i extends n.b{constructor(e,t,r=n.a.Info){super(e,r),this.privConnectionId=t}get connectionId(){return this.privConnectionId}}class o extends i{constructor(e,t,r){super("ConnectionStartEvent",e),this.privUri=t,this.privHeaders=r}get uri(){return this.privUri}get headers(){return this.privHeaders}}class s extends i{constructor(e,t){super("ConnectionEstablishedEvent",e)}}class c extends i{constructor(e,t,r){super("ConnectionClosedEvent",e,n.a.Debug),this.privRreason=r,this.privStatusCode=t}get reason(){return this.privRreason}get statusCode(){return this.privStatusCode}}class a extends i{constructor(e,t,r){super("ConnectionEstablishErrorEvent",e,n.a.Error),this.privStatusCode=t,this.privReason=r}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class u extends i{constructor(e,t,r){super("ConnectionMessageReceivedEvent",e),this.privNetworkReceivedTime=t,this.privMessage=r}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}class p extends i{constructor(e,t,r){super("ConnectionMessageSentEvent",e),this.privNetworkSentTime=t,this.privMessage=r}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}},function(e,t,r){e.exports=r(104)},function(e,t){function r(e,t,r,n,i,o,s){try{var c=e[o](s),a=c.value}catch(e){return void r(e)}c.done?t(a):Promise.resolve(a).then(n,i)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function c(e){r(s,i,o,c,a,"next",e)}function a(e){r(s,i,o,c,a,"throw",e)}c(void 0)}))}}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){e.exports={}},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.getDefaultInputFormat=function(){return s.getDefaultInputFormat()},e.getWaveFormatPCM=function(e,t,r){return new s(e,t,r)},e}();t.AudioStreamFormat=o;var s=function(e){function t(t,r,n){void 0===t&&(t=16e3),void 0===r&&(r=16),void 0===n&&(n=1);var i=e.call(this)||this;return i.formatTag=1,i.bitsPerSample=r,i.samplesPerSec=t,i.channels=n,i.avgBytesPerSec=i.samplesPerSec*i.channels*(i.bitsPerSample/8),i.blockAlign=i.channels*Math.max(i.bitsPerSample,8),i}return i(t,e),t.getDefaultInputFormat=function(){return new t},t.prototype.close=function(){},t}(o);t.AudioStreamFormatImpl=s},function(e,t,r){var n=r(215),i=r(48);e.exports=function(e){return n(i(e))}},function(e,t,r){var n=r(8),i=r(34),o=r(14),s=r(13),c=r(49),a=r(83),u=r(35),p=u.get,h=u.enforce,l=String(a).split("toString");i("inspectSource",(function(e){return a.call(e)})),(e.exports=function(e,t,r,i){var a=!!i&&!!i.unsafe,u=!!i&&!!i.enumerable,p=!!i&&!!i.noTargetGet;"function"==typeof r&&("string"!=typeof t||s(r,"name")||o(r,"name",t),h(r).source=l.join("string"==typeof t?t:"")),e!==n?(a?!p&&e[t]&&(u=!0):delete e[t],u?e[t]=r:o(e,t,r)):u?e[t]=r:c(t,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&p(this).source||a.call(this)}))},function(e,t,r){var n=r(8),i=r(49),o=r(50),s=n["__core-js_shared__"]||i("__core-js_shared__",{});(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.2.1",mode:o?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,r){var n,i,o,s=r(216),c=r(8),a=r(24),u=r(14),p=r(13),h=r(51),l=r(52),f=c.WeakMap;if(s){var v=new f,d=v.get,g=v.has,y=v.set;n=function(e,t){return y.call(v,e,t),t},i=function(e){return d.call(v,e)||{}},o=function(e){return g.call(v,e)}}else{var m=h("state");l[m]=!0,n=function(e,t){return u(e,m,t),t},i=function(e){return p(e,m)?e[m]:{}},o=function(e){return p(e,m)}}e.exports={set:n,get:i,has:o,enforce:function(e){return o(e)?i(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!a(t)||(r=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}}},function(e,t,r){"use strict";var n=r(0);class i{constructor(e){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.get=e=>(this.throwIfDisposed(),this.privList[e]),this.first=()=>this.get(0),this.last=()=>this.get(this.length()-1),this.add=e=>{this.throwIfDisposed(),this.insertAt(this.privList.length,e)},this.insertAt=(e,t)=>{this.throwIfDisposed(),0===e?this.privList.unshift(t):e===this.privList.length?this.privList.push(t):this.privList.splice(e,0,t),this.triggerSubscriptions(this.privAddSubscriptions)},this.removeFirst=()=>(this.throwIfDisposed(),this.removeAt(0)),this.removeLast=()=>(this.throwIfDisposed(),this.removeAt(this.length()-1)),this.removeAt=e=>(this.throwIfDisposed(),this.remove(e,1)[0]),this.remove=(e,t)=>{this.throwIfDisposed();const r=this.privList.splice(e,t);return this.triggerSubscriptions(this.privRemoveSubscriptions),r},this.clear=()=>{this.throwIfDisposed(),this.remove(0,this.length())},this.length=()=>(this.throwIfDisposed(),this.privList.length),this.onAdded=e=>{this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[t]=e,{detach:()=>{delete this.privAddSubscriptions[t]}}},this.onRemoved=e=>{this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[t]=e,{detach:()=>{delete this.privRemoveSubscriptions[t]}}},this.onDisposed=e=>{this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[t]=e,{detach:()=>{delete this.privDisposedSubscriptions[t]}}},this.join=e=>(this.throwIfDisposed(),this.privList.join(e)),this.toArray=()=>{const e=Array();return this.privList.forEach(t=>{e.push(t)}),e},this.any=e=>(this.throwIfDisposed(),e?this.where(e).length()>0:this.length()>0),this.all=e=>(this.throwIfDisposed(),this.where(e).length()===this.length()),this.forEach=e=>{this.throwIfDisposed();for(let t=0;t<this.length();t++)e(this.privList[t],t)},this.select=e=>{this.throwIfDisposed();const t=[];for(let r=0;r<this.privList.length;r++)t.push(e(this.privList[r],r));return new i(t)},this.where=e=>{this.throwIfDisposed();const t=new i;for(let r=0;r<this.privList.length;r++)e(this.privList[r],r)&&t.add(this.privList[r]);return t},this.orderBy=e=>{this.throwIfDisposed();const t=this.toArray().sort(e);return new i(t)},this.orderByDesc=e=>(this.throwIfDisposed(),this.orderBy((t,r)=>e(r,t))),this.clone=()=>(this.throwIfDisposed(),new i(this.toArray())),this.concat=e=>(this.throwIfDisposed(),new i(this.privList.concat(e.toArray()))),this.concatArray=e=>(this.throwIfDisposed(),new i(this.privList.concat(e))),this.isDisposed=()=>null==this.privList,this.dispose=e=>{this.isDisposed()||(this.privDisposeReason=e,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))},this.throwIfDisposed=()=>{if(this.isDisposed())throw new n.c("List",this.privDisposeReason)},this.triggerSubscriptions=e=>{if(e)for(const t in e)t&&e[t]()},this.privList=[],e)for(const t of e)this.privList.push(t)}}var o,s=r(5);r.d(t,"a",(function(){return c})),function(e){e[e.Dequeue=0]="Dequeue",e[e.Peek=1]="Peek"}(o||(o={}));class c{constructor(e){this.privPromiseStore=new i,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.enqueue=e=>{this.throwIfDispose(),this.enqueueFromPromise(s.b.fromResult(e))},this.enqueueFromPromise=e=>{this.throwIfDispose(),this.privPromiseStore.add(e),e.finally(()=>{for(;this.privPromiseStore.length()>0&&this.privPromiseStore.first().result().isCompleted;){const e=this.privPromiseStore.removeFirst();e.result().isError||this.privList.add(e.result().result)}})},this.dequeue=()=>{this.throwIfDispose();const e=new s.a;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:o.Dequeue}),this.drain()),e.promise()},this.peek=()=>{this.throwIfDispose();const e=new s.a;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:o.Peek}),this.drain()),e.promise()},this.length=()=>(this.throwIfDispose(),this.privList.length()),this.isDisposed=()=>null==this.privSubscribers,this.drainAndDispose=(e,t)=>{if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=t,this.privIsDisposing=!0;const r=this.privSubscribers;if(r){for(;r.length()>0;){r.removeFirst().deferral.resolve(void 0)}this.privSubscribers===r&&(this.privSubscribers=r)}for(const e of this.privDetachables)e.detach();if(this.privPromiseStore.length()>0&&e)return s.b.whenAll(this.privPromiseStore.toArray()).continueWith(()=>(this.privSubscribers=null,this.privList.forEach((t,r)=>{e(t)}),this.privList=null,!0));this.privSubscribers=null,this.privList=null}return s.b.fromResult(!0)},this.dispose=e=>{this.drainAndDispose(null,e)},this.drain=()=>{if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const e=this.privSubscribers,t=this.privList;if(e&&t){for(;t.length()>0&&e.length()>0&&!this.privIsDisposing;){const r=e.removeFirst();if(r.type===o.Peek)r.deferral.resolve(t.first());else{const e=t.removeFirst();r.deferral.resolve(e)}}this.privSubscribers===e&&(this.privSubscribers=e),this.privList===t&&(this.privList=t)}this.privIsDrainInProgress=!1}},this.throwIfDispose=()=>{if(this.isDisposed()){if(this.privDisposeReason)throw new n.b(this.privDisposeReason);throw new n.c("Queue")}if(this.privIsDisposing)throw new n.b("Queue disposing")},this.privList=e||new i,this.privDetachables=[],this.privSubscribers=new i,this.privDetachables.push(this.privList.onAdded(this.drain))}}},function(e,t){function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}e.exports=function(e){if(e&&e.__esModule)return e;var t=r();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}}return n.default=e,t&&t.set(e,n),n}},function(e,t,r){var n=r(39),i=r(105);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?i(e):t}},function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(t){return"function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?e.exports=n=function(e){return r(e)}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)},n(t)}e.exports=n},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}e.exports=r},function(e,t,r){var n=r(106);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(18);!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(t.EventType||(t.EventType={}));var i=function(){function e(e,t){this.privName=e,this.privEventId=n.createNoDashGuid(),this.privEventTime=(new Date).toISOString(),this.privEventType=t,this.privMetadata={}}return Object.defineProperty(e.prototype,"name",{get:function(){return this.privName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventId",{get:function(){return this.privEventId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventTime",{get:function(){return this.privEventTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventType",{get:function(){return this.privEventType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.privMetadata},enumerable:!0,configurable:!0}),e}();t.PlatformEvent=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(t.TranslationStatus||(t.TranslationStatus={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.privHeaderName=e,this.privToken=t}return Object.defineProperty(e.prototype,"headerName",{get:function(){return this.privHeaderName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"token",{get:function(){return this.privToken},enumerable:!0,configurable:!0}),e}();t.AuthInfo=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(4),s=function(e){function t(t,r,n,i){void 0===i&&(i=o.EventType.Info);var s=e.call(this,t,i)||this;return s.privRequestId=r,s.privSessionId=n,s}return i(t,e),Object.defineProperty(t.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!0,configurable:!0}),t}(o.PlatformEvent);t.SpeechRecognitionEvent=s;var c=function(e){function t(t,r,n,i){var o=e.call(this,"RecognitionTriggeredEvent",t,r)||this;return o.privAudioSourceId=n,o.privAudioNodeId=i,o}return i(t,e),Object.defineProperty(t.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),t}(s);t.RecognitionTriggeredEvent=c;var a=function(e){function t(t,r,n,i){var o=e.call(this,"ListeningStartedEvent",t,r)||this;return o.privAudioSourceId=n,o.privAudioNodeId=i,o}return i(t,e),Object.defineProperty(t.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),t}(s);t.ListeningStartedEvent=a;var u=function(e){function t(t,r,n){var i=e.call(this,"ConnectingToServiceEvent",t,n)||this;return i.privAuthFetchEventid=r,i}return i(t,e),Object.defineProperty(t.prototype,"authFetchEventid",{get:function(){return this.privAuthFetchEventid},enumerable:!0,configurable:!0}),t}(s);t.ConnectingToServiceEvent=u;var p,h=function(e){function t(t,r,n,i,o){var s=e.call(this,"RecognitionStartedEvent",t,o)||this;return s.privAudioSourceId=r,s.privAudioNodeId=n,s.privAuthFetchEventId=i,s}return i(t,e),Object.defineProperty(t.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authFetchEventId",{get:function(){return this.privAuthFetchEventId},enumerable:!0,configurable:!0}),t}(s);t.RecognitionStartedEvent=h,function(e){e[e.Success=0]="Success",e[e.AudioSourceError=1]="AudioSourceError",e[e.AudioSourceTimeout=2]="AudioSourceTimeout",e[e.AuthTokenFetchError=3]="AuthTokenFetchError",e[e.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",e[e.UnAuthorized=5]="UnAuthorized",e[e.ConnectTimeout=6]="ConnectTimeout",e[e.ConnectError=7]="ConnectError",e[e.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",e[e.UnknownError=9]="UnknownError"}(p=t.RecognitionCompletionStatus||(t.RecognitionCompletionStatus={}));var l=function(e){function t(t,r,n,i,s,c,a,u){var h=e.call(this,"RecognitionEndedEvent",t,s,a===p.Success?o.EventType.Info:o.EventType.Error)||this;return h.privAudioSourceId=r,h.privAudioNodeId=n,h.privAuthFetchEventId=i,h.privStatus=a,h.privError=u,h.privServiceTag=c,h}return i(t,e),Object.defineProperty(t.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authFetchEventId",{get:function(){return this.privAuthFetchEventId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serviceTag",{get:function(){return this.privServiceTag},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this.privStatus},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"error",{get:function(){return this.privError},enumerable:!0,configurable:!0}),t}(s);t.RecognitionEndedEvent=l},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,r){var n=r(8),i=r(14);e.exports=function(e,t){try{i(n,e,t)}catch(r){n[e]=t}return t}},function(e,t){e.exports=!1},function(e,t,r){var n=r(34),i=r(84),o=n("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t){e.exports={}},function(e,t,r){var n=r(54),i=r(8),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(n[e])||o(i[e]):n[e]&&n[e][t]||i[e]&&i[e][t]}},function(e,t,r){e.exports=r(8)},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,r){"use strict";r.r(t);var n=r(16);var i,o,s,c,a=r(255);class u{constructor(e,t){this.privChannelCount=1,this.encode=(e,t)=>{const r=this.downSampleAudioFrame(t,this.privActualSampleRate,this.privDesiredSampleRate);if(!r)return null;const n=2*r.length;if(!e){const e=new ArrayBuffer(n),t=new DataView(e);return this.floatTo16BitPCM(t,0,r),e}const i=new ArrayBuffer(44+n),o=new DataView(i);return this.setString(o,0,"RIFF"),o.setUint32(4,0,!0),this.setString(o,8,"WAVEfmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,this.privChannelCount,!0),o.setUint32(24,this.privDesiredSampleRate,!0),o.setUint32(28,this.privDesiredSampleRate*this.privChannelCount*2,!0),o.setUint16(32,2*this.privChannelCount,!0),o.setUint16(34,16,!0),this.setString(o,36,"data"),o.setUint32(40,0,!0),this.floatTo16BitPCM(o,44,r),i},this.setString=(e,t,r)=>{for(let n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))},this.floatTo16BitPCM=(e,t,r)=>{for(let n=0;n<r.length;n++,t+=2){const i=Math.max(-1,Math.min(1,r[n]));e.setInt16(t,i<0?32768*i:32767*i,!0)}},this.downSampleAudioFrame=(e,t,r)=>{if(r===t||r>t)return e;const n=t/r,i=Math.round(e.length/n),o=new Float32Array(i);let s=0,c=0;for(;c<i;){const t=Math.round((c+1)*n);let r=0,i=0;for(;s<t&&s<e.length;)r+=e[s++],i++;o[c++]=r/i}return o},this.privActualSampleRate=e,this.privDesiredSampleRate=t}}class p{constructor(){this.record=(e,t,r)=>{const n=(()=>{let t=0;try{return e.createScriptProcessor(t,1,1)}catch(r){t=2048;let n=e.sampleRate;for(;t<16384&&n>=32e3;)t<<=1,n>>=1;return e.createScriptProcessor(t,1,1)}})(),i=new u(e.sampleRate,16e3);let o=!0;n.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);if(r&&!r.isClosed){const e=i.encode(o,t);e&&(r.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()}),o=!1)}};const s=e.createMediaStreamSource(t);this.privSpeechProcessorScript&&e.audioWorklet?e.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const n=new AudioWorkletNode(e,"speech-processor");n.port.onmessage=e=>{const t=e.data;if(r&&!r.isClosed){const e=i.encode(o,t);e&&(r.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()}),o=!1)}},s.connect(n),n.connect(e.destination),this.privMediaResources={scriptProcessorNode:n,source:s,stream:t}}).catch(()=>{s.connect(n),n.connect(e.destination),this.privMediaResources={scriptProcessorNode:n,source:s,stream:t}}):(s.connect(n),n.connect(e.destination),this.privMediaResources={scriptProcessorNode:n,source:s,stream:t})},this.releaseMediaResources=e=>{this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(e.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privMediaResources.stream.getTracks().forEach(e=>e.stop()),this.privMediaResources.source=null))}}setWorkletUrl(e){this.privSpeechProcessorScript=e}}class h{static getDefaultInputFormat(){return l.getDefaultInputFormat()}static getWaveFormatPCM(e,t,r){return new l(e,t,r)}}class l extends h{constructor(e=16e3,t=16,r=1){super(),this.formatTag=1,this.bitsPerSample=t,this.samplesPerSec=e,this.channels=r,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8)}static getDefaultInputFormat(){return new l}close(){}}!function(e){e[e.Interactive=0]="Interactive",e[e.Conversation=1]="Conversation",e[e.Dictation=2]="Dictation"}(i||(i={})),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(o||(o={}));class f{constructor(e,t){this.privRecognitionMode=i.Interactive,this.privSpeechServiceConfig=e||new v(new d(null)),this.privParameters=t}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===i.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=i[e]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==i.Interactive}}class v{constructor(e){this.serialize=()=>JSON.stringify(this,(e,t)=>{if(t&&"object"==typeof t){const e={};for(const r in t)Object.hasOwnProperty.call(t,r)&&(e[r&&r.charAt(0).toLowerCase()+r.substring(1)]=t[r]);return e}return t}),this.context=e}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(e){this.recognition=e.toLowerCase()}}class d{constructor(e){this.system=new g,this.os=e}}class g{constructor(){this.name="SpeechSDK",this.version="1.6.0-alpha.0.1",this.build="JavaScript",this.lang="JavaScript"}}class y{constructor(e,t,r){this.platform=e,this.name=t,this.version=r}}!function(e){e.Bluetooth="Bluetooth",e.Wired="Wired",e.WiFi="WiFi",e.Cellular="Cellular",e.InBuilt="InBuilt",e.Unknown="Unknown"}(s||(s={})),function(e){e.Phone="Phone",e.Speaker="Speaker",e.Car="Car",e.Headset="Headset",e.Thermostat="Thermostat",e.Microphones="Microphones",e.Deskphone="Deskphone",e.RemoteControl="RemoteControl",e.Unknown="Unknown",e.File="File",e.Stream="Stream"}(c||(c={}));var m=r(5);class S extends n.b{constructor(e,t,r=n.a.Info){super(e,r),this.privAudioSourceId=t}get audioSourceId(){return this.privAudioSourceId}}class b extends S{constructor(e){super("AudioSourceInitializingEvent",e)}}class R extends S{constructor(e){super("AudioSourceReadyEvent",e)}}class w extends S{constructor(e){super("AudioSourceOffEvent",e)}}class C extends S{constructor(e,t){super("AudioSourceErrorEvent",e,n.a.Error),this.privError=t}get error(){return this.privError}}class P extends S{constructor(e,t,r){super(e,t),this.privAudioNodeId=r}get audioNodeId(){return this.privAudioNodeId}}class I extends P{constructor(e,t){super("AudioStreamNodeAttachingEvent",e,t)}}class E extends P{constructor(e,t){super("AudioStreamNodeAttachedEvent",e,t)}}class A extends P{constructor(e,t){super("AudioStreamNodeDetachedEvent",e,t)}}class O extends P{constructor(e,t,r){super("AudioStreamNodeErrorEvent",e,t),this.privError=r}get error(){return this.privError}}var T=r(0),_=r(7),D=r(36);class x{constructor(e){this.privReaderIdCounter=1,this.privIsEnded=!1,this.getReader=()=>{const e=this.privReaderIdCounter;this.privReaderIdCounter++;const t=new D.a,r=this.privStreambuffer.length;this.privReaderQueues[e]=t;for(let e=0;e<r;e++)t.enqueue(this.privStreambuffer[e]);return new M(this.privId,t,()=>{delete this.privReaderQueues[e]})},this.throwIfClosed=()=>{if(this.privIsEnded)throw new T.b("Stream closed")},this.privId=e||Object(_.b)(),this.privStreambuffer=[],this.privReaderQueues={}}get isClosed(){return this.privIsEnded}get id(){return this.privId}close(){this.privIsEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsEnded=!0)}writeStreamChunk(e){this.throwIfClosed(),this.privStreambuffer.push(e);for(const t in this.privReaderQueues)if(!this.privReaderQueues[t].isDisposed())try{this.privReaderQueues[t].enqueue(e)}catch(e){}}}class M{constructor(e,t,r){this.privIsClosed=!1,this.read=()=>{if(this.isClosed)throw new T.b("StreamReader closed");return this.privReaderQueue.dequeue().onSuccessContinueWith(e=>((void 0===e||e.isEnd)&&this.privReaderQueue.dispose("End of stream reached"),e))},this.close=()=>{this.privIsClosed||(this.privIsClosed=!0,this.privReaderQueue.dispose("StreamReader closed"),this.privOnClose())},this.privReaderQueue=t,this.privOnClose=r,this.privStreamId=e}get isClosed(){return this.privIsClosed}get streamId(){return this.privStreamId}}class N extends x{constructor(e,t){super(t),this.privTargetChunkSize=e,this.privNextBufferReadyBytes=0}writeStreamChunk(e){if(e.isEnd||0===this.privNextBufferReadyBytes&&e.buffer.byteLength===this.privTargetChunkSize)return void super.writeStreamChunk(e);let t=0;for(;t<e.buffer.byteLength;){void 0===this.privNextBufferToWrite&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=e.timeReceived);const r=Math.min(e.buffer.byteLength-t,this.privTargetChunkSize-this.privNextBufferReadyBytes),n=new Uint8Array(this.privNextBufferToWrite),i=new Uint8Array(e.buffer.slice(t,r+t));n.set(i,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=r,t+=r,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){0===this.privNextBufferReadyBytes||this.isClosed||super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}}var z=r(58);const j="MICROPHONE-WorkletSourceUrl";class k{constructor(e,t,r,n){this.privRecorder=e,this.deviceId=n,this.privStreams={},this.turnOn=()=>{if(this.privInitializeDeferral)return this.privInitializeDeferral.promise();this.privInitializeDeferral=new m.a,this.createAudioContext();const e=window.navigator;let t=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia;if(e.mediaDevices&&(t=(t,r,n)=>{e.mediaDevices.getUserMedia(t).then(r).catch(n)}),t){const e=()=>{this.onEvent(new b(this.privId)),t({audio:!this.deviceId||{deviceId:this.deviceId},video:!1},e=>{this.privMediaStream=e,this.onEvent(new R(this.privId)),this.privInitializeDeferral.resolve(!0)},e=>{const t=`Error occurred during microphone initialization: ${e}`,r=this.privInitializeDeferral;this.privInitializeDeferral=null,r.reject(t),this.onEvent(new C(this.privId,t))})};"suspended"===this.privContext.state?this.privContext.resume().then(e,e=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${e}`)}):e()}else{const e="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(e),this.onEvent(new C(e,""))}return this.privInitializeDeferral.promise()},this.id=()=>this.privId,this.attach=e=>(this.onEvent(new I(this.privId,e)),this.listen(e).onSuccessContinueWith(t=>(this.onEvent(new E(this.privId,e)),{detach:()=>{t.close(),this.turnOff(),delete this.privStreams[e],this.onEvent(new A(this.privId,e))},id:()=>e,read:()=>t.read()}))),this.detach=e=>{e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new A(this.privId,e)))},this.turnOff=()=>{for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&t.close()}return this.onEvent(new w(this.privId)),this.privInitializeDeferral=null,this.destroyAudioContext(),m.b.fromResult(!0)},this.listen=e=>this.turnOn().onSuccessContinueWith(t=>{const r=new N(this.privOutputChunkSize,e);this.privStreams[e]=r;try{this.privRecorder.record(this.privContext,this.privMediaStream,r)}catch(t){throw this.onEvent(new O(this.privId,e,t)),t}return r.getReader()}),this.onEvent=e=>{this.privEvents.onEvent(e),a.a.instance.onEvent(e)},this.createAudioContext=()=>{if(this.privContext)return;const e=window.AudioContext||window.webkitAudioContext||!1;if(!e)throw new Error("Browser does not support Web Audio API (AudioContext is not available).");this.privContext=new e},this.destroyAudioContext=()=>{if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let e=!1;"close"in this.privContext&&(e=!0),e?(this.privContext.close(),this.privContext=null):null!==this.privContext&&"running"===this.privContext.state&&this.privContext.suspend()},this.privOutputChunkSize=t,this.privId=r||Object(_.b)(),this.privEvents=new z.a}get format(){return k.AUDIOFORMAT}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().onSuccessContinueWith(e=>({bitspersample:k.AUDIOFORMAT.bitsPerSample,channelcount:k.AUDIOFORMAT.channels,connectivity:s.Unknown,manufacturer:"Speech SDK",model:e,samplerate:k.AUDIOFORMAT.samplesPerSec,type:c.Microphones}))}setProperty(e,t){if(e!==j)throw new Error("Property '"+e+"' is not supported on Microphone.");this.privRecorder.setWorkletUrl(t)}getMicrophoneLabel(){if(void 0!==this.privMicrophoneLabel)return m.b.fromResult(this.privMicrophoneLabel);if(void 0===this.privMediaStream||!this.privMediaStream.active)return m.b.fromResult("microphone");this.privMicrophoneLabel="microphone";const e=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(void 0===e)return m.b.fromResult(this.privMicrophoneLabel);const t=new m.a;return navigator.mediaDevices.enumerateDevices().then(r=>{for(const t of r)if(t.deviceId===e){this.privMicrophoneLabel=t.label;break}t.resolve(this.privMicrophoneLabel)},()=>t.resolve(this.privMicrophoneLabel)),t.promise()}}k.AUDIOFORMAT=h.getDefaultInputFormat();class L{constructor(e,t){this.privStreams={},this.turnOn=()=>{if("undefined"==typeof FileReader){const e="Browser does not support FileReader.";return this.onEvent(new C(e,"")),m.b.fromError(e)}if(this.privFile.name.lastIndexOf(".wav")!==this.privFile.name.length-4){const e=this.privFile.name+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new C(e,"")),m.b.fromError(e)}if(this.privFile.size>L.MAX_SIZE){const e=this.privFile.name+" exceeds the maximum allowed file size ("+L.MAX_SIZE+").";return this.onEvent(new C(e,"")),m.b.fromError(e)}return this.onEvent(new b(this.privId)),this.onEvent(new R(this.privId)),m.b.fromResult(!0)},this.id=()=>this.privId,this.attach=e=>(this.onEvent(new I(this.privId,e)),this.upload(e).onSuccessContinueWith(t=>(this.onEvent(new E(this.privId,e)),{detach:()=>{t.close(),delete this.privStreams[e],this.onEvent(new A(this.privId,e)),this.turnOff()},id:()=>e,read:()=>t.read()}))),this.detach=e=>{e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new A(this.privId,e)))},this.turnOff=()=>{for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&!t.isClosed&&t.close()}return this.onEvent(new w(this.privId)),m.b.fromResult(!0)},this.upload=e=>this.turnOn().onSuccessContinueWith(t=>{const r=new x(e);this.privStreams[e]=r;const n=new FileReader;let i=0,o=L.CHUNK_SIZE;n.onload=e=>{if(!r.isClosed)if(r.writeStreamChunk({buffer:n.result,isEnd:!1,timeReceived:Date.now()}),o<this.privFile.size){i=o,o=Math.min(o+L.CHUNK_SIZE,this.privFile.size);const e=this.privFile.slice(i,o);n.readAsArrayBuffer(e)}else r.close()},n.onerror=t=>{const r=`Error occurred while processing '${this.privFile.name}'. ${t}`;throw this.onEvent(new O(this.privId,e,r)),new Error(r)};const s=this.privFile.slice(i,o);return n.readAsArrayBuffer(s),r.getReader()}),this.onEvent=e=>{this.privEvents.onEvent(e),a.a.instance.onEvent(e)},this.privId=t||Object(_.b)(),this.privEvents=new z.a,this.privFile=e}get format(){return L.FILEFORMAT}get events(){return this.privEvents}get deviceInfo(){return m.b.fromResult({bitspersample:L.FILEFORMAT.bitsPerSample,channelcount:L.FILEFORMAT.channels,connectivity:s.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:L.FILEFORMAT.samplesPerSec,type:c.File})}}L.SAMPLE_RATE=32e3,L.CHUNK_SIZE=2*L.SAMPLE_RATE/5,L.MAX_SIZE=600*L.SAMPLE_RATE+44,L.FILEFORMAT=h.getWaveFormatPCM(16e3,16,1);class B{static throwIfNullOrUndefined(e,t){if(null==e)throw new Error("throwIfNullOrUndefined:"+t)}static throwIfNull(e,t){if(null===e)throw new Error("throwIfNull:"+t)}static throwIfNullOrWhitespace(e,t){if(B.throwIfNullOrUndefined(e,t),(""+e).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+t)}static throwIfDisposed(e){if(e)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(e,t){if(B.throwIfNullOrUndefined(e,t),0===e.length)throw new Error("throwIfArrayEmptyOrWhitespace:"+t);for(const r of e)B.throwIfNullOrWhitespace(r,t)}static throwIfFileDoesNotExist(e,t){B.throwIfNullOrWhitespace(e,t)}}class F{}const q=4096;class U{constructor(){}static createPushStream(e){return W.create(e)}static createPullStream(e,t){return H.create(e,t)}}class W extends U{static create(e){return new V(q,e)}}class V extends W{constructor(e,t){super(),this.onEvent=e=>{this.privEvents.onEvent(e),a.a.instance.onEvent(e)},this.privFormat=void 0===t?l.getDefaultInputFormat():t,this.privEvents=new z.a,this.privId=Object(_.b)(),this.privStream=new N(e)}get format(){return this.privFormat}write(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){return this.onEvent(new b(this.privId)),this.onEvent(new R(this.privId)),m.b.fromResult(!0)}attach(e){return this.onEvent(new I(this.privId,e)),this.turnOn().onSuccessContinueWith(e=>this.privStream.getReader()).onSuccessContinueWith(t=>(this.onEvent(new E(this.privId,e)),{detach:()=>{t.close(),this.onEvent(new A(this.privId,e)),this.turnOff()},id:()=>e,read:()=>t.read()}))}detach(e){this.onEvent(new A(this.privId,e))}turnOff(){return m.b.fromResult(!1)}get events(){return this.privEvents}get deviceInfo(){return m.b.fromResult({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:s.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:c.Stream})}}class H extends U{constructor(){super()}static create(e,t){return new G(e,t)}}class G extends H{constructor(e,t){super(),this.onEvent=e=>{this.privEvents.onEvent(e),a.a.instance.onEvent(e)},this.privFormat=void 0===t?h.getDefaultInputFormat():t,this.privEvents=new z.a,this.privId=Object(_.b)(),this.privCallback=e,this.privIsClosed=!1}get format(){return this.privFormat}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){return this.onEvent(new b(this.privId)),this.onEvent(new R(this.privId)),m.b.fromResult(!0)}attach(e){return this.onEvent(new I(this.privId,e)),this.turnOn().onSuccessContinueWith(t=>(this.onEvent(new E(this.privId,e)),{detach:()=>{this.privCallback.close(),this.onEvent(new A(this.privId,e)),this.turnOff()},id:()=>e,read:()=>{let e,t=0;for(;t<q;){const r=new ArrayBuffer(q-t),n=this.privCallback.read(r);if(void 0===e)e=r;else{new Int8Array(e).set(new Int8Array(r),t)}if(0===n)break;t+=n}return m.b.fromResult({buffer:e.slice(0,t),isEnd:this.privIsClosed||0===t,timeReceived:Date.now()})}}))}detach(e){this.onEvent(new A(this.privId,e))}turnOff(){return m.b.fromResult(!1)}get events(){return this.privEvents}get deviceInfo(){return m.b.fromResult({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:s.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:c.Stream})}}class J{static fromDefaultMicrophoneInput(){const e=new p;return new K(new k(e,q))}static fromMicrophoneInput(e){const t=new p;return new K(new k(t,q,e))}static fromWavFileInput(e){return new K(new L(e))}static fromStreamInput(e){if(e instanceof F)return new K(new G(e));if(e instanceof U)return new K(e);throw new Error("Not Supported Type")}}class K extends J{constructor(e){super(),this.privSource=e}get format(){return this.privSource.format}close(){this.privSource.turnOff()}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(e){return this.privSource.attach(e)}detach(e){return this.detach(e)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(e,t){if(B.throwIfNull(t,"value"),void 0===this.privSource.setProperty)throw new Error("This AudioConfig instance does not support setting properties.");this.privSource.setProperty(e,t)}getProperty(e,t){if(void 0!==this.privSource.getProperty)return this.privSource.getProperty(e,t);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}const Q=4096;class Y{constructor(){}static createPullStream(e){return $.create(e)}}class $ extends Y{static create(e){return new X(Q,e)}}class X extends ${constructor(e,t){super(),this.privFormat=void 0===t?l.getDefaultInputFormat():t,this.privId=Object(_.b)(),this.privStream=new N(e),this.streamReader=this.privStream.getReader()}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}get id(){return this.privId}read(){return this.streamReader.read().onSuccessContinueWithPromise(e=>m.b.fromResult(e.buffer))}write(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}var Z,ee,te;!function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"}(Z||(Z={}));class re{constructor(){this.privDisposed=!1}static fromFile(e){throw B.throwIfFileDoesNotExist(e,"fileName"),new Error("Not yet implemented.")}static fromStream(e){throw B.throwIfNull(e,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}}class ne{constructor(e){this.privSessionId=e}get sessionId(){return this.privSessionId}}class ie extends ne{constructor(e,t){super(t),this.privOffset=e}get offset(){return this.privOffset}}!function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(ee||(ee={}));class oe extends ie{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}}class se{constructor(e,t,r,n,i,o,s,c){this.privResultId=e,this.privReason=t,this.privText=r,this.privDuration=n,this.privOffset=i,this.privErrorDetails=o,this.privJson=s,this.privProperties=c}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}}class ce extends se{constructor(e,t,r,n,i,o,s,c){super(e,t,r,n,i,o,s,c)}}class ae extends ce{constructor(e,t,r,n,i,o,s,c,a){super(t,r,n,i,o,s,c,a),this.privIntentId=e}get intentId(){return this.privIntentId}}class ue{constructor(){}static fromEndpoint(e){B.throwIfNull(e,"uri"),B.throwIfNullOrWhitespace(e.hostname,"uri");const t=new pe,r=e.host.indexOf(".");if(-1===r)throw new Error("Could not determine region from endpoint");t.region=e.host.substr(0,r);const n=e.pathname.lastIndexOf("/")+1;if(-1===n)throw new Error("Could not determine appId from endpoint");if(t.appId=e.pathname.substr(n),t.subscriptionKey=e.searchParams.get("subscription-key"),void 0===t.subscriptionKey)throw new Error("Could not determine subscription key from endpoint");return t}static fromAppId(e){B.throwIfNullOrWhitespace(e,"appId");const t=new pe;return t.appId=e,t}static fromSubscription(e,t,r){B.throwIfNullOrWhitespace(e,"subscriptionKey"),B.throwIfNullOrWhitespace(t,"appId"),B.throwIfNullOrWhitespace(r,"region");const n=new pe;return n.appId=t,n.region=r,n.subscriptionKey=e,n}}class pe extends ue{}class he extends ie{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}}class le extends ie{constructor(e,t,r,n,i){super(n,i),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}class fe extends ie{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}}class ve extends ne{constructor(e,t){super(t),this.privResult=e}get result(){return this.privResult}}class de extends ce{constructor(e,t,r,n,i,o,s,c,a){super(t,r,n,i,o,s,c,a),this.privTranslations=e}get translations(){return this.privTranslations}}class ge{constructor(e,t){this.privReason=e,this.privAudio=t}get audio(){return this.privAudio}get reason(){return this.privReason}}!function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizingIntent=4]="RecognizingIntent",e[e.RecognizedIntent=5]="RecognizedIntent",e[e.TranslatingSpeech=6]="TranslatingSpeech",e[e.TranslatedSpeech=7]="TranslatedSpeech",e[e.SynthesizingAudio=8]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=9]="SynthesizingAudioCompleted"}(te||(te={}));const ye="OutputFormat",me="CancellationErrorCode",Se="ServiceProperties",be="ForceDication";var Re,we;!function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=17]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=18]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=19]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=20]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=21]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=22]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=23]="CancellationDetails_ReasonDetailedText",e[e.LanguageUnderstandingServiceResponse_JsonResult=24]="LanguageUnderstandingServiceResponse_JsonResult",e[e.SpeechServiceConnection_Url=25]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=26]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=27]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.SpeechServiceConnection_EnableAudioLogging=28]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceResponse_ProfanityOption=29]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=30]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=31]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=32]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=33]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=34]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.Conversation_ApplicationId=35]="Conversation_ApplicationId",e[e.Conversation_DialogType=36]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=37]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=38]="Conversation_From_Id"}(Re||(Re={}));class Ce{constructor(){this.privKeys=[],this.privValues=[]}getProperty(e,t){let r;r="string"==typeof e?e:Re[e];for(let e=0;e<this.privKeys.length;e++)if(this.privKeys[e]===r)return this.privValues[e];return t}setProperty(e,t){let r;r="string"==typeof e?e:Re[e];for(let e=0;e<this.privKeys.length;e++)if(this.privKeys[e]===r)return void(this.privValues[e]=t);this.privKeys.push(r),this.privValues.push(t)}clone(){const e=new Ce;for(let t=0;t<this.privKeys.length;t++)e.privKeys.push(this.privKeys[t]),e.privValues.push(this.privValues[t]);return e}}!function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"}(we||(we={}));class Pe{constructor(){}static fromSubscription(e,t){B.throwIfNullOrWhitespace(e,"subscriptionKey"),B.throwIfNullOrWhitespace(t,"region");const r=new Ie;return r.setProperty(Re.SpeechServiceConnection_Region,t),r.setProperty(Re.SpeechServiceConnection_IntentRegion,t),r.setProperty(Re.SpeechServiceConnection_Key,e),r}static fromEndpoint(e,t){B.throwIfNull(e,"endpoint");const r=new Ie;return r.setProperty(Re.SpeechServiceConnection_Endpoint,e.href),void 0!==t&&r.setProperty(Re.SpeechServiceConnection_Key,t),r}static fromAuthorizationToken(e,t){B.throwIfNull(e,"authorizationToken"),B.throwIfNullOrWhitespace(t,"region");const r=new Ie;return r.setProperty(Re.SpeechServiceConnection_Region,t),r.setProperty(Re.SpeechServiceConnection_IntentRegion,t),r.authorizationToken=e,r}close(){}}class Ie extends Pe{constructor(){super(),this.privProperties=new Ce,this.speechRecognitionLanguage="en-US",this.outputFormat=ee.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(Re.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(Re.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(Re.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(Re.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.privProperties.setProperty(Re.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return this.privProperties.getProperty(Re.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(e){this.privProperties.setProperty(Re.SpeechServiceConnection_RecoLanguage,e)}get outputFormat(){return ee[this.privProperties.getProperty(ye,void 0)]}set outputFormat(e){this.privProperties.setProperty(ye,ee[e])}get endpointId(){return this.privProperties.getProperty(Re.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privProperties.setProperty(Re.SpeechServiceConnection_EndpointId,e)}setProperty(e,t){B.throwIfNull(t,"value"),this.privProperties.setProperty(e,t)}getProperty(e,t){return this.privProperties.getProperty(e,t)}setProxy(e,t,r,n){this.setProperty(Re[Re.SpeechServiceConnection_ProxyHostName],e),this.setProperty(Re[Re.SpeechServiceConnection_ProxyPort],t),this.setProperty(Re[Re.SpeechServiceConnection_ProxyUserName],r),this.setProperty(Re[Re.SpeechServiceConnection_ProxyPassword],n)}setServiceProperty(e,t,r){const n=JSON.parse(this.privProperties.getProperty(Se,"{}"));n[e]=t,this.privProperties.setProperty(Se,JSON.stringify(n))}setProfanity(e){this.privProperties.setProperty(Re.SpeechServiceResponse_ProfanityOption,we[e])}enableAudioLogging(){this.privProperties.setProperty(Re.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(Re.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(be,"true")}clone(){const e=new Ie;return e.privProperties=this.privProperties.clone(),e}}class Ee extends Pe{constructor(){super()}static fromSubscription(e,t){B.throwIfNullOrWhitespace(e,"subscriptionKey"),B.throwIfNullOrWhitespace(t,"region");const r=new Ae;return r.properties.setProperty(Re.SpeechServiceConnection_Key,e),r.properties.setProperty(Re.SpeechServiceConnection_Region,t),r}static fromAuthorizationToken(e,t){B.throwIfNullOrWhitespace(e,"authorizationToken"),B.throwIfNullOrWhitespace(t,"region");const r=new Ae;return r.properties.setProperty(Re.SpeechServiceAuthorization_Token,e),r.properties.setProperty(Re.SpeechServiceConnection_Region,t),r}static fromEndpoint(e,t){B.throwIfNull(e,"endpoint"),B.throwIfNull(t,"subscriptionKey");const r=new Ae;return r.properties.setProperty(Re.SpeechServiceConnection_Endpoint,e.href),r.properties.setProperty(Re.SpeechServiceConnection_Key,t),r}}class Ae extends Ee{constructor(){super(),this.privSpeechProperties=new Ce,this.outputFormat=ee.Simple}set authorizationToken(e){B.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(Re.SpeechServiceAuthorization_Token,e)}set speechRecognitionLanguage(e){B.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(Re.SpeechServiceConnection_RecoLanguage,e)}get subscriptionKey(){return this.privSpeechProperties.getProperty(Re[Re.SpeechServiceConnection_Key])}get outputFormat(){return ee[this.privSpeechProperties.getProperty(ye,void 0)]}set outputFormat(e){this.privSpeechProperties.setProperty(ye,ee[e])}get endpointId(){return this.privSpeechProperties.getProperty(Re.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privSpeechProperties.setProperty(Re.SpeechServiceConnection_Endpoint,e)}addTargetLanguage(e){B.throwIfNullOrWhitespace(e,"value");const t=this.targetLanguages;t.push(e),this.privSpeechProperties.setProperty(Re.SpeechServiceConnection_TranslationToLanguages,t.join(","))}get targetLanguages(){return void 0!==this.privSpeechProperties.getProperty(Re.SpeechServiceConnection_TranslationToLanguages,void 0)?this.privSpeechProperties.getProperty(Re.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(Re[Re.SpeechServiceConnection_TranslationVoice])}set voiceName(e){B.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(Re.SpeechServiceConnection_TranslationVoice,e)}get region(){return this.privSpeechProperties.getProperty(Re.SpeechServiceConnection_Region)}setProxy(e,t,r,n){this.setProperty(Re[Re.SpeechServiceConnection_ProxyHostName],e),this.setProperty(Re[Re.SpeechServiceConnection_ProxyPort],t),this.setProperty(Re[Re.SpeechServiceConnection_ProxyUserName],r),this.setProperty(Re[Re.SpeechServiceConnection_ProxyPassword],n)}getProperty(e,t){return this.privSpeechProperties.getProperty(e,t)}setProperty(e,t){this.privSpeechProperties.setProperty(e,t)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(e,t,r){const n=JSON.parse(this.privSpeechProperties.getProperty(Se,"{}"));n[e]=t,this.privSpeechProperties.setProperty(Se,JSON.stringify(n))}setProfanity(e){this.privSpeechProperties.setProperty(Re.SpeechServiceResponse_ProfanityOption,we[e])}enableAudioLogging(){this.privSpeechProperties.setProperty(Re.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(Re.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(be,"true")}}class Oe{constructor(e,t){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.id=()=>this.privAudioNode.id(),this.privAudioNode=e,this.privFormat=t}read(){if(this.privReplay&&0!==this.privBuffers.length){const e=this.privReplayOffset-this.privBufferStartOffset;let t=Math.round(e*this.privFormat.avgBytesPerSec*1e-7);0!=t%2&&t++;let r=0;for(;r<this.privBuffers.length&&t>=this.privBuffers[r].chunk.buffer.byteLength;)t-=this.privBuffers[r++].chunk.buffer.byteLength;const n=this.privBuffers[r].chunk.buffer.slice(t);return this.privReplayOffset+=n.byteLength/this.privFormat.avgBytesPerSec*1e7,r===this.privBuffers.length-1&&(this.privReplay=!1),m.b.fromResult({buffer:n,isEnd:!1,timeReceived:this.privBuffers[r].chunk.timeReceived})}return this.privAudioNode.read().onSuccessContinueWith(e=>(e&&e.buffer&&(this.privBuffers.push(new Te(e,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=e.buffer.byteLength),e))}detach(){this.privAudioNode.detach(),this.privBuffers=void 0}replay(){this.privBuffers&&0!==this.privBuffers.length&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(e){this.privLastShrinkOffset=e;const t=e-this.privBufferStartOffset;let r=Math.round(t*this.privFormat.avgBytesPerSec*1e-7),n=0;for(;n<this.privBuffers.length&&r>=this.privBuffers[n].chunk.buffer.byteLength;)r-=this.privBuffers[n++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-r/this.privFormat.avgBytesPerSec*1e7),this.privBuffers=this.privBuffers.slice(n)}findTimeAtOffset(e){if(e<this.privBufferStartOffset)return 0;for(const t of this.privBuffers){const r=t.byteOffset/this.privFormat.avgBytesPerSec*1e7,n=r+t.chunk.buffer.byteLength/this.privFormat.avgBytesPerSec*1e7;if(e>=r&&e<=n)return t.chunk.timeReceived}return 0}}class Te{constructor(e,t,r){this.chunk=e,this.serial=t,this.byteOffset=r}}var _e,De,xe=r(21),Me=r(10);!function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError"}(_e||(_e={}));class Ne{constructor(e){this.privSpeechStartDetected=JSON.parse(e)}static fromJSON(e){return new Ne(e)}get Offset(){return this.privSpeechStartDetected.Offset}}class ze extends n.b{constructor(e,t,r,i=n.a.Info){super(e,i),this.privRequestId=t,this.privSessionId=r}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}class je extends ze{constructor(e,t,r,n){super("RecognitionTriggeredEvent",e,t),this.privAudioSourceId=r,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class ke extends ze{constructor(e,t,r,n){super("ListeningStartedEvent",e,t),this.privAudioSourceId=r,this.privAudioNodeId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class Le extends ze{constructor(e,t,r){super("ConnectingToServiceEvent",e,r),this.privAuthFetchEventid=t}get authFetchEventid(){return this.privAuthFetchEventid}}class Be extends ze{constructor(e,t,r,n,i){super("RecognitionStartedEvent",e,i),this.privAudioSourceId=t,this.privAudioNodeId=r,this.privAuthFetchEventId=n}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}!function(e){e[e.Success=0]="Success",e[e.AudioSourceError=1]="AudioSourceError",e[e.AudioSourceTimeout=2]="AudioSourceTimeout",e[e.AuthTokenFetchError=3]="AuthTokenFetchError",e[e.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",e[e.UnAuthorized=5]="UnAuthorized",e[e.ConnectTimeout=6]="ConnectTimeout",e[e.ConnectError=7]="ConnectError",e[e.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",e[e.UnknownError=9]="UnknownError"}(De||(De={}));var Fe=r(25);class qe{constructor(e,t,r){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.onEvent=e=>{this.privIsDisposed||(e instanceof je&&e.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof I&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof E&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof C&&e.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof O&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof A&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Name:"Microphone",Start:this.privMicStartTime})),e instanceof Le&&e.requestId===this.privRequestId&&(this.privConnectionId=e.sessionId),e instanceof Fe.f&&e.connectionId===this.privConnectionId&&(this.privConnectionStartTime=e.eventTime),e instanceof Fe.c&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof Fe.b&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Error:this.getConnectionError(e.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof Fe.d&&e.connectionId===this.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path&&(this.privReceivedMessages[e.message.headers.path]||(this.privReceivedMessages[e.message.headers.path]=new Array),this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)))},this.getTelemetry=()=>{const e=new Array;this.privListeningTriggerMetric&&e.push(this.privListeningTriggerMetric),this.privMicMetric&&e.push(this.privMicMetric),this.privConnectionEstablishMetric&&e.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const t={Metrics:e,ReceivedMessages:this.privReceivedMessages},r=JSON.stringify(t);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],r},this.dispose=()=>{this.privIsDisposed=!0},this.getConnectionError=e=>{switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}},this.privRequestId=e,this.privAudioSourceId=t,this.privAudioNodeId=r,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)}hypothesisReceived(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)}get hasTelemetry(){return 0!==Object.keys(this.privReceivedMessages).length||null!==this.privListeningTriggerMetric||null!==this.privMicMetric||null!==this.privConnectionEstablishMetric||0!==this.privPhraseLatencies.length||0!==this.privHypothesisLatencies.length}}class Ue{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecogNumber=0,this.onAudioSourceAttachCompleted=(e,t,r)=>{this.privAudioNode=e,this.privIsAudioNodeDetached=!1,t?this.onComplete():this.onEvent(new ke(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))},this.onPreConnectionStart=(e,t)=>{this.privAuthFetchEventId=e,this.privSessionId=t,this.onEvent(new Le(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))},this.onAuthCompleted=(e,t)=>{e&&this.onComplete()},this.onConnectionEstablishCompleted=(e,t)=>{if(200===e)return this.onEvent(new Be(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,void(this.privBytesSent=0);403===e&&this.onComplete()},this.onServiceTurnEndResponse=e=>{!e||this.isSpeechEnded?this.onComplete():(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privRequestId=Object(_.b)(),this.privAudioNode.replay())},this.dispose=e=>{if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)e.detach();this.privServiceTelemetryListener.dispose()}},this.getTelemetry=()=>this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null,this.onEvent=e=>{this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(e),a.a.instance.onEvent(e)},this.onComplete=()=>{this.privIsRecognizing&&(this.privIsRecognizing=!1,this.detachAudioNode())},this.detachAudioNode=()=>{this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&this.privAudioNode.detach())},this.privAudioSourceId=e,this.privRequestId=Object(_.b)(),this.privAudioNodeId=Object(_.b)(),this.privRequestCompletionDeferral=new m.a}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get completionPromise(){return this.privRequestCompletionDeferral.promise()}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get bytesSent(){return this.privBytesSent}listenForServiceTelemetry(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRequestId=Object(_.b)(),this.privRecogNumber++,this.privServiceTelemetryListener=new qe(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new je(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onHypothesis(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))}onPhraseRecognized(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)}onServiceRecognized(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e)}onAudioSent(e){this.privBytesSent+=e}onStopRecognizing(){this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}}class We{addPhrase(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(void 0===this.privGrammars&&void 0===this.privPhrases)return;const e={};if(e.ReferenceGrammars=this.privGrammars,void 0!==this.privPhrases&&0!==this.privPhrases.length){const t=[];this.privPhrases.forEach((e,r,n)=>{t.push({Text:e})}),e.Groups=[{Type:"Generic",Items:t}]}return e}}class Ve{constructor(e){this.privContext={},this.privDynamicGrammar=e}setSection(e,t){this.privContext[e]=t}toJSON(){const e=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",e),JSON.stringify(this.privContext)}}class He{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(e){this.iPrivConfig=e}}const Ge="path",Je="content-type",Ke="x-requestid",Qe="x-timestamp";class Ye extends xe.a{constructor(e,t,r,n,i,o,s){if(!t)throw new T.a("path");if(!r)throw new T.a("requestId");const c={};if(c[Ge]=t,c[Ke]=r,c[Qe]=(new Date).toISOString(),n&&(c[Je]=n),o)for(const e in o)e&&(c[e]=o[e]);s?super(e,i,c,s):super(e,i,c),this.privPath=t,this.privRequestId=r,this.privContentType=n,this.privAdditionalHeaders=o}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get additionalHeaders(){return this.privAdditionalHeaders}}Ye.fromConnectionMessage=e=>{let t=null,r=null,n=null,i=null;const o={};if(e.headers)for(const s in e.headers)s&&(s.toLowerCase()===Ge.toLowerCase()?t=e.headers[s]:s.toLowerCase()===Ke.toLowerCase()?r=e.headers[s]:s.toLowerCase()===Qe.toLowerCase()?i=e.headers[s]:s.toLowerCase()===Je.toLowerCase()?n=e.headers[s]:o[s]=e.headers[s]);return new Ye(e.messageType,t,r,n,e.body,o,e.id)};class $e{constructor(e,t,r,n,i){if(this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.sendTelemetryData=()=>{const e=this.privRequestSession.getTelemetry();if(!0!==$e.telemetryDataEnabled||this.privIsDisposed||null===e)return m.b.fromResult(!0);if($e.telemetryData)try{$e.telemetryData(e)}catch(e){}return this.fetchConnection().onSuccessContinueWith(t=>t.send(new Ye(xe.b.Text,"telemetry",this.privRequestSession.requestId,"application/json",e)))},this.receiveMessageOverride=void 0,this.receiveMessage=(e,t)=>this.fetchConnection().on(r=>r.read().onSuccessContinueWithPromise(r=>{if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(this.privIsDisposed||!this.privRequestSession.isRecognizing)return m.b.fromResult(void 0);if(!r)return this.privRequestSession.isRecognizing?this.receiveMessage(e,t):m.b.fromResult(!0);const n=Ye.fromConnectionMessage(r);if(n.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(n.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0;break;case"speech.startdetected":const r=Ne.fromJSON(n.textBody),i=new ie(r.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,i);break;case"speech.enddetected":let o;o=n.textBody.length>0?n.textBody:"{ Offset: 0 }";const s=Ne.fromJSON(o);this.privRecognizerConfig.isContinuousRecognition&&this.privRequestSession.onServiceRecognized(s.Offset+this.privRequestSession.currentTurnAudioOffset);const c=new ie(s.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,c);break;case"turn.end":this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,this.cancelRecognitionLocal(Z.EndOfStream,_e.NoError,void 0,e));const a=new ne(this.privRequestSession.sessionId);if(this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded)return this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,a),m.b.fromResult(!0);this.fetchConnection().onSuccessContinueWith(e=>{this.sendSpeechContext(e)});default:this.processTypeSpecificMessages(n,e,t)}return this.receiveMessage(e,t)}),e=>{}),this.sendSpeechContext=e=>{const t=this.speechContext.toJSON();return t?e.send(new Ye(xe.b.Text,"speech.context",this.privRequestSession.requestId,"application/json",t)):m.b.fromResult(!0)},this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.fetchConnectionOverride=void 0,this.sendSpeechServiceConfig=(e,t,r)=>{if(!0!==$e.telemetryDataEnabled){const e={context:{system:JSON.parse(r).context.system}};r=JSON.stringify(e)}return r?(this.privSpeechServiceConfigConnectionId=this.privConnectionId,e.send(new Ye(xe.b.Text,"speech.config",t.requestId,"application/json",r))):m.b.fromResult(!0)},this.sendAudio=e=>{const t=new m.a;let r=Date.now();const n=this.privAudioSource.format,i=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),o=n.avgBytesPerSec/1e3*parseInt(i,10),s=this.privRequestSession.recogNumber,c=()=>{this.privIsDisposed||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing||this.privRequestSession.recogNumber!==s||this.fetchConnection().on(i=>{e.read().on(e=>{if(this.privRequestSession.isSpeechEnded)return void t.resolve(!0);let s,a;e.isEnd?(s=null,a=0):(s=e.buffer,this.privRequestSession.onAudioSent(s.byteLength),a=o>=this.privRequestSession.bytesSent?0:Math.max(0,r-Date.now())),setTimeout(()=>{null!==s&&(r=Date.now()+1e3*s.byteLength/(2*n.avgBytesPerSec));const o=i.send(new Ye(xe.b.Binary,"audio",this.privRequestSession.requestId,null,s));e.isEnd?(this.privRequestSession.onSpeechEnded(),t.resolve(!0)):o.continueWith(e=>{c()})},a)},e=>{this.privRequestSession.isSpeechEnded?t.resolve(!0):t.reject(e)})},e=>{t.reject(e)})};return c(),t.promise()},this.fetchConnection=()=>void 0!==this.fetchConnectionOverride?this.fetchConnectionOverride():this.configureConnection(),!e)throw new T.a("authentication");if(!t)throw new T.a("connectionFactory");if(!r)throw new T.a("audioSource");if(!n)throw new T.a("recognizerConfig");this.privMustReportEndOfStream=!1,this.privAuthentication=e,this.privConnectionFactory=t,this.privAudioSource=r,this.privRecognizerConfig=n,this.privIsDisposed=!1,this.privRecognizer=i,this.privRequestSession=new Ue(this.privAudioSource.id()),this.privConnectionEvents=new z.a,this.privDynamicGrammar=new We,this.privSpeechContext=new Ve(this.privDynamicGrammar),this.privAgentConfig=new He}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}isDisposed(){return this.privIsDisposed}dispose(e){this.privIsDisposed=!0,this.privConnectionConfigurationPromise&&this.privConnectionConfigurationPromise.onSuccessContinueWith(t=>{t.dispose(e)})}get connectionEvents(){return this.privConnectionEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}recognize(e,t,r){return void 0!==this.recognizeOverride?this.recognizeOverride(e,t,r):(this.privConnectionConfigurationPromise=null,this.privRecognizerConfig.recognitionMode=e,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events),this.connectImpl(),this.audioSource.attach(this.privRequestSession.audioNodeId).continueWithPromise(e=>{let n;return e.isError?(this.cancelRecognitionLocal(Z.Error,_e.ConnectionFailure,e.error,t),m.b.fromError(e.error)):(n=new Oe(e.result,this.audioSource.format),this.privRequestSession.onAudioSourceAttachCompleted(n,!1),this.audioSource.deviceInfo.onSuccessContinueWithPromise(e=>(this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:e},this.configureConnection().on(e=>{const i=new ne(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,i);const o=this.receiveMessage(t,r),s=this.sendAudio(n);return s.on(e=>{},e=>{this.cancelRecognitionLocal(Z.Error,_e.RuntimeError,e,t)}),m.b.whenAll([o,s]).on(e=>!0,e=>{this.cancelRecognitionLocal(Z.Error,_e.RuntimeError,e,t)})},e=>{this.cancelRecognitionLocal(Z.Error,_e.ConnectionFailure,e,t)}).continueWithPromise(e=>e.isError?m.b.fromError(e.error):m.b.fromResult(!0)))))}))}stopRecognizing(){this.privRequestSession.isRecognizing&&(this.privRequestSession.onStopRecognizing(),this.sendTelemetryData(),this.audioSource.turnOff(),this.sendFinalAudio(),this.privRequestSession.dispose())}connect(){this.connectImpl().result()}disconnect(){void 0===this.disconnectOverride?(this.cancelRecognitionLocal(Z.Error,_e.NoError,"Disconnecting",void 0),this.privConnectionPromise.result().isCompleted?this.privConnectionPromise.result().isError||(this.privConnectionPromise.result().result.dispose(),this.privConnectionPromise=null):this.privConnectionPromise.onSuccessContinueWith(e=>{e.dispose()})):this.disconnectOverride()}sendMessage(e){}cancelRecognitionLocal(e,t,r,n){this.privRequestSession.isRecognizing&&(this.privRequestSession.onStopRecognizing(),this.sendTelemetryData(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,t,r,n))}connectImpl(e=!1){if(void 0!==this.connectImplOverride)return this.connectImplOverride(e);if(this.privConnectionPromise)return this.privConnectionPromise.result().isCompleted&&(this.privConnectionPromise.result().isError||this.privConnectionPromise.result().result.state()===Me.a.Disconnected)?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise;this.privAuthFetchEventId=Object(_.b)(),this.privConnectionId=Object(_.b)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);const t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=t.continueWithPromise(t=>{if(t.isError)throw this.privRequestSession.onAuthCompleted(!0,t.error),new Error(t.error);this.privRequestSession.onAuthCompleted(!1);const r=this.privConnectionFactory.create(this.privRecognizerConfig,t.result,this.privConnectionId);return this.privRequestSession.listenForServiceTelemetry(r.events),r.events.attach(e=>{this.connectionEvents.onEvent(e)}),r.open().onSuccessContinueWithPromise(t=>200===t.statusCode?(this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId),this.privRequestSession.onConnectionEstablishCompleted(t.statusCode),m.b.fromResult(r)):403!==t.statusCode||e?(this.privRequestSession.onConnectionEstablishCompleted(t.statusCode,t.reason),m.b.fromError(`Unable to contact server. StatusCode: ${t.statusCode}, ${this.privRecognizerConfig.parameters.getProperty(Re.SpeechServiceConnection_Endpoint)} Reason: ${t.reason}`)):this.connectImpl(!0))}),this.privConnectionPromise}sendFinalAudio(){const e=new m.a;return this.fetchConnection().on(t=>{t.send(new Ye(xe.b.Binary,"audio",this.privRequestSession.requestId,null,null)).on(t=>{e.resolve(!0)},t=>{e.reject(t)})},t=>{e.reject(t)}),e.promise()}configureConnection(){return void 0!==this.configConnectionOverride?this.configConnectionOverride():this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.result().isCompleted&&(this.privConnectionConfigurationPromise.result().isError||this.privConnectionConfigurationPromise.result().result.state()===Me.a.Disconnected)?(this.privConnectionConfigurationPromise=null,this.configureConnection()):this.privConnectionConfigurationPromise:(this.privConnectionConfigurationPromise=this.connectImpl().onSuccessContinueWithPromise(e=>this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()).onSuccessContinueWithPromise(t=>this.sendSpeechContext(e).onSuccessContinueWith(t=>e))),this.privConnectionConfigurationPromise)}}$e.telemetryDataEnabled=!0;class Xe{constructor(e,t){this.privHeaderName=e,this.privToken=t}get headerName(){return this.privHeaderName}get token(){return this.privToken}}const Ze="Ocp-Apim-Subscription-Key";class et{constructor(e){if(this.fetch=e=>m.b.fromResult(this.privAuthInfo),this.fetchOnExpiry=e=>m.b.fromResult(this.privAuthInfo),!e)throw new T.a("subscriptionKey");this.privAuthInfo=new Xe(Ze,e)}}const tt="Authorization";class rt{constructor(e,t){if(this.fetch=e=>this.privFetchCallback(e).onSuccessContinueWith(e=>new Xe(tt,e)),this.fetchOnExpiry=e=>this.privFetchOnExpiryCallback(e).onSuccessContinueWith(e=>new Xe(tt,e)),!e)throw new T.a("fetchCallback");if(!t)throw new T.a("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=t}}class nt{constructor(e,t,r){this.audioConfig=void 0!==e?e:J.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=r,this.implCommonRecognizerSetup()}close(){B.throwIfDisposed(this.privDisposed),this.dispose(!0)}get internalData(){return this.privReco}dispose(e){this.privDisposed||(e&&this.privReco&&(this.privReco.audioSource.turnOff(),this.privReco.dispose()),this.privDisposed=!0)}static get telemetryEnabled(){return $e.telemetryDataEnabled}static enableTelemetry(e){$e.telemetryDataEnabled=e}implCommonRecognizerSetup(){let e="undefined"!=typeof window?"Browser":"Node",t="unknown",r="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);const n=this.createRecognizerConfig(new v(new d(new y(e,t,r)))),i=this.privProperties.getProperty(Re.SpeechServiceConnection_Key,void 0),o=i&&""!==i?new et(i):new rt(e=>{const t=this.privProperties.getProperty(Re.SpeechServiceAuthorization_Token,void 0);return m.b.fromResult(t)},e=>{const t=this.privProperties.getProperty(Re.SpeechServiceAuthorization_Token,void 0);return m.b.fromResult(t)});this.privReco=this.createServiceRecognizer(o,this.privConnectionFactory,this.audioConfig,n)}implRecognizerStart(e,t,r){this.privReco.recognize(e,t,r).on(e=>{},e=>{r&&r("Runtime error: "+e)})}implRecognizerStop(){this.privReco&&this.privReco.stopRecognizing()}}class it{constructor(e){this.privSpeechHypothesis=JSON.parse(e)}static fromJSON(e){return new it(e)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}}var ot,st;!function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"}(ot||(ot={})),function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests"}(st||(st={}));class ct{constructor(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=st[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new ct(e)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}}class at{static implTranslateRecognitionResult(e){let t=te.Canceled;switch(e){case st.Success:t=te.RecognizedSpeech;break;case st.NoMatch:case st.InitialSilenceTimeout:case st.BabbleTimeout:case st.EndOfDictation:t=te.NoMatch;break;case st.Error:default:t=te.Canceled}return t}static implTranslateCancelResult(e){let t=Z.EndOfStream;switch(e){case st.Success:case st.EndOfDictation:case st.NoMatch:t=Z.EndOfStream;break;case st.InitialSilenceTimeout:case st.BabbleTimeout:case st.Error:default:t=Z.Error}return t}static implTranslateCancelErrorCode(e){let t=_e.NoError;switch(e){case st.Error:t=_e.ServiceError;break;case st.TooManyRequests:t=_e.TooManyRequests;break;default:t=_e.NoError}return t}}class ut{constructor(e){this.privDetailedSpeechPhrase=JSON.parse(e),this.privDetailedSpeechPhrase.RecognitionStatus=st[this.privDetailedSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new ut(e)}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}}class pt extends $e{constructor(e,t,r,n,i){super(e,t,r,n,i),this.privSpeechRecognizer=i}processTypeSpecificMessages(e,t,r){let n;const i=new Ce;switch(i.setProperty(Re.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const o=it.fromJSON(e.textBody),s=o.Offset+this.privRequestSession.currentTurnAudioOffset;n=new ce(this.privRequestSession.requestId,te.RecognizingSpeech,o.Text,o.Duration,s,void 0,e.textBody,i),this.privRequestSession.onHypothesis(s);const c=new he(n,o.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,c)}catch(e){}break;case"speech.phrase":const a=ct.fromJSON(e.textBody),u=at.implTranslateRecognitionResult(a.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+a.Offset+a.Duration),te.Canceled===u){const e=at.implTranslateCancelResult(a.RecognitionStatus);this.cancelRecognitionLocal(e,at.implTranslateCancelErrorCode(a.RecognitionStatus),void 0,t)}else{if(!this.privRequestSession.isSpeechEnded||u!==te.NoMatch||a.RecognitionStatus===st.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(ye)===ee[ee.Simple])n=new ce(this.privRequestSession.requestId,u,a.DisplayText,a.Duration,a.Offset+this.privRequestSession.currentTurnAudioOffset,void 0,e.textBody,i);else{const t=ut.fromJSON(e.textBody);n=new ce(this.privRequestSession.requestId,u,t.RecognitionStatus===st.Success?t.NBest[0].Display:void 0,t.Duration,t.Offset+this.privRequestSession.currentTurnAudioOffset,void 0,e.textBody,i)}const t=new he(n,n.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,t)}catch(e){}}if(t){try{t(n)}catch(e){r&&r(e)}t=void 0,r=void 0}}}}cancelRecognition(e,t,r,n,i,o){const s=new Ce;if(s.setProperty(me,_e[n]),this.privSpeechRecognizer.canceled){const t=new le(r,i,n,void 0,e);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,t)}catch(e){}}if(o){const e=new ce(t,te.Canceled,void 0,void 0,void 0,i,void 0,s);try{o(e)}catch(e){}}}}var ht=r(95);class lt{constructor(e,t,r,n,i,o){if(this.privIsDisposed=!1,this.dispose=()=>{this.privIsDisposed=!0,this.privConnectionMessageAdapter&&this.privConnectionMessageAdapter.close()},this.isDisposed=()=>this.privIsDisposed,this.state=()=>this.privConnectionMessageAdapter.state,this.open=()=>this.privConnectionMessageAdapter.open(),this.send=e=>this.privConnectionMessageAdapter.send(e),this.read=()=>this.privConnectionMessageAdapter.read(),!e)throw new T.a("uri");if(!n)throw new T.a("messageFormatter");this.privMessageFormatter=n;let s="",c=0;if(t)for(const r in t)if(r){s+=0===c&&-1===e.indexOf("?")?"?":"&",s+=`${r}=${encodeURIComponent(t[r])}`,c++}if(r)for(const e in r)if(e){s+=0===c?"?":"&",s+=`${e}=${encodeURIComponent(r[e])}`,c++}this.privUri=e+s,this.privId=o||Object(_.b)(),this.privConnectionMessageAdapter=new ht.a(this.privUri,this.id,this.privMessageFormatter,i,r)}get id(){return this.privId}get events(){return this.privConnectionMessageAdapter.events}}class ft{constructor(e,t,r,n){this.privProxyHostName=e,this.privProxyPort=t,this.privProxyUserName=r,this.privProxyPassword=n}static fromRecognizerConfig(e){return new ft(e.parameters.getProperty(Re.SpeechServiceConnection_ProxyHostName),parseInt(e.parameters.getProperty(Re.SpeechServiceConnection_ProxyPort),10),e.parameters.getProperty(Re.SpeechServiceConnection_ProxyUserName),e.parameters.getProperty(Re.SpeechServiceConnection_ProxyPassword))}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}}class vt{static get TestHooksParamName(){return"testhooks"}static get ConnectionIdHeader(){return"X-ConnectionId"}static get DeploymentIdParamName(){return"cid"}static get FormatParamName(){return"format"}static get LanguageParamName(){return"language"}static get TranslationFromParamName(){return"from"}static get TranslationToParamName(){return"to"}static get Profanify(){return"profanity"}static get EnableAudioLogging(){return"storeAudio"}static get EnableWordLevelTimestamps(){return"wordLevelTimestamps"}static get InitialSilenceTimeoutMs(){return"initialSilenceTimeoutMs"}static get EndSilenceTimeoutMs(){return"endSilenceTimeoutMs"}static get StableIntermediateThreshold(){return"stableIntermediateThreshold"}static get StableTranslation(){return"stableTranslation"}}class dt{setCommonUrlParams(e,t,r){this.setUrlParameter(Re.SpeechServiceConnection_EnableAudioLogging,vt.EnableAudioLogging,e,t,r),this.setUrlParameter(Re.SpeechServiceResponse_RequestWordLevelTimestamps,vt.EnableWordLevelTimestamps,e,t,r),this.setUrlParameter(Re.SpeechServiceResponse_ProfanityOption,vt.Profanify,e,t,r),this.setUrlParameter(Re.SpeechServiceConnection_InitialSilenceTimeoutMs,vt.InitialSilenceTimeoutMs,e,t,r),this.setUrlParameter(Re.SpeechServiceConnection_EndSilenceTimeoutMs,vt.EndSilenceTimeoutMs,e,t,r),this.setUrlParameter(Re.SpeechServiceResponse_StablePartialResultThreshold,vt.StableIntermediateThreshold,e,t,r);const n=JSON.parse(e.parameters.getProperty(Se,"{}"));Object.keys(n).forEach((e,r,i)=>{t[e]=n[e]})}setUrlParameter(e,t,r,n,i){const o=r.parameters.getProperty(e,void 0);!o||i&&-1!==i.search(t)||(n[t]=o.toLocaleLowerCase())}}var gt=r(97);const yt="\r\n";class mt{constructor(){this.toConnectionMessage=e=>{const t=new m.a;try{if(e.messageType===xe.b.Text){const r=e.textContent;let n={},i=null;if(r){const e=r.split("\r\n\r\n");e&&e.length>0&&(n=this.parseHeaders(e[0]),e.length>1&&(i=e[1]))}t.resolve(new xe.a(e.messageType,i,n,e.id))}else if(e.messageType===xe.b.Binary){const r=e.binaryContent;let n={},i=null;if(!r||r.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const o=new DataView(r),s=o.getInt16(0);if(r.byteLength<s+2)throw new Error("Invalid binary message format. Header content missing.");let c="";for(let e=0;e<s;e++)c+=String.fromCharCode(o.getInt8(e+2));n=this.parseHeaders(c),r.byteLength>s+2&&(i=r.slice(2+s)),t.resolve(new xe.a(e.messageType,i,n,e.id))}}catch(e){t.reject(`Error formatting the message. Error: ${e}`)}return t.promise()},this.fromConnectionMessage=e=>{const t=new m.a;try{if(e.messageType===xe.b.Text){const r=`${this.makeHeaders(e)}${yt}${e.textBody?e.textBody:""}`;t.resolve(new gt.a(xe.b.Text,r,e.id))}else if(e.messageType===xe.b.Binary){const r=this.makeHeaders(e),n=e.binaryBody,i=new Int8Array(this.stringToArrayBuffer(r)),o=new ArrayBuffer(2+i.byteLength+(n?n.byteLength:0)),s=new DataView(o);s.setInt16(0,i.length);for(let e=0;e<i.byteLength;e++)s.setInt8(2+e,i[e]);if(n){const e=new Int8Array(n);for(let t=0;t<e.byteLength;t++)s.setInt8(2+i.byteLength+t,e[t])}t.resolve(new gt.a(xe.b.Binary,o,e.id))}}catch(e){t.reject(`Error formatting the message. ${e}`)}return t.promise()},this.makeHeaders=e=>{let t="";if(e.headers)for(const r in e.headers)r&&(t+=`${r}: ${e.headers[r]}${yt}`);return t},this.parseHeaders=e=>{const t={};if(e){const r=e.match(/[^\r\n]+/g);if(t)for(const e of r)if(e){const r=e.indexOf(":"),n=r>0?e.substr(0,r).trim().toLowerCase():e,i=r>0&&e.length>r+1?e.substr(r+1).trim():"";t[n]=i}}return t},this.stringToArrayBuffer=e=>{const t=new ArrayBuffer(e.length),r=new DataView(t);for(let t=0;t<e.length;t++)r.setUint8(t,e.charCodeAt(t));return t}}}class St extends dt{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.create=(e,t,r)=>{let n=e.parameters.getProperty(Re.SpeechServiceConnection_Endpoint,void 0);const o={},s=e.parameters.getProperty(Re.SpeechServiceConnection_EndpointId,void 0),c=e.parameters.getProperty(Re.SpeechServiceConnection_RecoLanguage,void 0);if(s?n&&-1!==n.search(vt.DeploymentIdParamName)||(o[vt.DeploymentIdParamName]=s):c&&(n&&-1!==n.search(vt.LanguageParamName)||(o[vt.LanguageParamName]=c)),n&&-1!==n.search(vt.FormatParamName)||(o[vt.FormatParamName]=e.parameters.getProperty(ye,ee[ee.Simple]).toLowerCase()),this.setCommonUrlParams(e,o,n),!n){const t="wss://"+e.parameters.getProperty(Re.SpeechServiceConnection_Region,void 0)+".stt.speech.microsoft.com";switch(e.recognitionMode){case i.Conversation:n="true"===e.parameters.getProperty(be,"false")?t+this.dictationRelativeUri:t+this.conversationRelativeUri;break;case i.Dictation:n=t+this.dictationRelativeUri;break;default:n=t+this.interactiveRelativeUri}}const a={};return a[t.headerName]=t.token,a[vt.ConnectionIdHeader]=r,new lt(n,o,a,new mt,ft.fromRecognizerConfig(e),r)}}}class bt extends nt{constructor(e,t){const r=e;B.throwIfNull(r,"speechConfig"),B.throwIfNullOrWhitespace(r.properties.getProperty(Re.SpeechServiceConnection_RecoLanguage),Re[Re.SpeechServiceConnection_RecoLanguage]),super(t,r.properties,new St),this.privDisposedSpeechRecognizer=!1}get endpointId(){return B.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(Re.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(Re.SpeechServiceAuthorization_Token)}set authorizationToken(e){B.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Re.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return B.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(Re.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return B.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(ye,ee[ee.Simple])===ee[ee.Simple]?ee.Simple:ee.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(e,t){try{B.throwIfDisposed(this.privDisposedSpeechRecognizer),this.implRecognizerStop(),this.implRecognizerStart(i.Interactive,t=>{this.implRecognizerStop(),e&&e(t)},e=>{this.implRecognizerStop(),t&&t(e)})}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}startContinuousRecognitionAsync(e,t){try{if(B.throwIfDisposed(this.privDisposedSpeechRecognizer),this.implRecognizerStop(),this.implRecognizerStart(i.Conversation,void 0,void 0),e){try{e()}catch(e){t&&t(e)}e=void 0}}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}stopContinuousRecognitionAsync(e,t){try{if(B.throwIfDisposed(this.privDisposedSpeechRecognizer),this.implRecognizerStop(),e)try{e()}catch(e){t&&t(e)}}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}startKeywordRecognitionAsync(e,t,r){B.throwIfNull(e,"model"),r&&r("Not yet implemented.")}stopKeywordRecognitionAsync(e,t){e&&e()}close(){B.throwIfDisposed(this.privDisposedSpeechRecognizer),this.dispose(!0)}dispose(e){this.privDisposedSpeechRecognizer||(e&&(this.implRecognizerStop(),this.privDisposedSpeechRecognizer=!0),super.dispose(e))}createRecognizerConfig(e){return new f(e,this.properties)}createServiceRecognizer(e,t,r,n){return new pt(e,t,r,n,this)}}const Rt="X-ConnectionId";class wt extends dt{constructor(){super(...arguments),this.create=(e,t,r)=>{let n=e.parameters.getProperty(Re.SpeechServiceConnection_Endpoint);if(!n){const t=e.parameters.getProperty(Re.SpeechServiceConnection_IntentRegion);n="wss://speech.platform.bing.com/speech/"+this.getSpeechRegionFromIntentRegion(t)+"/recognition/interactive/cognitiveservices/v1"}const i={format:"simple",language:e.parameters.getProperty(Re.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,i,n);const o={};return o[t.headerName]=t.token,o[Rt]=r,new lt(n,i,o,new mt,ft.fromRecognizerConfig(e),r)}}getSpeechRegionFromIntentRegion(e){switch(e){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return e}}}class Ct{constructor(e,t){this.modelImpl=e,this.intentName=t}}class Pt extends oe{constructor(e,t,r,n,i,o){super(n,i,o),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}class It{constructor(e){this.privIntentResponse=JSON.parse(e)}static fromJSON(e){return new It(e)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}}class Et extends $e{constructor(e,t,r,n,i){super(e,t,r,n,i),this.privIntentRecognizer=i,this.privIntentDataSent=!1}setIntents(e,t){this.privAddedLmIntents=e,this.privUmbrellaIntent=t,this.privIntentDataSent=!0}processTypeSpecificMessages(e,t,r){let n,i;const o=new Ce;switch(e.messageType===xe.b.Text&&o.setProperty(Re.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":const s=it.fromJSON(e.textBody);if(n=new ae(void 0,this.privRequestSession.requestId,te.RecognizingIntent,s.Text,s.Duration,s.Offset+this.privRequestSession.currentTurnAudioOffset,void 0,e.textBody,o),this.privRequestSession.onHypothesis(n.offset),i=new oe(n,s.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,i)}catch(e){}break;case"speech.phrase":const c=ct.fromJSON(e.textBody);n=new ae(void 0,this.privRequestSession.requestId,at.implTranslateRecognitionResult(c.RecognitionStatus),c.DisplayText,c.Duration,c.Offset+this.privRequestSession.currentTurnAudioOffset,void 0,e.textBody,o),i=new oe(n,n.offset,this.privRequestSession.sessionId);const a=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,i)}catch(e){}if(t){try{t(n)}catch(e){r&&r(e)}t=void 0,r=void 0}};!1===this.privIntentDataSent||te.NoMatch===i.result.reason?(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),a()):this.privPendingIntentArgs=i;break;case"response":if(i=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,void 0===i){if(""===e.textBody)return;i=new oe(new ae,0,this.privRequestSession.sessionId)}const u=It.fromJSON(e.textBody);let p=this.privAddedLmIntents[u.topScoringIntent.intent];if(void 0!==this.privUmbrellaIntent&&(p=this.privUmbrellaIntent),null!==u&&void 0!==p){const t=void 0===p.intentName?u.topScoringIntent.intent:p.intentName;let r=i.result.reason;void 0!==t&&(r=te.RecognizedIntent);const n=void 0!==i.result.properties?i.result.properties:new Ce;n.setProperty(Re.LanguageUnderstandingServiceResponse_JsonResult,e.textBody),i=new oe(new ae(t,i.result.resultId,r,i.result.text,i.result.duration,i.result.offset,i.result.errorDetails,i.result.json,n),i.offset,i.sessionId)}if(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,i)}catch(e){}if(t){try{t(i.result)}catch(e){r&&r(e)}t=void 0,r=void 0}}}cancelRecognition(e,t,r,n,i,o){const s=new Ce;if(s.setProperty(me,_e[n]),this.privIntentRecognizer.canceled){const t=new Pt(r,i,n,void 0,void 0,e);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,t)}catch(e){}}if(o){const e=new ae(void 0,t,te.Canceled,void 0,void 0,void 0,i,void 0,s);try{o(e)}catch(e){}}}}class At extends nt{constructor(e,t){B.throwIfNullOrUndefined(e,"speechConfig");const r=e;B.throwIfNullOrUndefined(r,"speechConfig"),super(t,r.properties,new wt),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=r.properties,B.throwIfNullOrWhitespace(this.properties.getProperty(Re.SpeechServiceConnection_RecoLanguage),Re[Re.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return B.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(Re.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(Re.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(Re.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e,t){try{if(B.throwIfDisposed(this.privDisposedIntentRecognizer),this.implRecognizerStop(),0!==Object.keys(this.privAddedLmIntents).length||void 0!==this.privUmbrellaIntent){const e=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",e.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(e.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}this.implRecognizerStart(i.Interactive,t=>{this.implRecognizerStop(),e&&e(t)},e=>{this.implRecognizerStop(),t&&t(e)})}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}startContinuousRecognitionAsync(e,t){try{if(B.throwIfDisposed(this.privDisposedIntentRecognizer),this.implRecognizerStop(),0!==Object.keys(this.privAddedLmIntents).length){const e=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",e.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(e.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}if(this.implRecognizerStart(i.Conversation,void 0,void 0),e){try{e()}catch(e){t&&t(e)}e=void 0}}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}stopContinuousRecognitionAsync(e,t){try{if(B.throwIfDisposed(this.privDisposedIntentRecognizer),this.implRecognizerStop(),e)try{e()}catch(e){t&&t(e)}}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}startKeywordRecognitionAsync(e,t,r){B.throwIfNull(e,"model"),r&&r("Not yet implemented.")}stopKeywordRecognitionAsync(e,t){e&&e()}addIntent(e,t){B.throwIfDisposed(this.privDisposedIntentRecognizer),B.throwIfNullOrWhitespace(t,"intentId"),B.throwIfNullOrWhitespace(e,"simplePhrase"),this.privAddedIntents.push([t,e])}addIntentWithLanguageModel(e,t,r){B.throwIfDisposed(this.privDisposedIntentRecognizer),B.throwIfNullOrWhitespace(e,"intentId"),B.throwIfNull(t,"model");const n=t;B.throwIfNullOrWhitespace(n.appId,"model.appId"),this.privAddedLmIntents[e]=new Ct(n,r)}addAllIntents(e,t){B.throwIfNull(e,"model");const r=e;B.throwIfNullOrWhitespace(r.appId,"model.appId"),this.privUmbrellaIntent=new Ct(r,t)}close(){B.throwIfDisposed(this.privDisposedIntentRecognizer),this.dispose(!0)}createRecognizerConfig(e){return new f(e,this.properties)}createServiceRecognizer(e,t,r,n){return new Et(e,t,r,n,this)}dispose(e){this.privDisposedIntentRecognizer||e&&(this.privDisposedIntentRecognizer=!0,super.dispose(e))}buildSpeechContext(){let e,t,r;const n=[];void 0!==this.privUmbrellaIntent&&(e=this.privUmbrellaIntent.modelImpl.appId,t=this.privUmbrellaIntent.modelImpl.region,r=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(const i of Object.keys(this.privAddedLmIntents)){const o=this.privAddedLmIntents[i];if(void 0===e)e=o.modelImpl.appId;else if(e!==o.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(void 0===t)t=o.modelImpl.region;else if(t!==o.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(void 0===r)r=o.modelImpl.subscriptionKey;else if(r!==o.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");const s="luis/"+e+"-PRODUCTION#"+i;n.push(s)}return{Intent:{id:e,key:void 0===r?this.privProperties.getProperty(Re[Re.SpeechServiceConnection_Key]):r,provider:"LUIS"},ReferenceGrammars:void 0===this.privUmbrellaIntent?n:["luis/"+e+"-PRODUCTION"]}}}const Ot="X-ConnectionId";class Tt extends dt{constructor(){super(...arguments),this.create=(e,t,r)=>{let n=e.parameters.getProperty(Re.SpeechServiceConnection_Endpoint,void 0);if(!n){n="wss://"+e.parameters.getProperty(Re.SpeechServiceConnection_Region,void 0)+".s2s.speech.microsoft.com/speech/translation/cognitiveservices/v1"}const i={from:e.parameters.getProperty(Re.SpeechServiceConnection_RecoLanguage),to:e.parameters.getProperty(Re.SpeechServiceConnection_TranslationToLanguages)};this.setCommonUrlParams(e,i,n),this.setUrlParameter(Re.SpeechServiceResponse_TranslationRequestStablePartialResult,vt.StableTranslation,e,i,n);void 0!==e.parameters.getProperty(Re.SpeechServiceConnection_TranslationVoice,void 0)&&(i.voice=e.parameters.getProperty(Re.SpeechServiceConnection_TranslationVoice),i.features="texttospeech");const o={};return o[t.headerName]=t.token,o[Ot]=r,new lt(n,i,o,new mt,ft.fromRecognizerConfig(e),r)}}}var _t,Dt;!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(_t||(_t={}));class xt{constructor(e,t,r,n,i){this.privCancelReason=t,this.privErrorDetails=r,this.privResult=i,this.privSessionId=e,this.privErrorCode=n}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}class Mt{constructor(){this.privMap=new Ce}get(e,t){return this.privMap.getProperty(e,t)}set(e,t){this.privMap.setProperty(e,t)}}class Nt{constructor(e){this.privTranslationHypothesis=JSON.parse(e),this.privTranslationHypothesis.Translation.TranslationStatus=_t[this.privTranslationHypothesis.Translation.TranslationStatus]}static fromJSON(e){return new Nt(e)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}}class zt{constructor(e){this.privTranslationPhrase=JSON.parse(e),this.privTranslationPhrase.RecognitionStatus=st[this.privTranslationPhrase.RecognitionStatus],void 0!==this.privTranslationPhrase.Translation&&(this.privTranslationPhrase.Translation.TranslationStatus=_t[this.privTranslationPhrase.Translation.TranslationStatus])}static fromJSON(e){return new zt(e)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Translation(){return this.privTranslationPhrase.Translation}}class jt{constructor(e){this.privSynthesisEnd=JSON.parse(e),this.privSynthesisEnd.SynthesisStatus=ot[this.privSynthesisEnd.SynthesisStatus]}static fromJSON(e){return new jt(e)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}}class kt extends $e{constructor(e,t,r,n,i){super(e,t,r,n,i),this.privTranslationRecognizer=i}processTypeSpecificMessages(e,t,r){const n=new Ce;switch(e.messageType===xe.b.Text&&n.setProperty(Re.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"translation.hypothesis":const i=this.fireEventForResult(Nt.fromJSON(e.textBody),n);if(this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+i.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,i)}catch(e){}break;case"translation.phrase":const o=zt.fromJSON(e.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+o.Offset+o.Duration),o.RecognitionStatus===st.Success){const e=this.fireEventForResult(o,n);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,e)}catch(e){}if(t){try{t(e.result)}catch(e){r&&r(e)}t=void 0,r=void 0}break}{const i=at.implTranslateRecognitionResult(o.RecognitionStatus),s=new de(void 0,this.privRequestSession.requestId,i,o.Text,o.Duration,this.privRequestSession.currentTurnAudioOffset+o.Offset,void 0,e.textBody,n);if(i===te.Canceled){const e=at.implTranslateCancelResult(o.RecognitionStatus);this.cancelRecognitionLocal(e,at.implTranslateCancelErrorCode(o.RecognitionStatus),void 0,t)}else{if(!this.privRequestSession.isSpeechEnded||i!==te.NoMatch||o.RecognitionStatus===st.InitialSilenceTimeout){const e=new fe(s,s.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,e)}catch(e){}}if(t){try{t(s)}catch(e){r&&r(e)}t=void 0,r=void 0}}}break;case"translation.synthesis":this.sendSynthesisAudio(e.binaryBody,this.privRequestSession.sessionId);break;case"translation.synthesis.end":const s=jt.fromJSON(e.textBody);switch(s.SynthesisStatus){case ot.Error:if(this.privTranslationRecognizer.synthesizing){const e=new ge(te.Canceled,void 0),t=new ve(e,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,t)}catch(e){}}if(this.privTranslationRecognizer.canceled){const e=new xt(this.privRequestSession.sessionId,Z.Error,s.FailureReason,_e.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,e)}catch(e){}}break;case ot.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId)}}}cancelRecognition(e,t,r,n,i,o){const s=new Ce;if(s.setProperty(me,_e[n]),this.privTranslationRecognizer.canceled){const t=new xt(e,r,i,n,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,t)}catch(e){}}if(o){const e=new de(void 0,t,te.Canceled,void 0,void 0,void 0,i,void 0,s);try{o(e)}catch(e){}}}fireEventForResult(e,t){let r,n;if(void 0!==e.Translation.Translations){r=new Mt;for(const t of e.Translation.Translations)r.set(t.Language,t.Text)}n=e instanceof zt?e.Translation.TranslationStatus===_t.Success?te.TranslatedSpeech:te.RecognizedSpeech:te.TranslatingSpeech;const i=e.Offset+this.privRequestSession.currentTurnAudioOffset,o=new de(r,this.privRequestSession.requestId,n,e.Text,e.Duration,i,e.Translation.FailureReason,JSON.stringify(e),t);return new fe(o,i,this.privRequestSession.sessionId)}sendSynthesisAudio(e,t){const r=void 0===e?te.SynthesizingAudioCompleted:te.SynthesizingAudio,n=new ge(r,e),i=new ve(n,t);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,i)}catch(e){}}}class Lt extends nt{constructor(e,t){const r=e;B.throwIfNull(r,"speechConfig"),super(t,r.properties,new Tt),this.privDisposedTranslationRecognizer=!1,this.privProperties=r.properties.clone(),void 0!==this.properties.getProperty(Re.SpeechServiceConnection_TranslationVoice,void 0)&&B.throwIfNullOrWhitespace(this.properties.getProperty(Re.SpeechServiceConnection_TranslationVoice),Re[Re.SpeechServiceConnection_TranslationVoice]),B.throwIfNullOrWhitespace(this.properties.getProperty(Re.SpeechServiceConnection_TranslationToLanguages),Re[Re.SpeechServiceConnection_TranslationToLanguages]),B.throwIfNullOrWhitespace(this.properties.getProperty(Re.SpeechServiceConnection_RecoLanguage),Re[Re.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return B.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Re.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return B.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Re.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return B.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(Re.SpeechServiceConnection_TranslationVoice,void 0)}get authorizationToken(){return this.properties.getProperty(Re.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(Re.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e,t){try{B.throwIfDisposed(this.privDisposedTranslationRecognizer),this.implRecognizerStop(),this.implRecognizerStart(i.Conversation,t=>{this.implRecognizerStop(),e&&e(t)},e=>{this.implRecognizerStop(),t&&t(e)})}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}startContinuousRecognitionAsync(e,t){try{if(B.throwIfDisposed(this.privDisposedTranslationRecognizer),this.implRecognizerStop(),this.implRecognizerStart(i.Conversation,void 0,void 0),e){try{e()}catch(e){t&&t(e)}e=void 0}}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}stopContinuousRecognitionAsync(e,t){try{if(B.throwIfDisposed(this.privDisposedTranslationRecognizer),this.implRecognizerStop(),e)try{e()}catch(e){t&&t(e)}}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}close(){B.throwIfDisposed(this.privDisposedTranslationRecognizer),this.dispose(!0)}dispose(e){this.privDisposedTranslationRecognizer||e&&(this.implRecognizerStop(),this.privDisposedTranslationRecognizer=!0,super.dispose(e))}createRecognizerConfig(e){return new f(e,this.properties)}createServiceRecognizer(e,t,r,n){return new kt(e,t,r,n,this)}}!function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(Dt||(Dt={}));class Bt{constructor(e){this.privReason=e}static fromResult(e){const t=ct.fromJSON(e.json);let r=Dt.NotRecognized;switch(t.RecognitionStatus){case st.BabbleTimeout:r=Dt.InitialBabbleTimeout;break;case st.InitialSilenceTimeout:r=Dt.InitialSilenceTimeout;break;default:r=Dt.NotRecognized}return new Bt(r)}get reason(){return this.privReason}}class Ft{constructor(e,t,r){this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}static fromResult(e){let t=Z.Error,r=_e.NoError;if(e.json){const r=ct.fromJSON(e.json);t=at.implTranslateCancelResult(r.RecognitionStatus)}return e.properties&&(r=_e[e.properties.getProperty(me,_e[_e.NoError])]),new Ft(t,e.errorDetails,r)}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}}class qt extends ne{}class Ut{static fromRecognizer(e){const t=e.internalData,r=new Ut;return r.privServiceRecognizer=t,r.privEventListener=r.privServiceRecognizer.connectionEvents.attach(e=>{"ConnectionEstablishedEvent"===e.name?r.connected&&r.connected(new qt(e.connectionId)):"ConnectionClosedEvent"===e.name&&r.disconnected&&r.disconnected(new qt(e.connectionId))}),r}openConnection(){this.privServiceRecognizer.connect()}closeConnection(){this.privServiceRecognizer.disconnect()}close(){}}class Wt{constructor(e){this.privGrammerBuilder=e.dynamicGrammar}static fromRecognizer(e){const t=e.internalData;return new Wt(t)}addPhrase(e){this.privGrammerBuilder.addPhrase(e)}addPhrases(e){this.privGrammerBuilder.addPhrase(e)}clear(){this.privGrammerBuilder.clearPhrases()}}class Vt{constructor(){}}class Ht extends Vt{constructor(){super(),this.privSpeechConfig=new Ie}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(e){B.throwIfNullOrWhitespace(e,"value"),this.privSpeechConfig.speechRecognitionLanguage=e}setProperty(e,t){this.privSpeechConfig.setProperty(e,t)}getProperty(e,t){return this.privSpeechConfig.getProperty(e)}setProxy(e,t,r,n){this.setProperty(Re.SpeechServiceConnection_ProxyHostName,e),this.setProperty(Re.SpeechServiceConnection_ProxyPort,`${t}`),r&&this.setProperty(Re.SpeechServiceConnection_ProxyUserName,r),n&&this.setProperty(Re.SpeechServiceConnection_ProxyPassword,n)}setServiceProperty(e,t,r){this.privSpeechConfig.setServiceProperty(e,t,r)}close(){}}class Gt extends Ht{constructor(){super()}static fromSubscription(e,t){B.throwIfNullOrWhitespace(e,"subscription"),B.throwIfNullOrWhitespace(t,"region");const r=new Ht;return r.setProperty(Re.Conversation_DialogType,"bot_framework"),r.setProperty(Re.SpeechServiceConnection_Key,e),r.setProperty(Re.SpeechServiceConnection_Region,t),r}static fromAuthorizationToken(e,t){B.throwIfNullOrWhitespace(e,"authorizationToken"),B.throwIfNullOrWhitespace(t,"region");const r=new Ht;return r.setProperty(Re.Conversation_DialogType,"bot_framework"),r.setProperty(Re.SpeechServiceAuthorization_Token,e),r.setProperty(Re.SpeechServiceConnection_Region,t),r}}class Jt extends Ht{constructor(){super()}static fromSubscription(e,t,r){B.throwIfNullOrWhitespace(e,"applicationId"),B.throwIfNullOrWhitespace(t,"subscription"),B.throwIfNullOrWhitespace(r,"region");const n=new Ht;return n.setProperty(Re.Conversation_DialogType,"custom_commands"),n.setProperty(Re.Conversation_ApplicationId,e),n.setProperty(Re.SpeechServiceConnection_Key,t),n.setProperty(Re.SpeechServiceConnection_Region,r),n}static fromAuthorizationToken(e,t,r){B.throwIfNullOrWhitespace(e,"applicationId"),B.throwIfNullOrWhitespace(t,"authorizationToken"),B.throwIfNullOrWhitespace(r,"region");const n=new Ht;return n.setProperty(Re.Conversation_DialogType,"custom_commands"),n.setProperty(Re.Conversation_ApplicationId,e),n.setProperty(Re.SpeechServiceAuthorization_Token,t),n.setProperty(Re.SpeechServiceConnection_Region,r),n}set applicationId(e){B.throwIfNullOrWhitespace(e,"value"),this.setProperty(Re.Conversation_ApplicationId,e)}get applicationId(){return this.getProperty(Re.Conversation_ApplicationId)}}const Kt="convai.speech.microsoft.com",Qt={authHeader:"X-DLS-Secret",resourcePath:"",version:"v3"},Yt={authHeader:"X-CommandsAppId",resourcePath:"commands",version:"v1"},$t="api";class Xt extends dt{constructor(){super(...arguments),this.create=(e,t,r)=>{const n=e.parameters.getProperty(Re.Conversation_ApplicationId,""),i=e.parameters.getProperty(Re.Conversation_DialogType),o=e.parameters.getProperty(Re.SpeechServiceConnection_Region),s=e.parameters.getProperty(Re.SpeechServiceConnection_RecoLanguage,"en-US"),c={};c[vt.LanguageParamName]=s;const{resourcePath:a,version:u,authHeader:p}=function(e){switch(e){case"speech_commands":return Yt;case"bot_framework":return Qt}throw new Error(`Invalid dialog type '${e}'`)}(i),h={};let l;return h[t.headerName]=t.token,h[vt.ConnectionIdHeader]=r,""===n?l=`wss://${o}.${Kt}/${$t}/${u}`:(l=`wss://${o}.${Kt}/${a}/${$t}/${u}`,h[p]=n),new lt(l,c,h,new mt,ft.fromRecognizerConfig(e),r)}}}class Zt{constructor(e,t){this.privActivity=e,this.privAudioStream=t}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}}class er{constructor(e){this.privActivityResponse=JSON.parse(e)}static fromJSON(e){return new er(e)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}var tr,rr;!function(e){e[e.None=0]="None",e[e.TextToSpeechAudio=1]="TextToSpeechAudio"}(tr||(tr={}));class nr{constructor(e,t){this.privRequestId=t,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=e,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(e){return e.messageDataStreamType===tr.TextToSpeechAudio&&(this.privAudioStream=Y.createPullStream()),this.privAudioStream}endAudioStream(){null===this.privAudioStream||this.privAudioStream.isClosed||this.privAudioStream.close()}complete(){void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}}class ir{constructor(){this.privTurnMap=new Map}StartTurn(e){if(this.privTurnMap.has(e))throw new T.b("Service error: There is already a turn with id:"+e);const t=new nr(this,e);return this.privTurnMap.set(e,t),this.privTurnMap.get(e)}GetTurn(e){return this.privTurnMap.get(e)}CompleteTurn(e){if(!this.privTurnMap.has(e))throw new T.b("Service error: Received turn end for an unknown turn id:"+e);const t=this.privTurnMap.get(e);return t.complete(),this.privTurnMap.delete(e),t}}class or extends $e{constructor(e,t,r,n,i){super(e,t,r,n,i),this.sendMessage=e=>{const t=Object(_.a)(),r=Object(_.b)(),n={context:{interactionId:t},messagePayload:e,version:.5},i=JSON.stringify(n);this.fetchDialogConnection().onSuccessContinueWith(e=>{e.send(new Ye(xe.b.Text,"agent",r,"application/json",i))})},this.listenOnce=(e,t,r)=>(this.privRecognizerConfig.recognitionMode=e,this.privDialogRequestSession.startNewRecognition(),this.privDialogRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.dialogConnectImpl(),this.sendPreAudioMessages(),this.privSuccessCallback=t,this.privDialogAudioSource.attach(this.privDialogRequestSession.audioNodeId).continueWithPromise(e=>{let r;return e.isError?(this.cancelRecognition(this.privDialogRequestSession.sessionId,this.privDialogRequestSession.requestId,Z.Error,_e.ConnectionFailure,e.error,t),m.b.fromError(e.error)):(r=new Oe(e.result,this.privDialogAudioSource.format),this.privDialogRequestSession.onAudioSourceAttachCompleted(r,!1),this.privDialogAudioSource.deviceInfo.onSuccessContinueWithPromise(e=>(this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:e},this.configConnection().on(e=>{const n=new ne(this.privDialogRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,n),this.sendAudio(r).on(e=>{},e=>{this.cancelRecognition(this.privDialogRequestSession.sessionId,this.privDialogRequestSession.requestId,Z.Error,_e.RuntimeError,e,t)})},e=>{this.cancelRecognition(this.privDialogRequestSession.sessionId,this.privDialogRequestSession.requestId,Z.Error,_e.ConnectionFailure,e,t)}).continueWithPromise(e=>e.isError?m.b.fromError(e.error):m.b.fromResult(!0)))))})),this.sendAudio=e=>{const t=new m.a;let r=Date.now();const n=this.privDialogAudioSource.format,i=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),o=n.avgBytesPerSec/1e3*parseInt(i,10),s=this.privDialogRequestSession.recogNumber,c=()=>{this.privDialogIsDisposed||this.privDialogRequestSession.isSpeechEnded||!this.privDialogRequestSession.isRecognizing||this.privDialogRequestSession.recogNumber!==s||this.fetchDialogConnection().on(i=>{e.read().on(e=>{if(this.privDialogRequestSession.isSpeechEnded)return void t.resolve(!0);let s,a;!e||e.isEnd?(s=null,a=0):(s=e.buffer,this.privDialogRequestSession.onAudioSent(s.byteLength),a=o>=this.privDialogRequestSession.bytesSent?0:Math.max(0,r-Date.now())),setTimeout(()=>{null!==s&&(r=Date.now()+1e3*s.byteLength/(2*n.avgBytesPerSec));const o=i.send(new Ye(xe.b.Binary,"audio",this.privDialogRequestSession.requestId,null,s));e&&!e.isEnd?o.continueWith(e=>{c()}):(this.privDialogRequestSession.onSpeechEnded(),t.resolve(!0))},a)},e=>{this.privDialogRequestSession.isSpeechEnded?t.resolve(!0):t.reject(e)})},e=>{t.reject(e)})};return c(),t.promise()},this.receiveDialogMessageOverride=(e,t)=>{const r=new m.a;return this.fetchDialogConnection().on(n=>n.read().onSuccessContinueWithPromise(n=>{const i=this.isDisposed(),o=!this.isDisposed()&&this.terminateMessageLoop;if(i||o)return r.resolve(void 0),m.b.fromResult(void 0);if(!n)return this.receiveDialogMessageOverride();const s=Ye.fromConnectionMessage(n);switch(s.path.toLowerCase()){case"turn.start":{const e=s.requestId.toUpperCase();e!==this.privDialogRequestSession.requestId.toUpperCase()&&this.privTurnStateManager.StartTurn(e)}break;case"speech.startdetected":const r=Ne.fromJSON(s.textBody),n=new ie(r.Offset,this.privDialogRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,n);break;case"speech.enddetected":let i;i=s.textBody.length>0?s.textBody:"{ Offset: 0 }";const o=Ne.fromJSON(i);this.privDialogRequestSession.onServiceRecognized(o.Offset+this.privDialogRequestSession.currentTurnAudioOffset);const c=new ie(o.Offset+this.privDialogRequestSession.currentTurnAudioOffset,this.privDialogRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,c);break;case"turn.end":{const e=s.requestId.toUpperCase();if(e!==this.privDialogRequestSession.requestId.toUpperCase())this.privTurnStateManager.CompleteTurn(e);else{const e=new ne(this.privDialogRequestSession.sessionId);this.privDialogRequestSession.onServiceTurnEndResponse(!1),this.privDialogRequestSession.isSpeechEnded&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,e)}}break;default:this.processTypeSpecificMessages(s,e,t)}return this.receiveDialogMessageOverride()}),e=>{this.terminateMessageLoop=!0}),r.promise()},this.fetchDialogConnection=()=>this.configConnection(),this.sendAgentConfig=e=>{if(this.agentConfig&&!this.agentConfigSent){const t=this.agentConfig.toJsonString();return this.agentConfigSent=!0,e.send(new Ye(xe.b.Text,"agent.config",this.privDialogRequestSession.requestId,"application/json",t))}return m.b.fromResult(!0)},this.sendAgentContext=e=>{const t={channelData:"",context:{interactionId:Object(_.a)()},version:.5},r=JSON.stringify(t);return e.send(new Ye(xe.b.Text,"speech.agent.context",this.privDialogRequestSession.requestId,"application/json",r))},this.privDialogServiceConnector=i,this.privDialogAuthentication=e,this.receiveMessageOverride=this.receiveDialogMessageOverride,this.privTurnStateManager=new ir,this.recognizeOverride=this.listenOnce,this.connectImplOverride=this.dialogConnectImpl,this.configConnectionOverride=this.configConnection,this.fetchConnectionOverride=this.fetchDialogConnection,this.disconnectOverride=this.privDisconnect,this.privDialogAudioSource=r,this.privDialogRequestSession=new Ue(r.id()),this.privDialogConnectionFactory=t,this.privDialogIsDisposed=!1,this.agentConfigSent=!1}isDisposed(){return this.privDialogIsDisposed}dispose(e){this.privDialogIsDisposed=!0,this.privConnectionConfigPromise&&this.privConnectionConfigPromise.onSuccessContinueWith(t=>{t.dispose(e)})}privDisconnect(){this.cancelRecognition(this.privDialogRequestSession.sessionId,this.privDialogRequestSession.requestId,Z.Error,_e.NoError,"Disconnecting",void 0),this.terminateMessageLoop=!0,this.agentConfigSent=!1,this.privDialogConnectionPromise.result().isCompleted?this.privDialogConnectionPromise.result().isError||(this.privDialogConnectionPromise.result().result.dispose(),this.privDialogConnectionPromise=null):this.privDialogConnectionPromise.onSuccessContinueWith(e=>{e.dispose()})}processTypeSpecificMessages(e,t,r){const n=new Ce;let i;switch(e.messageType===xe.b.Text&&n.setProperty(Re.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.phrase":const t=ct.fromJSON(e.textBody);if(this.privDialogRequestSession.onPhraseRecognized(this.privDialogRequestSession.currentTurnAudioOffset+t.Offset+t.Duration),t.RecognitionStatus===st.Success){const e=this.fireEventForResult(t,n);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,e)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(e.result)}catch(e){r&&r(e)}this.privSuccessCallback=void 0,r=void 0}}break;case"speech.hypothesis":const o=it.fromJSON(e.textBody),s=o.Offset+this.privDialogRequestSession.currentTurnAudioOffset;i=new ce(this.privDialogRequestSession.requestId,te.RecognizingSpeech,o.Text,o.Duration,s,void 0,e.textBody,n),this.privDialogRequestSession.onHypothesis(s);const c=new he(i,o.Duration,this.privDialogRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,c)}catch(e){}break;case"audio":{const t=e.requestId.toUpperCase(),r=this.privTurnStateManager.GetTurn(t);try{e.binaryBody?r.audioStream.write(e.binaryBody):r.endAudioStream()}catch(e){}}break;case"response":{const t=e.requestId.toUpperCase(),r=er.fromJSON(e.textBody),n=this.privTurnStateManager.GetTurn(t);if(r.conversationId){const e=this.agentConfig.get();e.botInfo.conversationId=r.conversationId,this.agentConfig.set(e)}const i=n.processActivityPayload(r),o=new Zt(r.messagePayload,i);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,o)}catch(e){}}}}cancelRecognition(e,t,r,n,i,o){if(this.terminateMessageLoop=!0,this.privDialogRequestSession.isRecognizing&&this.privDialogRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const t=new Ce;t.setProperty(me,_e[n]);const s=new le(r,i,n,void 0,e);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,s)}catch(e){}if(o){const e=new ce(void 0,te.Canceled,void 0,void 0,void 0,i,void 0,t);try{o(e)}catch(e){}}}}dialogConnectImpl(e=!1){if(this.privDialogConnectionPromise){if(!this.privDialogConnectionPromise.result().isCompleted||!this.privDialogConnectionPromise.result().isError&&this.privDialogConnectionPromise.result().result.state()!==Me.a.Disconnected)return this.privDialogConnectionPromise;this.agentConfigSent=!1,this.privDialogConnectionPromise=null}this.privDialogAuthFetchEventId=Object(_.b)(),void 0===this.privConnectionId&&(this.privConnectionId=Object(_.b)()),this.privDialogRequestSession.onPreConnectionStart(this.privDialogAuthFetchEventId,this.privConnectionId);const t=e?this.privDialogAuthentication.fetchOnExpiry(this.privDialogAuthFetchEventId):this.privDialogAuthentication.fetch(this.privDialogAuthFetchEventId);return this.privDialogConnectionPromise=t.continueWithPromise(t=>{if(t.isError)throw this.privDialogRequestSession.onAuthCompleted(!0,t.error),new Error(t.error);this.privDialogRequestSession.onAuthCompleted(!1);const r=this.privDialogConnectionFactory.create(this.privRecognizerConfig,t.result,this.privConnectionId);return this.privDialogRequestSession.listenForServiceTelemetry(r.events),r.events.attach(e=>{this.connectionEvents.onEvent(e)}),r.open().onSuccessContinueWithPromise(t=>200===t.statusCode?(this.privDialogRequestSession.onPreConnectionStart(this.privDialogAuthFetchEventId,this.privConnectionId),this.privDialogRequestSession.onConnectionEstablishCompleted(t.statusCode),m.b.fromResult(r)):403!==t.statusCode||e?(this.privDialogRequestSession.onConnectionEstablishCompleted(t.statusCode,t.reason),m.b.fromError(`Unable to contact server. StatusCode: ${t.statusCode}, ${this.privRecognizerConfig.parameters.getProperty(Re.SpeechServiceConnection_Endpoint)} Reason: ${t.reason}`)):this.dialogConnectImpl(!0))}),this.privConnectionLoop=this.startMessageLoop(),this.privDialogConnectionPromise}startMessageLoop(){return this.terminateMessageLoop=!1,this.receiveDialogMessageOverride().on(e=>!0,e=>{this.cancelRecognition(this.privDialogRequestSession.sessionId,this.privDialogRequestSession.requestId,Z.Error,_e.RuntimeError,e,this.privSuccessCallback)})}configConnection(){return this.privConnectionConfigPromise?this.privConnectionConfigPromise.result().isCompleted&&(this.privConnectionConfigPromise.result().isError||this.privConnectionConfigPromise.result().result.state()===Me.a.Disconnected)?(this.privConnectionConfigPromise=null,this.configConnection()):this.privConnectionConfigPromise:(this.privConnectionConfigPromise=this.dialogConnectImpl().onSuccessContinueWithPromise(e=>this.sendSpeechServiceConfig(e,this.privDialogRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()).onSuccessContinueWithPromise(t=>this.sendAgentConfig(e).onSuccessContinueWith(t=>e))),this.privConnectionConfigPromise)}sendPreAudioMessages(){this.fetchDialogConnection().onSuccessContinueWith(e=>{this.sendAgentContext(e)})}fireEventForResult(e,t){const r=at.implTranslateRecognitionResult(e.RecognitionStatus),n=e.Offset+this.privDialogRequestSession.currentTurnAudioOffset,i=new ce(this.privDialogRequestSession.requestId,r,e.DisplayText,e.Duration,n,void 0,JSON.stringify(e),t);return new he(i,n,this.privDialogRequestSession.sessionId)}}class sr extends nt{constructor(e,t){const r=e;B.throwIfNull(e,"dialogConfig"),super(t,r.properties,new Xt),this.privIsDisposed=!1,this.privProperties=r.properties.clone();const n=this.buildAgentConfig();this.privReco.agentConfig.set(n)}connect(){this.privReco.connect()}disconnect(){this.privReco.disconnect()}get authorizationToken(){return this.properties.getProperty(Re.SpeechServiceAuthorization_Token)}set authorizationToken(e){B.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(Re.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}listenOnceAsync(e,t){try{B.throwIfDisposed(this.privIsDisposed),this.connect(),this.implRecognizerStop(),this.implRecognizerStart(i.Conversation,t=>{this.implRecognizerStop(),e&&e(t)},e=>{this.implRecognizerStop(),t&&t(e)})}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}}sendActivityAsync(e){this.privReco.sendMessage(e)}close(){B.throwIfDisposed(this.privIsDisposed),this.dispose(!0)}dispose(e){this.privIsDisposed||e&&(this.implRecognizerStop(),this.privIsDisposed=!0,super.dispose(e))}createRecognizerConfig(e){return new f(e,this.privProperties)}createServiceRecognizer(e,t,r,n){return new or(e,t,r,n,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),connectionId:this.properties.getProperty(Re.Conversation_ApplicationId),conversationId:void 0},version:.2}}}!function(e){e[e.UriQueryParameter=0]="UriQueryParameter"}(rr||(rr={}));class cr{constructor(e){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,this.init(e)}playAudioSample(e){this.ensureInitializedContext();const t=this.formatAudioData(e),r=new Float32Array(this.samples.length+t.length);r.set(this.samples,0),r.set(t,this.samples.length),this.samples=r}stopAudio(){null!==this.audioContext&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close(),this.audioContext=null)}init(e){this.audioFormat=e,this.samples=new Float32Array}ensureInitializedContext(){if(null===this.audioContext){this.createAudioContext();const e=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},e)}}createAudioContext(){this.audioContext=new AudioContext,this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(e){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(e),128);case 16:return this.formatArrayBuffer(new Int16Array(e),32768);case 32:return this.formatArrayBuffer(new Int32Array(e),2147483648);default:throw new T.b("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(e,t){const r=new Float32Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]/t;return r}updateAudioBuffer(){if(0===this.samples.length)return;const e=this.audioFormat.channels,t=this.audioContext.createBufferSource(),r=this.samples.length/e,n=this.audioContext.createBuffer(e,r,this.audioFormat.samplesPerSec);for(let t=0;t<e;t++){let r=t;const i=n.getChannelData(t);for(let t=0;t<this.samples.length;t++,r+=e)i[t]=this.samples[r]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),t.buffer=n,t.connect(this.gainNode),t.start(this.startTime),this.startTime+=n.duration,this.samples=new Float32Array}}r.d(t,"AudioConfig",(function(){return J})),r.d(t,"AudioStreamFormat",(function(){return h})),r.d(t,"AudioInputStream",(function(){return U})),r.d(t,"PullAudioInputStream",(function(){return H})),r.d(t,"PushAudioInputStream",(function(){return W})),r.d(t,"AudioOutputStream",(function(){return Y})),r.d(t,"PullAudioOutputStream",(function(){return $})),r.d(t,"CancellationReason",(function(){return Z})),r.d(t,"PullAudioInputStreamCallback",(function(){return F})),r.d(t,"KeywordRecognitionModel",(function(){return re})),r.d(t,"SessionEventArgs",(function(){return ne})),r.d(t,"RecognitionEventArgs",(function(){return ie})),r.d(t,"OutputFormat",(function(){return ee})),r.d(t,"IntentRecognitionEventArgs",(function(){return oe})),r.d(t,"RecognitionResult",(function(){return se})),r.d(t,"SpeechRecognitionResult",(function(){return ce})),r.d(t,"IntentRecognitionResult",(function(){return ae})),r.d(t,"LanguageUnderstandingModel",(function(){return ue})),r.d(t,"SpeechRecognitionEventArgs",(function(){return he})),r.d(t,"SpeechRecognitionCanceledEventArgs",(function(){return le})),r.d(t,"TranslationRecognitionEventArgs",(function(){return fe})),r.d(t,"TranslationSynthesisEventArgs",(function(){return ve})),r.d(t,"TranslationRecognitionResult",(function(){return de})),r.d(t,"TranslationSynthesisResult",(function(){return ge})),r.d(t,"ResultReason",(function(){return te})),r.d(t,"SpeechConfig",(function(){return Pe})),r.d(t,"SpeechConfigImpl",(function(){return Ie})),r.d(t,"SpeechTranslationConfig",(function(){return Ee})),r.d(t,"PropertyCollection",(function(){return Ce})),r.d(t,"PropertyId",(function(){return Re})),r.d(t,"Recognizer",(function(){return nt})),r.d(t,"SpeechRecognizer",(function(){return bt})),r.d(t,"IntentRecognizer",(function(){return At})),r.d(t,"TranslationRecognizer",(function(){return Lt})),r.d(t,"Translations",(function(){return Mt})),r.d(t,"NoMatchReason",(function(){return Dt})),r.d(t,"NoMatchDetails",(function(){return Bt})),r.d(t,"TranslationRecognitionCanceledEventArgs",(function(){return xt})),r.d(t,"IntentRecognitionCanceledEventArgs",(function(){return Pt})),r.d(t,"CancellationDetails",(function(){return Ft})),r.d(t,"CancellationErrorCode",(function(){return _e})),r.d(t,"ConnectionEventArgs",(function(){return qt})),r.d(t,"Connection",(function(){return Ut})),r.d(t,"PhraseListGrammar",(function(){return Wt})),r.d(t,"DialogServiceConfig",(function(){return Vt})),r.d(t,"BotFrameworkConfig",(function(){return Gt})),r.d(t,"SpeechCommandsConfig",(function(){return Jt})),r.d(t,"DialogServiceConnector",(function(){return sr})),r.d(t,"ActivityReceivedEventArgs",(function(){return Zt})),r.d(t,"ServicePropertyChannel",(function(){return rr})),r.d(t,"ProfanityOption",(function(){return we})),r.d(t,"BaseAudioPlayer",(function(){return cr})),a.a.instance.attachListener(new class{constructor(e=n.a.Warning){this.onEvent=e=>{if(e.eventType>=this.privLogLevelFilter){const t=this.toString(e);switch(e.eventType){case n.a.Debug:console.debug(t);break;case n.a.Info:console.info(t);break;case n.a.Warning:console.warn(t);break;case n.a.Error:console.error(t);break;default:console.log(t)}}},this.toString=e=>{const t=[`${e.EventTime}`,`${e.Name}`];for(const r in e)if(r&&e.hasOwnProperty(r)&&"eventTime"!==r&&"eventType"!==r&&"eventId"!==r&&"name"!==r&&"constructor"!==r){const n=e[r];let i="<NULL>";null!=n&&(i="number"==typeof n||"string"==typeof n?n.toString():JSON.stringify(n)),t.push(`${r}: ${i}`)}return t.join(" | ")},this.privLogLevelFilter=e}})},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0),i=r(7);class o{constructor(e){this.privEventListeners={},this.privIsDisposed=!1,this.onEvent=e=>{if(this.isDisposed())throw new n.c("EventSource");if(this.metadata)for(const t in this.metadata)t&&e.metadata&&(e.metadata[t]||(e.metadata[t]=this.metadata[t]));for(const t in this.privEventListeners)t&&this.privEventListeners[t]&&this.privEventListeners[t](e)},this.attach=e=>{const t=Object(i.b)();return this.privEventListeners[t]=e,{detach:()=>{delete this.privEventListeners[t]}}},this.attachListener=e=>this.attach(e.onEvent),this.isDisposed=()=>this.privIsDisposed,this.dispose=()=>{this.privEventListeners=null,this.privIsDisposed=!0},this.privMetadata=e}get metadata(){return this.privMetadata}}},function(e,t){},function(e,t){},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t){this.privStatusCode=e,this.privReason=t}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}}},function(e,t,r){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=r(99),i=r(100),o=r(101);function s(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=a.prototype:(null===e&&(e=new a(t)),e.length=t),e}function a(e,t,r){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return u(this,e,t,r)}function u(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);a.TYPED_ARRAY_SUPPORT?(e=t).__proto__=a.prototype:e=l(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!a.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(t,r),i=(e=c(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(a.isBuffer(t)){var r=0|f(t.length);return 0===(e=c(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?c(e,0):l(e,t);if("Buffer"===t.type&&o(t.data))return l(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function p(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(p(t),e=c(e,t<0?0:0|f(t)),!a.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function l(e,t){var r=t.length<0?0:0|f(t.length);e=c(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function v(e,t){if(a.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return U(e).length;default:if(n)return q(e).length;t=(""+t).toLowerCase(),n=!0}}function d(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return _(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return O(this,t,r);case"latin1":case"binary":return T(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function y(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,i);if("number"==typeof t)return t&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,r,n,i){var o,s=1,c=e.length,a=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,c/=2,a/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var p=-1;for(o=r;o<c;o++)if(u(e,o)===u(t,-1===p?0:o-p)){if(-1===p&&(p=o),o-p+1===a)return p*s}else-1!==p&&(o-=o-p),p=-1}else for(r+a>c&&(r=c-a),o=r;o>=0;o--){for(var h=!0,l=0;l<a;l++)if(u(e,o+l)!==u(t,l)){h=!1;break}if(h)return o}return-1}function S(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var c=parseInt(t.substr(2*s,2),16);if(isNaN(c))return s;e[r+s]=c}return s}function b(e,t,r,n){return W(q(t,e.length-r),e,r,n)}function R(e,t,r,n){return W(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function w(e,t,r,n){return R(e,t,r,n)}function C(e,t,r,n){return W(U(t),e,r,n)}function P(e,t,r,n){return W(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function I(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function E(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,c,a,u=e[i],p=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=r)switch(h){case 1:u<128&&(p=u);break;case 2:128==(192&(o=e[i+1]))&&(a=(31&u)<<6|63&o)>127&&(p=a);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(a=(15&u)<<12|(63&o)<<6|63&s)>2047&&(a<55296||a>57343)&&(p=a);break;case 4:o=e[i+1],s=e[i+2],c=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&c)&&(a=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&c)>65535&&a<1114112&&(p=a)}null===p?(p=65533,h=1):p>65535&&(p-=65536,n.push(p>>>10&1023|55296),p=56320|1023&p),n.push(p),i+=h}return function(e){var t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=A));return r}(n)}t.Buffer=a,t.SlowBuffer=function(e){+e!=e&&(e=0);return a.alloc(+e)},t.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),a.poolSize=8192,a._augment=function(e){return e.__proto__=a.prototype,e},a.from=function(e,t,r){return u(null,e,t,r)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(e,t,r){return function(e,t,r,n){return p(t),t<=0?c(e,t):void 0!==r?"string"==typeof n?c(e,t).fill(r,n):c(e,t).fill(r):c(e,t)}(null,e,t,r)},a.allocUnsafe=function(e){return h(null,e)},a.allocUnsafeSlow=function(e){return h(null,e)},a.isBuffer=function(e){return!(null==e||!e._isBuffer)},a.compare=function(e,t){if(!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=a.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(!a.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},a.byteLength=v,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},a.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):d.apply(this,arguments)},a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},a.prototype.compare=function(e,t,r,n,i){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),c=Math.min(o,s),u=this.slice(n,i),p=e.slice(t,r),h=0;h<c;++h)if(u[h]!==p[h]){o=u[h],s=p[h];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return S(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return R(this,e,t,r);case"latin1":case"binary":return w(this,e,t,r);case"base64":return C(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function O(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function T(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function _(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=F(e[o]);return i}function D(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function x(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,n,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function N(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function z(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function j(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function k(e,t,r,n,o){return o||j(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function L(e,t,r,n,o){return o||j(e,0,r,8),i.write(e,t,r,n,52,8),r+8}a.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),a.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=a.prototype;else{var i=t-e;r=new a(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},a.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},a.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},a.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||x(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),i.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),i.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),i.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),i.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},a.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},a.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,255,0),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},a.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},a.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):z(this,e,t,!0),t+4},a.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):z(this,e,t,!1),t+4},a.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);M(this,e,t,r,i-1,-i)}var o=0,s=1,c=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===c&&0!==this[t+o-1]&&(c=1),this[t+o]=(e/s>>0)-c&255;return t+r},a.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);M(this,e,t,r,i-1,-i)}var o=r-1,s=1,c=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===c&&0!==this[t+o+1]&&(c=1),this[t+o]=(e/s>>0)-c&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,127,-128),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},a.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},a.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):z(this,e,t,!0),t+4},a.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):z(this,e,t,!1),t+4},a.prototype.writeFloatLE=function(e,t,r){return k(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return k(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return L(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return L(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!a.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},a.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=a.isBuffer(e)?e:q(new a(e,n).toString()),c=s.length;for(o=0;o<r-t;++o)this[o+t]=s[o%c]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function q(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function U(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}).call(this,r(63))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n=r(109),i=r(110),o=r(111);e.exports=function(e){return n(e)||i(e)||o()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(115),i={AudioConfig:n.AudioConfig,OutputFormat:n.OutputFormat,ResultReason:n.ResultReason,SpeechConfig:n.SpeechConfig,SpeechRecognizer:n.SpeechRecognizer};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(11),o=r(18);!function(e){e[e.Text=0]="Text",e[e.Binary=1]="Binary"}(n=t.MessageType||(t.MessageType={}));var s=function(){function e(e,t,r,s){if(this.privBody=null,e===n.Text&&t&&"string"!=typeof t)throw new i.InvalidOperationError("Payload must be a string");if(e===n.Binary&&t&&!(t instanceof ArrayBuffer))throw new i.InvalidOperationError("Payload must be ArrayBuffer");this.privMessageType=e,this.privBody=t,this.privHeaders=r||{},this.privId=s||o.createNoDashGuid()}return Object.defineProperty(e.prototype,"messageType",{get:function(){return this.privMessageType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headers",{get:function(){return this.privHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this.privBody},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textBody",{get:function(){if(this.privMessageType===n.Binary)throw new i.InvalidOperationError("Not supported for binary message");return this.privBody},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryBody",{get:function(){if(this.privMessageType===n.Text)throw new i.InvalidOperationError("Not supported for text message");return this.privBody},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privId},enumerable:!0,configurable:!0}),e}();t.ConnectionMessage=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),i=r(18),o=function(){function e(e){var t=this;this.privEventListeners={},this.privIsDisposed=!1,this.onEvent=function(e){if(t.isDisposed())throw new n.ObjectDisposedError("EventSource");if(t.metadata)for(var r in t.metadata)r&&e.metadata&&(e.metadata[r]||(e.metadata[r]=t.metadata[r]));for(var i in t.privEventListeners)i&&t.privEventListeners[i]&&t.privEventListeners[i](e)},this.attach=function(e){var r=i.createNoDashGuid();return t.privEventListeners[r]=e,{detach:function(){delete t.privEventListeners[r]}}},this.attachListener=function(e){return t.attach(e.onEvent)},this.isDisposed=function(){return t.privIsDisposed},this.dispose=function(){t.privEventListeners=null,t.privIsDisposed=!0},this.privMetadata=e}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.privMetadata},enumerable:!0,configurable:!0}),e}();t.EventSource=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),i=function e(t){var r=this;if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.get=function(e){return r.throwIfDisposed(),r.privList[e]},this.first=function(){return r.get(0)},this.last=function(){return r.get(r.length()-1)},this.add=function(e){r.throwIfDisposed(),r.insertAt(r.privList.length,e)},this.insertAt=function(e,t){r.throwIfDisposed(),0===e?r.privList.unshift(t):e===r.privList.length?r.privList.push(t):r.privList.splice(e,0,t),r.triggerSubscriptions(r.privAddSubscriptions)},this.removeFirst=function(){return r.throwIfDisposed(),r.removeAt(0)},this.removeLast=function(){return r.throwIfDisposed(),r.removeAt(r.length()-1)},this.removeAt=function(e){return r.throwIfDisposed(),r.remove(e,1)[0]},this.remove=function(e,t){r.throwIfDisposed();var n=r.privList.splice(e,t);return r.triggerSubscriptions(r.privRemoveSubscriptions),n},this.clear=function(){r.throwIfDisposed(),r.remove(0,r.length())},this.length=function(){return r.throwIfDisposed(),r.privList.length},this.onAdded=function(e){r.throwIfDisposed();var t=r.privSubscriptionIdCounter++;return r.privAddSubscriptions[t]=e,{detach:function(){delete r.privAddSubscriptions[t]}}},this.onRemoved=function(e){r.throwIfDisposed();var t=r.privSubscriptionIdCounter++;return r.privRemoveSubscriptions[t]=e,{detach:function(){delete r.privRemoveSubscriptions[t]}}},this.onDisposed=function(e){r.throwIfDisposed();var t=r.privSubscriptionIdCounter++;return r.privDisposedSubscriptions[t]=e,{detach:function(){delete r.privDisposedSubscriptions[t]}}},this.join=function(e){return r.throwIfDisposed(),r.privList.join(e)},this.toArray=function(){var e=Array();return r.privList.forEach((function(t){e.push(t)})),e},this.any=function(e){return r.throwIfDisposed(),e?r.where(e).length()>0:r.length()>0},this.all=function(e){return r.throwIfDisposed(),r.where(e).length()===r.length()},this.forEach=function(e){r.throwIfDisposed();for(var t=0;t<r.length();t++)e(r.privList[t],t)},this.select=function(t){r.throwIfDisposed();for(var n=[],i=0;i<r.privList.length;i++)n.push(t(r.privList[i],i));return new e(n)},this.where=function(t){r.throwIfDisposed();for(var n=new e,i=0;i<r.privList.length;i++)t(r.privList[i],i)&&n.add(r.privList[i]);return n},this.orderBy=function(t){return r.throwIfDisposed(),new e(r.toArray().sort(t))},this.orderByDesc=function(e){return r.throwIfDisposed(),r.orderBy((function(t,r){return e(r,t)}))},this.clone=function(){return r.throwIfDisposed(),new e(r.toArray())},this.concat=function(t){return r.throwIfDisposed(),new e(r.privList.concat(t.toArray()))},this.concatArray=function(t){return r.throwIfDisposed(),new e(r.privList.concat(t))},this.isDisposed=function(){return null==r.privList},this.dispose=function(e){r.isDisposed()||(r.privDisposeReason=e,r.privList=null,r.privAddSubscriptions=null,r.privRemoveSubscriptions=null,r.triggerSubscriptions(r.privDisposedSubscriptions))},this.throwIfDisposed=function(){if(r.isDisposed())throw new n.ObjectDisposedError("List",r.privDisposeReason)},this.triggerSubscriptions=function(e){if(e)for(var t in e)t&&e[t]()},this.privList=[],t)for(var i=0,o=t;i<o.length;i++){var s=o[i];this.privList.push(s)}};t.List=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(11);!function(e){e[e.None=0]="None",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(n=t.PromiseState||(t.PromiseState={}));var o=function(){function e(e){var t=this;this.throwIfError=function(){if(t.isError)throw t.error},e.on((function(e){t.privIsCompleted||(t.privIsCompleted=!0,t.privIsError=!1,t.privResult=e)}),(function(e){t.privIsCompleted||(t.privIsCompleted=!0,t.privIsError=!0,t.privError=e)}))}return Object.defineProperty(e.prototype,"isCompleted",{get:function(){return this.privIsCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isError",{get:function(){return this.privIsError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this.privError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),e}();t.PromiseResult=o;var s=function(){var e=this;this.setResult=function(t){e.privOnSetResult(t)},this.setError=function(t){e.privOnSetError(t)},this.on=function(t,r){e.privOnSetResult=t,e.privOnSetError=r}};t.PromiseResultEventSource=s;var c=function(){function e(){}return e.whenAll=function(e){if(!e||0===e.length)throw new i.ArgumentNullError("promises");for(var t=new u,r=[],n=0,o=function(){++n===e.length&&(0===r.length?t.resolve(!0):t.reject(r.join(", ")))},s=0,c=e;s<c.length;s++){c[s].on((function(e){o()}),(function(e){r.push(e),o()}))}return t.promise()},e.fromResult=function(e){var t=new u;return t.resolve(e),t.promise()},e.fromError=function(e){var t=new u;return t.reject(e),t.promise()},e}();t.PromiseHelper=c;var a=function(e){var t=this;this.result=function(){return t.privSink.result},this.continueWith=function(e){if(!e)throw new i.ArgumentNullError("continuationCallback");var r=new u;return t.privSink.on((function(n){try{var i=e(t.privSink.result);r.resolve(i)}catch(e){r.reject(e)}}),(function(n){try{var i=e(t.privSink.result);r.resolve(i)}catch(e){r.reject("'Error handler for error "+n+" threw error "+e+"'")}})),r.promise()},this.onSuccessContinueWith=function(e){if(!e)throw new i.ArgumentNullError("continuationCallback");var r=new u;return t.privSink.on((function(t){try{var n=e(t);r.resolve(n)}catch(e){r.reject(e)}}),(function(e){r.reject(e)})),r.promise()},this.continueWithPromise=function(e){if(!e)throw new i.ArgumentNullError("continuationCallback");var r=new u;return t.privSink.on((function(n){try{var i=e(t.privSink.result);if(!i)throw new Error("'Continuation callback did not return promise'");i.on((function(e){r.resolve(e)}),(function(e){r.reject(e)}))}catch(e){r.reject(e)}}),(function(n){try{var i=e(t.privSink.result);if(!i)throw new Error("Continuation callback did not return promise");i.on((function(e){r.resolve(e)}),(function(e){r.reject(e)}))}catch(e){r.reject("'Error handler for error "+n+" threw error "+e+"'")}})),r.promise()},this.onSuccessContinueWithPromise=function(e){if(!e)throw new i.ArgumentNullError("continuationCallback");var r=new u;return t.privSink.on((function(t){try{var n=e(t);if(!n)throw new Error("Continuation callback did not return promise");n.on((function(e){r.resolve(e)}),(function(e){r.reject(e)}))}catch(e){r.reject(e)}}),(function(e){r.reject(e)})),r.promise()},this.on=function(e,r){if(!e)throw new i.ArgumentNullError("successCallback");if(!r)throw new i.ArgumentNullError("errorCallback");return t.privSink.on(e,r),t},this.finally=function(e){if(!e)throw new i.ArgumentNullError("callback");var r=function(t){e()};return t.on(r,r)},this.privSink=e};t.Promise=a;var u=function(){var e=this;this.state=function(){return e.privSink.state},this.promise=function(){return e.privPromise},this.resolve=function(t){return e.privSink.resolve(t),e},this.reject=function(t){return e.privSink.reject(t),e},this.privSink=new p,this.privPromise=new a(this.privSink)};t.Deferred=u;var p=function(){function e(){var e=this;this.privState=n.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.resolve=function(t){if(e.privState!==n.None)throw new Error("'Cannot resolve a completed promise'");e.privState=n.Resolved,e.privPromiseResultEvents.setResult(t);for(var r=0;r<e.privSuccessHandlers.length;r++)e.executeSuccessCallback(t,e.privSuccessHandlers[r],e.privErrorHandlers[r]);e.detachHandlers()},this.reject=function(t){if(e.privState!==n.None)throw new Error("'Cannot reject a completed promise'");e.privState=n.Rejected,e.privPromiseResultEvents.setError(t);for(var r=0,i=e.privErrorHandlers;r<i.length;r++){var o=i[r];e.executeErrorCallback(t,o)}e.detachHandlers()},this.on=function(t,r){null==t&&(t=function(e){}),e.privState===n.None?(e.privSuccessHandlers.push(t),e.privErrorHandlers.push(r)):(e.privState===n.Resolved?e.executeSuccessCallback(e.privPromiseResult.result,t,r):e.privState===n.Rejected&&e.executeErrorCallback(e.privPromiseResult.error,r),e.detachHandlers())},this.executeSuccessCallback=function(t,r,n){try{r(t)}catch(t){e.executeErrorCallback("'Unhandled callback error: "+t+"'",n)}},this.executeErrorCallback=function(e,t){if(!t)throw new Error("'Unhandled error: "+e+"'");try{t(e)}catch(t){throw new Error("'Unhandled callback error: "+t+". InnerError: "+e+"'")}},this.detachHandlers=function(){e.privErrorHandlers=[],e.privSuccessHandlers=[]},this.privPromiseResultEvents=new s,this.privPromiseResult=new o(this.privPromiseResultEvents)}return Object.defineProperty(e.prototype,"state",{get:function(){return this.privState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"result",{get:function(){return this.privPromiseResult},enumerable:!0,configurable:!0}),e}();t.Sink=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(11),o=r(68),s=r(69);!function(e){e[e.Dequeue=0]="Dequeue",e[e.Peek=1]="Peek"}(n||(n={}));var c=function(e){var t=this;this.privPromiseStore=new o.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.enqueue=function(e){t.throwIfDispose(),t.enqueueFromPromise(s.PromiseHelper.fromResult(e))},this.enqueueFromPromise=function(e){t.throwIfDispose(),t.privPromiseStore.add(e),e.finally((function(){for(;t.privPromiseStore.length()>0&&t.privPromiseStore.first().result().isCompleted;){var e=t.privPromiseStore.removeFirst();e.result().isError||t.privList.add(e.result().result)}}))},this.dequeue=function(){t.throwIfDispose();var e=new s.Deferred;return t.privSubscribers&&(t.privSubscribers.add({deferral:e,type:n.Dequeue}),t.drain()),e.promise()},this.peek=function(){t.throwIfDispose();var e=new s.Deferred;return t.privSubscribers&&(t.privSubscribers.add({deferral:e,type:n.Peek}),t.drain()),e.promise()},this.length=function(){return t.throwIfDispose(),t.privList.length()},this.isDisposed=function(){return null==t.privSubscribers},this.drainAndDispose=function(e,r){if(!t.isDisposed()&&!t.privIsDisposing){t.privDisposeReason=r,t.privIsDisposing=!0;var n=t.privSubscribers;if(n){for(;n.length()>0;)n.removeFirst().deferral.resolve(void 0);t.privSubscribers===n&&(t.privSubscribers=n)}for(var i=0,o=t.privDetachables;i<o.length;i++)o[i].detach();if(t.privPromiseStore.length()>0&&e)return s.PromiseHelper.whenAll(t.privPromiseStore.toArray()).continueWith((function(){return t.privSubscribers=null,t.privList.forEach((function(t,r){e(t)})),t.privList=null,!0}));t.privSubscribers=null,t.privList=null}return s.PromiseHelper.fromResult(!0)},this.dispose=function(e){t.drainAndDispose(null,e)},this.drain=function(){if(!t.privIsDrainInProgress&&!t.privIsDisposing){t.privIsDrainInProgress=!0;var e=t.privSubscribers,r=t.privList;if(e&&r){for(;r.length()>0&&e.length()>0&&!t.privIsDisposing;){var i=e.removeFirst();if(i.type===n.Peek)i.deferral.resolve(r.first());else{var o=r.removeFirst();i.deferral.resolve(o)}}t.privSubscribers===e&&(t.privSubscribers=e),t.privList===r&&(t.privList=r)}t.privIsDrainInProgress=!1}},this.throwIfDispose=function(){if(t.isDisposed()){if(t.privDisposeReason)throw new i.InvalidOperationError(t.privDisposeReason);throw new i.ObjectDisposedError("Queue")}if(t.privIsDisposing)throw new i.InvalidOperationError("Queue disposing")},this.privList=e||new o.List,this.privDetachables=[],this.privSubscribers=new o.List,this.privDetachables.push(this.privList.onAdded(this.drain))};t.Queue=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(18),s=r(2),c=r(4),a=r(1),u=r(31);t.bufferSize=4096;var p=function(){function e(){}return e.createPushStream=function(e){return h.create(e)},e.createPullStream=function(e,t){return f.create(e,t)},e}();t.AudioInputStream=p;var h=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i(r,e),r.create=function(e){return new l(t.bufferSize,e)},r}(p);t.PushAudioInputStream=h;var l=function(e){function t(t,r){var n=e.call(this)||this;return n.onEvent=function(e){n.privEvents.onEvent(e),c.Events.instance.onEvent(e)},n.privFormat=void 0===r?u.AudioStreamFormatImpl.getDefaultInputFormat():r,n.privEvents=new c.EventSource,n.privId=o.createNoDashGuid(),n.privStream=new c.ChunkedArrayBufferStream(t),n}return i(t,e),Object.defineProperty(t.prototype,"format",{get:function(){return this.privFormat},enumerable:!0,configurable:!0}),t.prototype.write=function(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})},t.prototype.close=function(){this.privStream.close()},t.prototype.id=function(){return this.privId},t.prototype.turnOn=function(){return this.onEvent(new c.AudioSourceInitializingEvent(this.privId)),this.onEvent(new c.AudioSourceReadyEvent(this.privId)),c.PromiseHelper.fromResult(!0)},t.prototype.attach=function(e){var t=this;return this.onEvent(new c.AudioStreamNodeAttachingEvent(this.privId,e)),this.turnOn().onSuccessContinueWith((function(e){return t.privStream.getReader()})).onSuccessContinueWith((function(r){return t.onEvent(new c.AudioStreamNodeAttachedEvent(t.privId,e)),{detach:function(){r.close(),t.onEvent(new c.AudioStreamNodeDetachedEvent(t.privId,e)),t.turnOff()},id:function(){return e},read:function(){return r.read()}}}))},t.prototype.detach=function(e){this.onEvent(new c.AudioStreamNodeDetachedEvent(this.privId,e))},t.prototype.turnOff=function(){return c.PromiseHelper.fromResult(!1)},Object.defineProperty(t.prototype,"events",{get:function(){return this.privEvents},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deviceInfo",{get:function(){return c.PromiseHelper.fromResult({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:s.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:s.type.Stream})},enumerable:!0,configurable:!0}),t}(h);t.PushAudioInputStreamImpl=l;var f=function(e){function t(){return e.call(this)||this}return i(t,e),t.create=function(e,t){return new v(e,t)},t}(p);t.PullAudioInputStream=f;var v=function(e){function r(t,r){var n=e.call(this)||this;return n.onEvent=function(e){n.privEvents.onEvent(e),c.Events.instance.onEvent(e)},n.privFormat=void 0===r?a.AudioStreamFormat.getDefaultInputFormat():r,n.privEvents=new c.EventSource,n.privId=o.createNoDashGuid(),n.privCallback=t,n.privIsClosed=!1,n}return i(r,e),Object.defineProperty(r.prototype,"format",{get:function(){return this.privFormat},enumerable:!0,configurable:!0}),r.prototype.close=function(){this.privIsClosed=!0,this.privCallback.close()},r.prototype.id=function(){return this.privId},r.prototype.turnOn=function(){return this.onEvent(new c.AudioSourceInitializingEvent(this.privId)),this.onEvent(new c.AudioSourceReadyEvent(this.privId)),c.PromiseHelper.fromResult(!0)},r.prototype.attach=function(e){var r=this;return this.onEvent(new c.AudioStreamNodeAttachingEvent(this.privId,e)),this.turnOn().onSuccessContinueWith((function(n){return r.onEvent(new c.AudioStreamNodeAttachedEvent(r.privId,e)),{detach:function(){r.privCallback.close(),r.onEvent(new c.AudioStreamNodeDetachedEvent(r.privId,e)),r.turnOff()},id:function(){return e},read:function(){for(var e,n=0;n<t.bufferSize;){var i=new ArrayBuffer(t.bufferSize-n),o=r.privCallback.read(i);if(void 0===e)e=i;else new Int8Array(e).set(new Int8Array(i),n);if(0===o)break;n+=o}return c.PromiseHelper.fromResult({buffer:e.slice(0,n),isEnd:r.privIsClosed||0===n,timeReceived:Date.now()})}}}))},r.prototype.detach=function(e){this.onEvent(new c.AudioStreamNodeDetachedEvent(this.privId,e))},r.prototype.turnOff=function(){return c.PromiseHelper.fromResult(!1)},Object.defineProperty(r.prototype,"events",{get:function(){return this.privEvents},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"deviceInfo",{get:function(){return c.PromiseHelper.fromResult({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:s.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:s.type.Stream})},enumerable:!0,configurable:!0}),r}(f);t.PullAudioInputStreamImpl=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22),i=r(2),o=r(1),s=r(2),c=r(155),a=function(){var e=this;this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.create=function(t,r,a){var u=t.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Endpoint,void 0),p={},h=t.parameters.getProperty(o.PropertyId.SpeechServiceConnection_EndpointId,void 0),l=t.parameters.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(h?u&&-1!==u.search(c.QueryParameterNames.DeploymentIdParamName)||(p[c.QueryParameterNames.DeploymentIdParamName]=h):l&&(u&&-1!==u.search(c.QueryParameterNames.LanguageParamName)||(p[c.QueryParameterNames.LanguageParamName]=l)),u&&-1!==u.search(c.QueryParameterNames.FormatParamName)||(p[c.QueryParameterNames.FormatParamName]=t.parameters.getProperty(i.OutputFormatPropertyName,o.OutputFormat[o.OutputFormat.Simple]).toLowerCase()),!u){var f="wss://"+t.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Region,void 0)+".stt.speech.microsoft.com";switch(t.recognitionMode){case s.RecognitionMode.Conversation:u=f+e.conversationRelativeUri;break;case s.RecognitionMode.Dictation:u=f+e.dictationRelativeUri;break;default:u=f+e.interactiveRelativeUri}}var v={};return v[r.headerName]=r.token,v[c.QueryParameterNames.ConnectionIdHeader]=a,new n.WebsocketConnection(u,p,v,new s.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(t),a)}};t.SpeechConnectionFactory=a},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(194),o=r(195),s=r(196),c=function(){function t(r,c,a,u){var p=this;if(this.open=function(){if(p.privConnectionState===n.ConnectionState.Disconnected)return n.PromiseHelper.fromError("Cannot open a connection that is in "+p.privConnectionState+" state");if(p.privConnectionEstablishDeferral)return p.privConnectionEstablishDeferral.promise();p.privConnectionEstablishDeferral=new n.Deferred,p.privCertificateValidatedDeferral=new n.Deferred,p.privConnectionState=n.ConnectionState.Connecting;try{if("undefined"==typeof WebSocket||t.forceNpmWebSocket)if(void 0!==p.proxyInfo&&void 0!==p.proxyInfo.HostName&&p.proxyInfo.Port>0){var r={host:p.proxyInfo.HostName,port:p.proxyInfo.Port};void 0!==p.proxyInfo.UserName&&(r.headers={"Proxy-Authentication":"Basic "+new e(p.proxyInfo.UserName+":"+(void 0===p.proxyInfo.Password)?"":p.proxyInfo.Password).toString("base64"),requestOCSP:"true"});var c={agent:new i(r)};p.privWebsocketClient=new o(p.privUri,c),p.privWebsocketClient.addListener("upgrade",(function(e){var t=e.socket,r=t.getPeerCertificate(!0);t.cork(),s.check({cert:r.raw,httpOptions:c,issuer:r.issuerCertificate.raw},(function(e,r){e?(p.privCertificateValidatedDeferral.reject(e.message),t.destroy(e)):(p.privCertificateValidatedDeferral.resolve(!0),t.uncork())}))}))}else{p.privCertificateValidatedDeferral.resolve(!0);var a={agent:new s.Agent({})};p.privWebsocketClient=new o(p.privUri,a)}else p.privCertificateValidatedDeferral.resolve(!0),p.privWebsocketClient=new WebSocket(p.privUri);p.privWebsocketClient.binaryType="arraybuffer",p.privReceivingMessageQueue=new n.Queue,p.privDisconnectDeferral=new n.Deferred,p.privSendMessageQueue=new n.Queue,p.processSendQueue()}catch(e){return p.privConnectionEstablishDeferral.resolve(new n.ConnectionOpenResponse(500,e)),p.privConnectionEstablishDeferral.promise()}return p.onEvent(new n.ConnectionStartEvent(p.privConnectionId,p.privUri)),p.privWebsocketClient.onopen=function(e){p.privCertificateValidatedDeferral.promise().on((function(){p.privConnectionState=n.ConnectionState.Connected,p.onEvent(new n.ConnectionEstablishedEvent(p.privConnectionId)),p.privConnectionEstablishDeferral.resolve(new n.ConnectionOpenResponse(200,""))}),(function(e){p.privConnectionEstablishDeferral.reject(e)}))},p.privWebsocketClient.onerror=function(e){p.privConnectionState,n.ConnectionState.Connecting},p.privWebsocketClient.onclose=function(e){p.privConnectionState===n.ConnectionState.Connecting?(p.privConnectionState=n.ConnectionState.Disconnected,p.privConnectionEstablishDeferral.resolve(new n.ConnectionOpenResponse(e.code,e.reason))):p.onEvent(new n.ConnectionClosedEvent(p.privConnectionId,e.code,e.reason)),p.onClose(e.code,e.reason)},p.privWebsocketClient.onmessage=function(e){var t=(new Date).toISOString();if(p.privConnectionState===n.ConnectionState.Connected){var r=new n.Deferred;if(p.privReceivingMessageQueue.enqueueFromPromise(r.promise()),e.data instanceof ArrayBuffer){var i=new n.RawWebsocketMessage(n.MessageType.Binary,e.data);p.privMessageFormatter.toConnectionMessage(i).on((function(e){p.onEvent(new n.ConnectionMessageReceivedEvent(p.privConnectionId,t,e)),r.resolve(e)}),(function(e){r.reject("Invalid binary message format. Error: "+e)}))}else{i=new n.RawWebsocketMessage(n.MessageType.Text,e.data);p.privMessageFormatter.toConnectionMessage(i).on((function(e){p.onEvent(new n.ConnectionMessageReceivedEvent(p.privConnectionId,t,e)),r.resolve(e)}),(function(e){r.reject("Invalid text message format. Error: "+e)}))}}},p.privConnectionEstablishDeferral.promise()},this.send=function(e){if(p.privConnectionState!==n.ConnectionState.Connected)return n.PromiseHelper.fromError("Cannot send on connection that is in "+p.privConnectionState+" state");var t=new n.Deferred,r=new n.Deferred;return p.privSendMessageQueue.enqueueFromPromise(r.promise()),p.privMessageFormatter.fromConnectionMessage(e).on((function(n){r.resolve({Message:e,RawWebsocketMessage:n,sendStatusDeferral:t})}),(function(e){r.reject("Error formatting the message. "+e)})),t.promise()},this.read=function(){return p.privConnectionState!==n.ConnectionState.Connected?n.PromiseHelper.fromError("Cannot read on connection that is in "+p.privConnectionState+" state"):p.privReceivingMessageQueue.dequeue()},this.close=function(e){if(!p.privWebsocketClient){var t=new n.Deferred;return t.resolve(!0),t.promise()}return p.privConnectionState!==n.ConnectionState.Disconnected&&p.privWebsocketClient.close(1e3,e||"Normal closure by client"),p.privDisconnectDeferral.promise()},this.sendRawMessage=function(e){try{return e?(p.onEvent(new n.ConnectionMessageSentEvent(p.privConnectionId,(new Date).toISOString(),e.Message)),p.privWebsocketClient.send(e.RawWebsocketMessage.payload),n.PromiseHelper.fromResult(!0)):n.PromiseHelper.fromResult(!0)}catch(e){return n.PromiseHelper.fromError("websocket send error: "+e)}},this.onClose=function(e,t){var r="Connection closed. "+e+": "+t;p.privConnectionState=n.ConnectionState.Disconnected,p.privDisconnectDeferral.resolve(!0),p.privReceivingMessageQueue.dispose(t),p.privReceivingMessageQueue.drainAndDispose((function(e){}),r),p.privSendMessageQueue.drainAndDispose((function(e){e.sendStatusDeferral.reject(r)}),r)},this.processSendQueue=function(){p.privSendMessageQueue.dequeue().on((function(e){e&&p.sendRawMessage(e).on((function(t){e.sendStatusDeferral.resolve(t),p.processSendQueue()}),(function(t){e.sendStatusDeferral.reject(t),p.processSendQueue()}))}),(function(e){}))},this.onEvent=function(e){p.privConnectionEvents.onEvent(e),n.Events.instance.onEvent(e)},!r)throw new n.ArgumentNullError("uri");if(!a)throw new n.ArgumentNullError("messageFormatter");this.proxyInfo=u,this.privConnectionEvents=new n.EventSource,this.privConnectionId=c,this.privMessageFormatter=a,this.privConnectionState=n.ConnectionState.None,this.privUri=r}return Object.defineProperty(t.prototype,"state",{get:function(){return this.privConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return this.privConnectionEvents},enumerable:!0,configurable:!0}),t.forceNpmWebSocket=!1,t}();t.WebsocketMessageAdapter=c}).call(this,r(62).Buffer)},function(e,t,r){"use strict";e.exports=()=>{const e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}},function(e,t,r){"use strict";var n=r(6)(r(39));Object.defineProperty(t,"__esModule",{value:!0});var i=new WeakMap,o=new WeakMap;function s(e){var t=i.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function c(e){null==e.passiveListener?e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener)}function a(e,t){i.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});for(var r=Object.keys(t),n=0;n<r.length;++n){var o=r[n];o in this||Object.defineProperty(this,o,u(o))}}function u(e){return{get:function(){return s(this).event[e]},set:function(t){s(this).event[e]=t},configurable:!0,enumerable:!0}}function p(e){return{value:function(){var t=s(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function h(e){if(null==e||e===Object.prototype)return a;var t=o.get(e);return null==t&&(t=function(e,t){var r=Object.keys(t);if(0===r.length)return e;function n(t,r){e.call(this,t,r)}n.prototype=Object.create(e.prototype,{constructor:{value:n,configurable:!0,writable:!0}});for(var i=0;i<r.length;++i){var o=r[i];if(!(o in e.prototype)){var s="function"==typeof Object.getOwnPropertyDescriptor(t,o).value;Object.defineProperty(n.prototype,o,s?p(o):u(o))}}return n}(h(Object.getPrototypeOf(e)),e),o.set(e,t)),t}function l(e){return s(e).immediateStopped}function f(e,t){s(e).passiveListener=t}a.prototype={get type(){return s(this).event.type},get target(){return s(this).eventTarget},get currentTarget(){return s(this).currentTarget},composedPath:function(){var e=s(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return s(this).eventPhase},stopPropagation:function(){var e=s(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation:function(){var e=s(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(s(this).event.bubbles)},get cancelable(){return Boolean(s(this).event.cancelable)},preventDefault:function(){c(s(this))},get defaultPrevented(){return s(this).canceled},get composed(){return Boolean(s(this).event.composed)},get timeStamp(){return s(this).timeStamp},get srcElement(){return s(this).eventTarget},get cancelBubble(){return s(this).stopped},set cancelBubble(e){if(e){var t=s(this);t.stopped=!0,"boolean"==typeof t.event.cancelBubble&&(t.event.cancelBubble=!0)}},get returnValue(){return!s(this).canceled},set returnValue(e){e||c(s(this))},initEvent:function(){}},Object.defineProperty(a.prototype,"constructor",{value:a,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(a.prototype,window.Event.prototype),o.set(window.Event.prototype,a));var v=new WeakMap,d=3;function g(e){return null!==e&&"object"===(0,n.default)(e)}function y(e){var t=v.get(e);if(null==t)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function m(e,t){Object.defineProperty(e,"on".concat(t),function(e){return{get:function(){for(var t=y(this).get(e);null!=t;){if(t.listenerType===d)return t.listener;t=t.next}return null},set:function(t){"function"==typeof t||g(t)||(t=null);for(var r=y(this),n=null,i=r.get(e);null!=i;)i.listenerType===d?null!==n?n.next=i.next:null!==i.next?r.set(e,i.next):r.delete(e):n=i,i=i.next;if(null!==t){var o={listener:t,listenerType:d,passive:!1,once:!1,next:null};null===n?r.set(e,o):n.next=o}},configurable:!0,enumerable:!0}}(t))}function S(e){function t(){b.call(this)}t.prototype=Object.create(b.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(var r=0;r<e.length;++r)m(t.prototype,e[r]);return t}function b(){if(!(this instanceof b)){if(1===arguments.length&&Array.isArray(arguments[0]))return S(arguments[0]);if(arguments.length>0){for(var e=new Array(arguments.length),t=0;t<arguments.length;++t)e[t]=arguments[t];return S(e)}throw new TypeError("Cannot call a class as a function")}v.set(this,new Map)}b.prototype={addEventListener:function(e,t,r){if(null!=t){if("function"!=typeof t&&!g(t))throw new TypeError("'listener' should be a function or an object.");var n=y(this),i=g(r),o=(i?Boolean(r.capture):Boolean(r))?1:2,s={listener:t,listenerType:o,passive:i&&Boolean(r.passive),once:i&&Boolean(r.once),next:null},c=n.get(e);if(void 0!==c){for(var a=null;null!=c;){if(c.listener===t&&c.listenerType===o)return;a=c,c=c.next}a.next=s}else n.set(e,s)}},removeEventListener:function(e,t,r){if(null!=t)for(var n=y(this),i=(g(r)?Boolean(r.capture):Boolean(r))?1:2,o=null,s=n.get(e);null!=s;){if(s.listener===t&&s.listenerType===i)return void(null!==o?o.next=s.next:null!==s.next?n.set(e,s.next):n.delete(e));o=s,s=s.next}},dispatchEvent:function(e){if(null==e||"string"!=typeof e.type)throw new TypeError('"event.type" should be a string.');var t=y(this),r=e.type,n=t.get(r);if(null==n)return!0;for(var i=function(e,t){return new(h(Object.getPrototypeOf(t)))(e,t)}(this,e),o=null;null!=n;){if(n.once?null!==o?o.next=n.next:null!==n.next?t.set(r,n.next):t.delete(r):o=n,f(i,n.passive?n.listener:null),"function"==typeof n.listener)try{n.listener.call(this,i)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else n.listenerType!==d&&"function"==typeof n.listener.handleEvent&&n.listener.handleEvent(i);if(l(i))break;n=n.next}return f(i,null),function(e,t){s(e).eventPhase=t}(i,0),function(e,t){s(e).currentTarget=t}(i,null),!i.defaultPrevented}},Object.defineProperty(b.prototype,"constructor",{value:b,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(b.prototype,window.EventTarget.prototype),t.defineEventAttribute=m,t.EventTarget=b,t.default=b,e.exports=b,e.exports.EventTarget=e.exports.default=b,e.exports.defineEventAttribute=m},function(e,t,r){"use strict";var n=r(37),i=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(r(28)),s=i(r(38)),c=i(r(40)),a=i(r(41)),u=n(r(75)),p=function(e){function t(e){var r;return(0,o.default)(this,t),r=(0,s.default)(this,(0,c.default)(t).call(this)),"string"!=typeof e&&(r.audioStream=e),r}return(0,a.default)(t,e),t}(u.default);t.default=p,(0,u.defineEventAttribute)(p,"boundary"),(0,u.defineEventAttribute)(p,"end"),(0,u.defineEventAttribute)(p,"error"),(0,u.defineEventAttribute)(p,"start")},function(e,t,r){var n=r(8),i=r(78).f,o=r(14),s=r(33),c=r(49),a=r(217),u=r(223);e.exports=function(e,t){var r,p,h,l,f,v=e.target,d=e.global,g=e.stat;if(r=d?n:g?n[v]||c(v,{}):(n[v]||{}).prototype)for(p in t){if(l=t[p],h=e.noTargetGet?(f=i(r,p))&&f.value:r[p],!u(d?p:v+(g?".":"#")+p,e.forced)&&void 0!==h){if(typeof l==typeof h)continue;a(l,h)}(e.sham||h&&h.sham)&&o(l,"sham",!0),s(r,p,l,e)}}},function(e,t,r){var n=r(19),i=r(214),o=r(47),s=r(32),c=r(80),a=r(13),u=r(81),p=Object.getOwnPropertyDescriptor;t.f=n?p:function(e,t){if(e=s(e),t=c(t,!0),u)try{return p(e,t)}catch(e){}if(a(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){var n=r(24);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){var n=r(19),i=r(23),o=r(82);e.exports=!n&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){var n=r(8),i=r(24),o=n.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},function(e,t,r){var n=r(34);e.exports=n("native-function-to-string",Function.toString)},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++r+n).toString(36)}},function(e,t,r){var n=r(13),i=r(32),o=r(220).indexOf,s=r(52);e.exports=function(e,t){var r,c=i(e),a=0,u=[];for(r in c)!n(s,r)&&n(c,r)&&u.push(r);for(;t.length>a;)n(c,r=t[a++])&&(~o(u,r)||u.push(r));return u}},function(e,t,r){var n=r(55),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,r){var n=r(89),i=r(29),o=r(9)("iterator");e.exports=function(e){if(null!=e)return e[o]||e["@@iterator"]||i[n(e)]}},function(e,t,r){var n=r(79),i=r(9)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:o?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,r){"use strict";var n=r(77),i=r(241),o=r(92),s=r(247),c=r(94),a=r(14),u=r(33),p=r(9),h=r(50),l=r(29),f=r(91),v=f.IteratorPrototype,d=f.BUGGY_SAFARI_ITERATORS,g=p("iterator"),y=function(){return this};e.exports=function(e,t,r,p,f,m,S){i(r,t,p);var b,R,w,C=function(e){if(e===f&&O)return O;if(!d&&e in E)return E[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},P=t+" Iterator",I=!1,E=e.prototype,A=E[g]||E["@@iterator"]||f&&E[f],O=!d&&A||C(f),T="Array"==t&&E.entries||A;if(T&&(b=o(T.call(new e)),v!==Object.prototype&&b.next&&(h||o(b)===v||(s?s(b,v):"function"!=typeof b[g]&&a(b,g,y)),c(b,P,!0,!0),h&&(l[P]=y))),"values"==f&&A&&"values"!==A.name&&(I=!0,O=function(){return A.call(this)}),h&&!S||E[g]===O||a(E,g,O),l[t]=O,f)if(R={values:C("values"),keys:m?O:C("keys"),entries:C("entries")},S)for(w in R)!d&&!I&&w in E||u(E,w,R[w]);else n({target:t,proto:!0,forced:d||I},R);return R}},function(e,t,r){"use strict";var n,i,o,s=r(92),c=r(14),a=r(13),u=r(9),p=r(50),h=u("iterator"),l=!1;[].keys&&("next"in(o=[].keys())?(i=s(s(o)))!==Object.prototype&&(n=i):l=!0),null==n&&(n={}),p||a(n,h)||c(n,h,(function(){return this})),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:l}},function(e,t,r){var n=r(13),i=r(242),o=r(51),s=r(243),c=o("IE_PROTO"),a=Object.prototype;e.exports=s?Object.getPrototypeOf:function(e){return e=i(e),n(e,c)?e[c]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,r){var n=r(15),i=r(244),o=r(56),s=r(52),c=r(246),a=r(82),u=r(51)("IE_PROTO"),p=function(){},h=function(){var e,t=a("iframe"),r=o.length;for(t.style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),h=e.F;r--;)delete h.prototype[o[r]];return h()};e.exports=Object.create||function(e,t){var r;return null!==e?(p.prototype=n(e),r=new p,p.prototype=null,r[u]=e):r=h(),void 0===t?r:i(r,t)},s[u]=!0},function(e,t,r){var n=r(20).f,i=r(13),o=r(9)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return g}));var n=r(10),i=r(5),o=r(36),s=r(61),c=r(25),a=r(97),u=r(21),p=r(255),h=r(0),l=r(58),f=r(96),v=r(59),d=r(60);class g{constructor(t,r,y,m,S){if(this.open=()=>{if(this.privConnectionState===n.a.Disconnected)return i.b.fromError(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise();this.privConnectionEstablishDeferral=new i.a,this.privCertificateValidatedDeferral=new i.a,this.privConnectionState=n.a.Connecting;try{if("undefined"==typeof WebSocket||g.forceNpmWebSocket)if(void 0!==this.proxyInfo&&void 0!==this.proxyInfo.HostName&&this.proxyInfo.Port>0){const t={host:this.proxyInfo.HostName,port:this.proxyInfo.Port};void 0!==this.proxyInfo.UserName&&(t.headers={"Proxy-Authentication":"Basic "+new e(this.proxyInfo.UserName+":"+(void 0===this.proxyInfo.Password)?"":this.proxyInfo.Password).toString("base64"),requestOCSP:"true"});const r={agent:new f(t),headers:this.privHeaders};this.privWebsocketClient=new v(this.privUri,r),this.privWebsocketClient.addListener("upgrade",e=>{const t=e.socket,n=t.getPeerCertificate(!0);t.cork(),d.check({cert:n.raw,httpOptions:r,issuer:n.issuerCertificate.raw},(e,r)=>{e?(this.privCertificateValidatedDeferral.reject(e.message),t.destroy(e)):(this.privCertificateValidatedDeferral.resolve(!0),t.uncork())})})}else{this.privCertificateValidatedDeferral.resolve(!0);const e={agent:new d.Agent({}),headers:this.privHeaders};this.privWebsocketClient=new v(this.privUri,e)}else this.privCertificateValidatedDeferral.resolve(!0),this.privWebsocketClient=new WebSocket(this.privUri);this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new o.a,this.privDisconnectDeferral=new i.a,this.privSendMessageQueue=new o.a,this.processSendQueue()}catch(e){return this.privConnectionEstablishDeferral.resolve(new s.a(500,e)),this.privConnectionEstablishDeferral.promise()}return this.onEvent(new c.f(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=e=>{this.privCertificateValidatedDeferral.promise().on(()=>{this.privConnectionState=n.a.Connected,this.onEvent(new c.c(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new s.a(200,""))},e=>{this.privConnectionEstablishDeferral.reject(e)})},this.privWebsocketClient.onerror=e=>{this.privConnectionState,n.a.Connecting},this.privWebsocketClient.onclose=e=>{this.privConnectionState===n.a.Connecting?(this.privConnectionState=n.a.Disconnected,this.privConnectionEstablishDeferral.resolve(new s.a(e.code,e.reason))):this.onEvent(new c.a(this.privConnectionId,e.code,e.reason)),this.onClose(e.code,e.reason)},this.privWebsocketClient.onmessage=e=>{const t=(new Date).toISOString();if(this.privConnectionState===n.a.Connected){const r=new i.a;if(this.privReceivingMessageQueue.enqueueFromPromise(r.promise()),e.data instanceof ArrayBuffer){const n=new a.a(u.b.Binary,e.data);this.privMessageFormatter.toConnectionMessage(n).on(e=>{this.onEvent(new c.d(this.privConnectionId,t,e)),r.resolve(e)},e=>{r.reject(`Invalid binary message format. Error: ${e}`)})}else{const n=new a.a(u.b.Text,e.data);this.privMessageFormatter.toConnectionMessage(n).on(e=>{this.onEvent(new c.d(this.privConnectionId,t,e)),r.resolve(e)},e=>{r.reject(`Invalid text message format. Error: ${e}`)})}}},this.privConnectionEstablishDeferral.promise()},this.send=e=>{if(this.privConnectionState!==n.a.Connected)return i.b.fromError(`Cannot send on connection that is in ${this.privConnectionState} state`);const t=new i.a,r=new i.a;return this.privSendMessageQueue.enqueueFromPromise(r.promise()),this.privMessageFormatter.fromConnectionMessage(e).on(n=>{r.resolve({Message:e,RawWebsocketMessage:n,sendStatusDeferral:t})},e=>{r.reject(`Error formatting the message. ${e}`)}),t.promise()},this.read=()=>this.privConnectionState!==n.a.Connected?i.b.fromError(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue(),this.close=e=>{if(!this.privWebsocketClient){const e=new i.a;return e.resolve(!0),e.promise()}return this.privConnectionState!==n.a.Disconnected&&this.privWebsocketClient.close(1e3,e||"Normal closure by client"),this.privDisconnectDeferral.promise()},this.sendRawMessage=e=>{try{return e?(this.onEvent(new c.e(this.privConnectionId,(new Date).toISOString(),e.Message)),this.privWebsocketClient.send(e.RawWebsocketMessage.payload),i.b.fromResult(!0)):i.b.fromResult(!0)}catch(e){return i.b.fromError(`websocket send error: ${e}`)}},this.onClose=(e,t)=>{const r=`Connection closed. ${e}: ${t}`;this.privConnectionState=n.a.Disconnected,this.privDisconnectDeferral.resolve(!0),this.privReceivingMessageQueue.dispose(t),this.privReceivingMessageQueue.drainAndDispose(e=>{},r),this.privSendMessageQueue.drainAndDispose(e=>{e.sendStatusDeferral.reject(r)},r)},this.processSendQueue=()=>{this.privSendMessageQueue.dequeue().on(e=>{e&&this.sendRawMessage(e).on(t=>{e.sendStatusDeferral.resolve(t),this.processSendQueue()},t=>{e.sendStatusDeferral.reject(t),this.processSendQueue()})},e=>{})},this.onEvent=e=>{this.privConnectionEvents.onEvent(e),p.a.instance.onEvent(e)},!t)throw new h.a("uri");if(!y)throw new h.a("messageFormatter");this.proxyInfo=m,this.privConnectionEvents=new l.a,this.privConnectionId=r,this.privMessageFormatter=y,this.privConnectionState=n.a.None,this.privUri=t,this.privHeaders=S}get state(){return this.privConnectionState}get events(){return this.privConnectionEvents}}g.forceNpmWebSocket=!1}).call(this,r(62).Buffer)},function(e,t){},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(21),i=r(0),o=r(7);class s{constructor(e,t,r){if(this.privPayload=null,!t)throw new i.a("payload");if(e===n.b.Binary&&!(t instanceof ArrayBuffer))throw new i.b("Payload must be ArrayBuffer");if(e===n.b.Text&&"string"!=typeof t)throw new i.b("Payload must be a string");this.privMessageType=e,this.privPayload=t,this.privId=r||Object(o.b)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===n.b.Binary)throw new i.b("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===n.b.Text)throw new i.b("Not supported for text message");return this.privPayload}get id(){return this.privId}}},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AudioConfig",{enumerable:!0,get:function(){return i.AudioConfig}}),Object.defineProperty(t,"create",{enumerable:!0,get:function(){return o.default}});var i=r(57),o=n(r(102));if("undefined"!=typeof HTMLDocument&&"undefined"!=typeof document&&document instanceof HTMLDocument){var s=document.createElement("meta");s.setAttribute("name","botframework-directline:version"),s.setAttribute("content","0.0.1-0"),document.head.appendChild(s)}},function(e,t,r){"use strict";t.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n=u(e),s=n[0],c=n[1],a=new o(function(e,t,r){return 3*(t+r)/4-r}(0,s,c)),p=0,h=c>0?s-4:s;for(r=0;r<h;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],a[p++]=t>>16&255,a[p++]=t>>8&255,a[p++]=255&t;2===c&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,a[p++]=255&t);1===c&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,a[p++]=t>>8&255,a[p++]=255&t);return a},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=0,c=r-i;s<c;s+=16383)o.push(p(e,s,s+16383>c?c:s+16383));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,a=s.length;c<a;++c)n[c]=s[c],i[s.charCodeAt(c)]=c;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function p(e,t,r){for(var i,o,s=[],c=t;c<r;c+=3)i=(e[c]<<16&16711680)+(e[c+1]<<8&65280)+(255&e[c+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,i){var o,s,c=8*i-n-1,a=(1<<c)-1,u=a>>1,p=-7,h=r?i-1:0,l=r?-1:1,f=e[t+h];for(h+=l,o=f&(1<<-p)-1,f>>=-p,p+=c;p>0;o=256*o+e[t+h],h+=l,p-=8);for(s=o&(1<<-p)-1,o>>=-p,p+=n;p>0;s=256*s+e[t+h],h+=l,p-=8);if(0===o)o=1-u;else{if(o===a)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=u}return(f?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,c,a,u=8*o-i-1,p=(1<<u)-1,h=p>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,v=n?1:-1,d=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,s=p):(s=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-s))<1&&(s--,a*=2),(t+=s+h>=1?l/a:l*Math.pow(2,1-h))*a>=2&&(s++,a/=2),s+h>=p?(c=0,s=p):s+h>=1?(c=(t*a-1)*Math.pow(2,i),s+=h):(c=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&c,f+=v,c/=256,i-=8);for(s=s<<i|c,u+=i;u>0;e[r+f]=255&s,f+=v,s/=256,u-=8);e[r+f-v]|=128*d}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r=e.audioConfig,n=e.audioContext,a=e.lang,u=void 0===a?"en-US":a,p=e.speechServicesAuthorizationToken,h=e.speechServicesRegion,l=e.speechServicesSubscriptionKey,f=e.userID,v=e.username;if(!p&&!l||p&&l)throw new Error('You must specify either "speechServicesAuthorizationToken" or "speechServicesSubscriptionKey" only.');if(f||v)throw new Error('Direct Line Speech do not support custom "userId" and "username".');t=p?i.BotFrameworkConfig.fromAuthorizationToken(p,h):i.BotFrameworkConfig.fromSubscription(l,h);t.setProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage,u),t.outputFormat=i.OutputFormat.Detailed;var d=(0,c.default)(new i.DialogServiceConnector(t,r));d.connect();var g=new s.default({dialogServiceConnector:d}),y=(0,o.default)({audioConfig:r,audioContext:n,recognizer:d});return{directLine:g,webSpeechPonyfillFactory:y}};var i=r(57),o=n(r(103)),s=n(r(211)),c=n(r(254))},function(e,t,r){"use strict";var n=r(37),i=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.audioConfig,r=void 0===t?l.AudioConfig.fromDefaultMicrophoneInput():t,n=e.enableTelemetry,i=e.recognizer,R=e.textNormalization;return function(){var e=(0,f.createSpeechRecognitionPonyfillFromRecognizer)({audioConfig:r,createRecognizer:function(){return i},enableTelemetry:n,looseEvents:!0,textNormalization:R}),t=e.SpeechGrammarList,l=e.SpeechRecognition,w=new AudioContext,C=(0,g.default)(),P=C.cancelAll,I=C.push,E=function(e){function t(){return(0,c.default)(this,t),(0,u.default)(this,(0,p.default)(t).apply(this,arguments))}return(0,h.default)(t,e),(0,a.default)(t,[{key:"cancel",value:function(){P()}},{key:"getVoices",value:function(){return[]}},{key:"speak",value:function(e){I((function(){var t=new v.default,r=t.abort,n=t.signal;return{abort:r,result:(0,s.default)(o.default.mark((function t(){var r,i,s;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.dispatchEvent(new Event("start")),t.prev=1,!e.audioStream){t.next=8;break}return r=e.audioStream,i=r.format,s=r.streamReader,t.next=6,(0,m.default)(w,i,s,{signal:n});case 6:t.next=10;break;case 8:return t.next=10,(0,S.default)(w);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),e.dispatchEvent((0,d.default)(t.t0));case 15:e.dispatchEvent(new Event("end"));case 16:case"end":return t.stop()}}),t,null,[[1,12]])})))()}}))}}]),t}(y.default);return(0,y.defineEventAttribute)(E,"voiceschanged"),{SpeechGrammarList:t,SpeechRecognition:l,speechSynthesis:new E,SpeechSynthesisUtterance:b.default}}};var o=i(r(26)),s=i(r(27)),c=i(r(28)),a=i(r(30)),u=i(r(38)),p=i(r(40)),h=i(r(41)),l=r(57),f=r(107),v=i(r(202)),d=i(r(203)),g=i(r(204)),y=n(r(75)),m=i(r(205)),S=i(r(207)),b=i(r(76))},function(e,t,r){var n=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function a(e,t,r,n){var i=t&&t.prototype instanceof d?t:d,o=Object.create(i.prototype),s=new A(n||[]);return o._invoke=function(e,t,r){var n=p;return function(i,o){if(n===l)throw new Error("Generator is already running");if(n===f){if("throw"===i)throw o;return T()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var c=P(s,r);if(c){if(c===v)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===p)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=l;var a=u(e,t,r);if("normal"===a.type){if(n=r.done?f:h,a.arg===v)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(n=f,r.method="throw",r.arg=a.arg)}}}(e,r,s),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=a;var p="suspendedStart",h="suspendedYield",l="executing",f="completed",v={};function d(){}function g(){}function y(){}var m={};m[o]=function(){return this};var S=Object.getPrototypeOf,b=S&&S(S(O([])));b&&b!==r&&n.call(b,o)&&(m=b);var R=y.prototype=d.prototype=Object.create(m);function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function C(e){var t;this._invoke=function(r,i){function o(){return new Promise((function(t,o){!function t(r,i,o,s){var c=u(e[r],e,i);if("throw"!==c.type){var a=c.arg,p=a.value;return p&&"object"==typeof p&&n.call(p,"__await")?Promise.resolve(p.__await).then((function(e){t("next",e,o,s)}),(function(e){t("throw",e,o,s)})):Promise.resolve(p).then((function(e){a.value=e,o(a)}),(function(e){return t("throw",e,o,s)}))}s(c.arg)}(r,i,t,o)}))}return t=t?t.then(o,o):o()}}function P(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method))return v;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=u(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function O(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}return{next:T}}function T(){return{value:t,done:!0}}return g.prototype=R.constructor=y,y.constructor=g,y[c]=g.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(R),e},e.awrap=function(e){return{__await:e}},w(C.prototype),C.prototype[s]=function(){return this},e.AsyncIterator=C,e.async=function(t,r,n,i){var o=new C(a(t,r,n,i));return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(R),R[c]="Generator",R[o]=function(){return this},R.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=O,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return c.type="throw",c.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],c=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var a=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(a&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:O(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},function(e,t,r){"use strict";var n=r(37);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createSpeechRecognitionPonyfillFromRecognizer",{enumerable:!0,get:function(){return i.createSpeechRecognitionPonyfillFromRecognizer}}),t.default=void 0;var i=n(r(108)),o=i.default;t.default=o},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.createSpeechRecognitionPonyfillFromRecognizer=_,t.default=void 0;var i=n(r(26)),o=n(r(64)),s=n(r(27)),c=n(r(30)),a=n(r(38)),u=n(r(40)),p=n(r(41)),h=n(r(42)),l=n(r(28)),f=r(112),v=n(r(113)),d=n(r(199)),g=n(r(201)),y=n(r(65));function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(r,!0).forEach((function(t){(0,h.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var b=y.default.AudioConfig,R=y.default.OutputFormat,w=y.default.ResultReason,C=y.default.SpeechConfig,P=y.default.SpeechRecognizer;function I(e){var t=e.duration,r=e.errorDetails,n=e.json,i=e.offset,o=e.properties,s=e.reason,c=e.resultId,a=e.text;return{duration:t,errorDetails:r,json:JSON.parse(n),offset:i,properties:o,reason:s,resultId:c,text:a}}function E(e,t){return function(){return e.apply(void 0,arguments).onSuccessContinueWith((function(e){return t(e)}))}}function A(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return new Promise((function(t,n){return e.apply(void 0,r.concat([t,n]))}))}}var O=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.data,i=r.emma,o=r.interpretation,s=r.resultIndex,c=r.results;(0,l.default)(this,e),this.data=n,this.emma=i,this.interpretation=o,this.resultIndex=s,this.results=c,this.type=t};function T(e){var t,r,n=e.attach;return e.attach=E(n.bind(e),(function(n){return S({},n,{read:E(n.read.bind(n),(function(n){var i,o;return!t&&(i=n.buffer,o=new Int16Array(i),[].reduce.call(o,(function(e,t){return e+Math.abs(t)}),0)/o.length>150)&&(e.events.onEvent({name:"FirstAudibleChunk"}),t=!0),r?{buffer:new ArrayBuffer(0),isEnd:!0,timeReceived:Date.now()}:n}))})})),{audioConfig:e,pause:function(){r=!0},unprepare:function(){e.attach=n}}}function _(e){var t=e.createRecognizer,r=e.enableTelemetry,n=e.looseEvents,h=e.referenceGrammars,y=e.textNormalization;P.enableTelemetry(!1!==r);var m=function(e){function r(){var e;return(0,l.default)(this,r),(e=(0,a.default)(this,(0,u.default)(r).call(this)))._continuous=!1,e._interimResults=!1,e._lang="undefined"!=typeof window?window.document.documentElement.getAttribute("lang")||window.navigator.language:"en-US",e._grammars=new g.default,e._maxAlternatives=1,e}var f;return(0,p.default)(r,e),(0,c.default)(r,[{key:"emitCognitiveServices",value:function(e,t){this.dispatchEvent(new O("cognitiveservices",{data:S({},t,{type:e})}))}},{key:"abort",value:function(){}},{key:"start",value:function(){var e=this;this._startOnce().catch((function(t){e.dispatchEvent(new ErrorEvent("error",{error:t,message:t&&t.message}))}))}},{key:"_startOnce",value:(f=(0,s.default)(i.default.mark((function e(){var r,s,c,a,u,p,l,f,g,m,S,b,R,C,P,E,_,D=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(this.lang);case 2:return r=e.sent,s=T(r.audioConfig),c=s.pause,a=s.unprepare,e.prev=4,u=(0,d.default)(),g=r.audioConfig.events.attach((function(e){var t=e.name;"AudioSourceReadyEvent"===t?u.push({audioSourceReady:{}}):"AudioSourceOffEvent"===t?u.push({audioSourceOff:{}}):"FirstAudibleChunk"===t&&u.push({firstAudibleChunk:{}})})),m=g.detach,r.canceled=function(e,t){var r=t.errorDetails,n=t.offset,i=t.reason,o=t.sessionId;u.push({canceled:{errorDetails:r,offset:n,reason:i,sessionId:o}})},r.recognized=function(e,t){var r=t.offset,n=t.result,i=t.sessionId;u.push({recognized:{offset:r,result:I(n),sessionId:i}})},r.recognizing=function(e,t){var r=t.offset,n=t.result,i=t.sessionId;u.push({recognizing:{offset:r,result:I(n),sessionId:i}})},r.sessionStarted=function(e,t){var r=t.sessionId;u.push({sessionStarted:{sessionId:r}})},r.sessionStopped=function(e,t){var r=t.sessionId;u.push({sessionStopped:{sessionId:r}})},r.speechStartDetected=function(e,t){var r=t.offset,n=t.sessionId;u.push({speechStartDetected:{offset:r,sessionId:n}})},r.speechEndDetected=function(e,t){var r=t.sessionId;u.push({speechEndDetected:{sessionId:r}})},S=this.grammars.phrases,b=r.privReco.dynamicGrammar,h&&h.length&&b.addReferenceGrammar(h),S&&S.length&&b.addPhrase(S),e.next=20,A(r.startContinuousRecognitionAsync.bind(r))();case 20:this.abort=function(){return u.push({abort:{}})},this.stop=function(){return u.push({stop:{}})},P=[],E=i.default.mark((function e(t){var s,a,h,d,g,m,S,b,I,E,T,_;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.shift();case 2:if(s=e.sent,a=s.abort,h=s.audioSourceOff,d=s.audioSourceReady,g=s.canceled,m=s.firstAudibleChunk,S=s.recognized,b=s.recognizing,I=s.stop,Object.keys(s).forEach((function(e){return D.emitCognitiveServices(e,s[e])})),E=g&&g.errorDetails,!/Permission[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]denied/.test(E||"")){e.next=9;break}return C={error:"not-allowed",type:"error"},e.abrupt("return","break");case 9:if(t||D.dispatchEvent(new O("start")),!E){e.next=15;break}return/1006/.test(E)?(R||(D.dispatchEvent(new O("audiostart")),D.dispatchEvent(new O("audioend"))),C={error:"network",type:"error"}):C={error:"unknown",type:"error"},e.abrupt("return","break");case 15:if(!a&&!I){e.next=22;break}if(a?(C={error:"aborted",type:"error"},f="abort"):(c(),f="stop"),!a){e.next=20;break}return e.next=20,A(r.stopContinuousRecognitionAsync.bind(r))();case 20:e.next=61;break;case 22:if(!d){e.next=27;break}D.dispatchEvent(new O("audiostart")),R=!0,e.next=61;break;case 27:if(!m){e.next=32;break}D.dispatchEvent(new O("soundstart")),p=!0,e.next=61;break;case 32:if(!h){e.next=40;break}return l&&D.dispatchEvent(new O("speechend")),p&&D.dispatchEvent(new O("soundend")),R&&D.dispatchEvent(new O("audioend")),R=p=l=!1,e.abrupt("return","break");case 40:if("abort"===f){e.next=61;break}if(!S||!S.result||S.result.reason!==w.NoMatch){e.next=45;break}C={error:"no-speech",type:"error"},e.next=61;break;case 45:if(!S&&!b){e.next=61;break}if(R||(D.dispatchEvent(new O("audiostart")),R=!0),p||(D.dispatchEvent(new O("soundstart")),p=!0),l||(D.dispatchEvent(new O("speechstart")),l=!0),!S){e.next=60;break}if(T=(0,v.default)(S.result,{maxAlternatives:D.maxAlternatives,textNormalization:y}),(_=!!T[0].transcript)&&(P=[].concat((0,o.default)(P),[T]),D.continuous&&D.dispatchEvent(new O("result",{results:P}))),C=D.continuous&&_?null:{results:P,type:"result"},D.continuous){e.next=57;break}return e.next=57,A(r.stopContinuousRecognitionAsync.bind(r))();case 57:n&&C&&_&&(D.dispatchEvent(new O(C.type,C)),C=null),e.next=61;break;case 60:b&&D.interimResults&&D.dispatchEvent(new O("result",{results:[].concat((0,o.default)(P),[(0,v.default)(b.result,{maxAlternatives:D.maxAlternatives,textNormalization:y})])}));case 61:case"end":return e.stop()}}),e)})),_=0;case 25:if(f&&!R){e.next=33;break}return e.delegateYield(E(_),"t0",27);case 27:if("break"!==e.t0){e.next=30;break}return e.abrupt("break",33);case 30:_++,e.next=25;break;case 33:l&&this.dispatchEvent(new O("speechend")),p&&this.dispatchEvent(new O("soundend")),R&&this.dispatchEvent(new O("audioend")),C&&("result"!==C.type||C.results.length||(C={error:"no-speech",type:"error"}),"error"===C.type?this.dispatchEvent(new ErrorEvent("error",C)):this.dispatchEvent(new O(C.type,C))),this.dispatchEvent(new O("end")),m(),e.next=45;break;case 41:throw e.prev=41,e.t1=e.catch(4),console.error(e.t1),e.t1;case 45:return e.prev=45,a(),r.dispose(),e.finish(45);case 49:case"end":return e.stop()}}),e,this,[[4,41,45,49]])}))),function(){return f.apply(this,arguments)})},{key:"stop",value:function(){}},{key:"continuous",get:function(){return this._continuous},set:function(e){this._continuous=e}},{key:"grammars",get:function(){return this._grammars},set:function(e){if(!(e instanceof g.default))throw new Error("The provided value is not of type 'SpeechGrammarList'");this._grammars=e}},{key:"interimResults",get:function(){return this._interimResults},set:function(e){this._interimResults=e}},{key:"maxAlternatives",get:function(){return this._maxAlternatives},set:function(e){this._maxAlternatives=e}},{key:"lang",get:function(){return this._lang},set:function(e){this._lang=e}}]),r}(f.EventTarget);return(0,f.defineEventAttribute)(m.prototype,"audioend"),(0,f.defineEventAttribute)(m.prototype,"audiostart"),(0,f.defineEventAttribute)(m.prototype,"cognitiveservices"),(0,f.defineEventAttribute)(m.prototype,"end"),(0,f.defineEventAttribute)(m.prototype,"error"),(0,f.defineEventAttribute)(m.prototype,"nomatch"),(0,f.defineEventAttribute)(m.prototype,"result"),(0,f.defineEventAttribute)(m.prototype,"soundend"),(0,f.defineEventAttribute)(m.prototype,"soundstart"),(0,f.defineEventAttribute)(m.prototype,"speechend"),(0,f.defineEventAttribute)(m.prototype,"speechstart"),(0,f.defineEventAttribute)(m.prototype,"start"),{SpeechGrammarList:g.default,SpeechRecognition:m,SpeechRecognitionEvent:O}}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.audioConfig,r=void 0===t?b.fromDefaultMicrophoneInput():t,n=e.authorizationToken,o=e.enableTelemetry,c=void 0===o||o,a=e.looseEvent,u=e.looseEvents,p=e.referenceGrammars,h=e.region,l=void 0===h?"westus":h,f=e.speechRecognitionEndpointId,v=e.subscriptionKey,d=e.textNormalization,g=void 0===d?"display":d;if(!n&&!v)return console.warn("web-speech-cognitive-services: Either authorizationToken or subscriptionKey must be specified"),{};if(!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return console.warn("web-speech-cognitive-services: This browser does not support WebRTC and it will not work with Cognitive Services Speech Services."),{};void 0!==a&&(console.warn('web-speech-cognitive-services: The option "looseEvent" should be named as "looseEvents".'),u=a);var y=function(){var e=(0,s.default)(i.default.mark((function e(t){var o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=16;break}if(e.t1=C,"function"!=typeof n){e.next=8;break}return e.next=5,n();case 5:e.t2=e.sent,e.next=11;break;case 8:return e.next=10,n;case 10:e.t2=e.sent;case 11:e.t3=e.t2,e.t4=l,e.t0=e.t1.fromAuthorizationToken.call(e.t1,e.t3,e.t4),e.next=17;break;case 16:e.t0=C.fromSubscription(v,l);case 17:return o=e.t0,f&&(o.endpointId=f),o.outputFormat=R.Detailed,o.speechRecognitionLanguage=t||"en-US",e.abrupt("return",new P(o,r));case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return _({audioConfig:r,createRecognizer:y,enableTelemetry:c,looseEvents:u,referenceGrammars:p,textNormalization:g})}},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t,r){"use strict";var n=r(6)(r(39));Object.defineProperty(t,"__esModule",{value:!0});var i=new WeakMap,o=new WeakMap;function s(e){var t=i.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function c(e){null==e.passiveListener?e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener)}function a(e,t){i.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});for(var r=Object.keys(t),n=0;n<r.length;++n){var o=r[n];o in this||Object.defineProperty(this,o,u(o))}}function u(e){return{get:function(){return s(this).event[e]},set:function(t){s(this).event[e]=t},configurable:!0,enumerable:!0}}function p(e){return{value:function(){var t=s(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function h(e){if(null==e||e===Object.prototype)return a;var t=o.get(e);return null==t&&(t=function(e,t){var r=Object.keys(t);if(0===r.length)return e;function n(t,r){e.call(this,t,r)}n.prototype=Object.create(e.prototype,{constructor:{value:n,configurable:!0,writable:!0}});for(var i=0;i<r.length;++i){var o=r[i];if(!(o in e.prototype)){var s="function"==typeof Object.getOwnPropertyDescriptor(t,o).value;Object.defineProperty(n.prototype,o,s?p(o):u(o))}}return n}(h(Object.getPrototypeOf(e)),e),o.set(e,t)),t}function l(e){return s(e).immediateStopped}function f(e,t){s(e).passiveListener=t}a.prototype={get type(){return s(this).event.type},get target(){return s(this).eventTarget},get currentTarget(){return s(this).currentTarget},composedPath:function(){var e=s(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return s(this).eventPhase},stopPropagation:function(){var e=s(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation:function(){var e=s(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(s(this).event.bubbles)},get cancelable(){return Boolean(s(this).event.cancelable)},preventDefault:function(){c(s(this))},get defaultPrevented(){return s(this).canceled},get composed(){return Boolean(s(this).event.composed)},get timeStamp(){return s(this).timeStamp},get srcElement(){return s(this).eventTarget},get cancelBubble(){return s(this).stopped},set cancelBubble(e){if(e){var t=s(this);t.stopped=!0,"boolean"==typeof t.event.cancelBubble&&(t.event.cancelBubble=!0)}},get returnValue(){return!s(this).canceled},set returnValue(e){e||c(s(this))},initEvent:function(){}},Object.defineProperty(a.prototype,"constructor",{value:a,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(a.prototype,window.Event.prototype),o.set(window.Event.prototype,a));var v=new WeakMap,d=3;function g(e){return null!==e&&"object"===(0,n.default)(e)}function y(e){var t=v.get(e);if(null==t)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function m(e,t){Object.defineProperty(e,"on".concat(t),function(e){return{get:function(){for(var t=y(this).get(e);null!=t;){if(t.listenerType===d)return t.listener;t=t.next}return null},set:function(t){"function"==typeof t||g(t)||(t=null);for(var r=y(this),n=null,i=r.get(e);null!=i;)i.listenerType===d?null!==n?n.next=i.next:null!==i.next?r.set(e,i.next):r.delete(e):n=i,i=i.next;if(null!==t){var o={listener:t,listenerType:d,passive:!1,once:!1,next:null};null===n?r.set(e,o):n.next=o}},configurable:!0,enumerable:!0}}(t))}function S(e){function t(){b.call(this)}t.prototype=Object.create(b.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(var r=0;r<e.length;++r)m(t.prototype,e[r]);return t}function b(){if(!(this instanceof b)){if(1===arguments.length&&Array.isArray(arguments[0]))return S(arguments[0]);if(arguments.length>0){for(var e=new Array(arguments.length),t=0;t<arguments.length;++t)e[t]=arguments[t];return S(e)}throw new TypeError("Cannot call a class as a function")}v.set(this,new Map)}b.prototype={addEventListener:function(e,t,r){if(null!=t){if("function"!=typeof t&&!g(t))throw new TypeError("'listener' should be a function or an object.");var n=y(this),i=g(r),o=(i?Boolean(r.capture):Boolean(r))?1:2,s={listener:t,listenerType:o,passive:i&&Boolean(r.passive),once:i&&Boolean(r.once),next:null},c=n.get(e);if(void 0!==c){for(var a=null;null!=c;){if(c.listener===t&&c.listenerType===o)return;a=c,c=c.next}a.next=s}else n.set(e,s)}},removeEventListener:function(e,t,r){if(null!=t)for(var n=y(this),i=(g(r)?Boolean(r.capture):Boolean(r))?1:2,o=null,s=n.get(e);null!=s;){if(s.listener===t&&s.listenerType===i)return void(null!==o?o.next=s.next:null!==s.next?n.set(e,s.next):n.delete(e));o=s,s=s.next}},dispatchEvent:function(e){if(null==e||"string"!=typeof e.type)throw new TypeError('"event.type" should be a string.');var t=y(this),r=e.type,n=t.get(r);if(null==n)return!0;for(var i=function(e,t){return new(h(Object.getPrototypeOf(t)))(e,t)}(this,e),o=null;null!=n;){if(n.once?null!==o?o.next=n.next:null!==n.next?t.set(r,n.next):t.delete(r):o=n,f(i,n.passive?n.listener:null),"function"==typeof n.listener)try{n.listener.call(this,i)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else n.listenerType!==d&&"function"==typeof n.listener.handleEvent&&n.listener.handleEvent(i);if(l(i))break;n=n.next}return f(i,null),function(e,t){s(e).eventPhase=t}(i,0),function(e,t){s(e).currentTarget=t}(i,null),!i.defaultPrevented}},Object.defineProperty(b.prototype,"constructor",{value:b,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(b.prototype,window.EventTarget.prototype),t.defineEventAttribute=m,t.EventTarget=b,t.default=b,e.exports=b,e.exports.EventTarget=e.exports.default=b,e.exports.defineEventAttribute=m},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.maxAlternatives,n=void 0===r?1/0:r,o=t.textNormalization,a=void 0===o?"display":o;if(e.reason===s||e.reason===c&&!e.json.NBest){var u=[{confidence:.5,transcript:e.text}];return e.reason===c&&(u.isFinal=!0),u}if(e.reason===c)return(0,i.default)((e.json.NBest||[]).slice(0,n).map((function(e){var t=e.Confidence,r=e.Display,n=e.ITN,i=e.Lexical,o=e.MaskedITN;return{confidence:t,transcript:"itn"===a?n:"lexical"===a?i:"maskeditn"===a?o:r}})),{isFinal:!0});return[]};var i=n(r(114)),o=n(r(65)).default.ResultReason,s=o.RecognizingSpeech,c=o.RecognizedSpeech},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(r,!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},[].reduce.call(e,(function(e,t,r){return e[r]=t,e}),{}),{},t,(0,i.default)({length:e.length},Symbol.iterator,(function(){return[].slice.call(r)[Symbol.iterator]()})));return r};var i=n(r(42));function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22);r(4).Events.instance.attachListener(new n.ConsoleLoggingListener),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(1))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=function(e){var t=this;void 0===e&&(e=n.EventType.Warning),this.onEvent=function(e){if(e.eventType>=t.privLogLevelFilter){var r=t.toString(e);switch(e.eventType){case n.EventType.Debug:console.debug(r);break;case n.EventType.Info:console.info(r);break;case n.EventType.Warning:console.warn(r);break;case n.EventType.Error:console.error(r);break;default:console.log(r)}}},this.toString=function(e){var t=[""+e.EventTime,""+e.Name];for(var r in e)if(r&&e.hasOwnProperty(r)&&"eventTime"!==r&&"eventType"!==r&&"eventId"!==r&&"name"!==r&&"constructor"!==r){var n=e[r],i="<NULL>";null!=n&&(i="number"==typeof n||"string"==typeof n?n.toString():JSON.stringify(n)),t.push(r+": "+i)}return t.join(" | ")},this.privLogLevelFilter=e};t.ConsoleLoggingListener=i},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(43),s=function(e){function t(t,r,n){void 0===n&&(n=o.EventType.Info);var i=e.call(this,t,n)||this;return i.privAudioSourceId=r,i}return i(t,e),Object.defineProperty(t.prototype,"audioSourceId",{get:function(){return this.privAudioSourceId},enumerable:!0,configurable:!0}),t}(o.PlatformEvent);t.AudioSourceEvent=s;var c=function(e){function t(t){return e.call(this,"AudioSourceInitializingEvent",t)||this}return i(t,e),t}(s);t.AudioSourceInitializingEvent=c;var a=function(e){function t(t){return e.call(this,"AudioSourceReadyEvent",t)||this}return i(t,e),t}(s);t.AudioSourceReadyEvent=a;var u=function(e){function t(t){return e.call(this,"AudioSourceOffEvent",t)||this}return i(t,e),t}(s);t.AudioSourceOffEvent=u;var p=function(e){function t(t,r){var n=e.call(this,"AudioSourceErrorEvent",t,o.EventType.Error)||this;return n.privError=r,n}return i(t,e),Object.defineProperty(t.prototype,"error",{get:function(){return this.privError},enumerable:!0,configurable:!0}),t}(s);t.AudioSourceErrorEvent=p;var h=function(e){function t(t,r,n){var i=e.call(this,t,r)||this;return i.privAudioNodeId=n,i}return i(t,e),Object.defineProperty(t.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),t}(s);t.AudioStreamNodeEvent=h;var l=function(e){function t(t,r){return e.call(this,"AudioStreamNodeAttachingEvent",t,r)||this}return i(t,e),t}(h);t.AudioStreamNodeAttachingEvent=l;var f=function(e){function t(t,r){return e.call(this,"AudioStreamNodeAttachedEvent",t,r)||this}return i(t,e),t}(h);t.AudioStreamNodeAttachedEvent=f;var v=function(e){function t(t,r){return e.call(this,"AudioStreamNodeDetachedEvent",t,r)||this}return i(t,e),t}(h);t.AudioStreamNodeDetachedEvent=v;var d=function(e){function t(t,r,n){var i=e.call(this,"AudioStreamNodeErrorEvent",t,r)||this;return i.privError=n,i}return i(t,e),Object.defineProperty(t.prototype,"error",{get:function(){return this.privError},enumerable:!0,configurable:!0}),t}(h);t.AudioStreamNodeErrorEvent=d},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(43),s=function(e){function t(t,r,n){void 0===n&&(n=o.EventType.Info);var i=e.call(this,t,n)||this;return i.privConnectionId=r,i}return i(t,e),Object.defineProperty(t.prototype,"connectionId",{get:function(){return this.privConnectionId},enumerable:!0,configurable:!0}),t}(o.PlatformEvent);t.ConnectionEvent=s;var c=function(e){function t(t,r,n){var i=e.call(this,"ConnectionStartEvent",t)||this;return i.privUri=r,i.privHeaders=n,i}return i(t,e),Object.defineProperty(t.prototype,"uri",{get:function(){return this.privUri},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headers",{get:function(){return this.privHeaders},enumerable:!0,configurable:!0}),t}(s);t.ConnectionStartEvent=c;var a=function(e){function t(t,r){return e.call(this,"ConnectionEstablishedEvent",t)||this}return i(t,e),t}(s);t.ConnectionEstablishedEvent=a;var u=function(e){function t(t,r,n){var i=e.call(this,"ConnectionClosedEvent",t,o.EventType.Debug)||this;return i.privRreason=n,i.privStatusCode=r,i}return i(t,e),Object.defineProperty(t.prototype,"reason",{get:function(){return this.privRreason},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"statusCode",{get:function(){return this.privStatusCode},enumerable:!0,configurable:!0}),t}(s);t.ConnectionClosedEvent=u;var p=function(e){function t(t,r,n){var i=e.call(this,"ConnectionEstablishErrorEvent",t,o.EventType.Error)||this;return i.privStatusCode=r,i.privReason=n,i}return i(t,e),Object.defineProperty(t.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"statusCode",{get:function(){return this.privStatusCode},enumerable:!0,configurable:!0}),t}(s);t.ConnectionEstablishErrorEvent=p;var h=function(e){function t(t,r,n){var i=e.call(this,"ConnectionMessageReceivedEvent",t)||this;return i.privNetworkReceivedTime=r,i.privMessage=n,i}return i(t,e),Object.defineProperty(t.prototype,"networkReceivedTime",{get:function(){return this.privNetworkReceivedTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.privMessage},enumerable:!0,configurable:!0}),t}(s);t.ConnectionMessageReceivedEvent=h;var l=function(e){function t(t,r,n){var i=e.call(this,"ConnectionMessageSentEvent",t)||this;return i.privNetworkSentTime=r,i.privMessage=n,i}return i(t,e),Object.defineProperty(t.prototype,"networkSentTime",{get:function(){return this.privNetworkSentTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.privMessage},enumerable:!0,configurable:!0}),t}(s);t.ConnectionMessageSentEvent=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.privStatusCode=e,this.privReason=t}return Object.defineProperty(e.prototype,"statusCode",{get:function(){return this.privStatusCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),e}();t.ConnectionOpenResponse=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),i=r(67),o=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e.privInstance},enumerable:!0,configurable:!0}),e.privInstance=new i.EventSource,e.setEventSource=function(t){if(!t)throw new n.ArgumentNullError("eventSource");e.privInstance=t},e}();t.Events=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"}(t.ConnectionState||(t.ConnectionState={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(66),i=r(11),o=r(18),s=function(){function e(e,t,r){if(this.privPayload=null,!t)throw new i.ArgumentNullError("payload");if(e===n.MessageType.Binary&&!(t instanceof ArrayBuffer))throw new i.InvalidOperationError("Payload must be ArrayBuffer");if(e===n.MessageType.Text&&"string"!=typeof t)throw new i.InvalidOperationError("Payload must be a string");this.privMessageType=e,this.privPayload=t,this.privId=r||o.createNoDashGuid()}return Object.defineProperty(e.prototype,"messageType",{get:function(){return this.privMessageType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"payload",{get:function(){return this.privPayload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textContent",{get:function(){if(this.privMessageType===n.MessageType.Binary)throw new i.InvalidOperationError("Not supported for binary message");return this.privPayload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryContent",{get:function(){if(this.privMessageType===n.MessageType.Text)throw new i.InvalidOperationError("Not supported for text message");return this.privPayload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privId},enumerable:!0,configurable:!0}),e}();t.RawWebsocketMessage=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){var r=this;this.privChannelCount=1,this.encode=function(e,t){var n=r.downSampleAudioFrame(t,r.privActualSampleRate,r.privDesiredSampleRate);if(!n)return null;var i=2*n.length;if(!e){var o=new ArrayBuffer(i),s=new DataView(o);return r.floatTo16BitPCM(s,0,n),o}var c=new ArrayBuffer(44+i),a=new DataView(c);return r.setString(a,0,"RIFF"),a.setUint32(4,0,!0),r.setString(a,8,"WAVEfmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,r.privChannelCount,!0),a.setUint32(24,r.privDesiredSampleRate,!0),a.setUint32(28,r.privDesiredSampleRate*r.privChannelCount*2,!0),a.setUint16(32,2*r.privChannelCount,!0),a.setUint16(34,16,!0),r.setString(a,36,"data"),a.setUint32(40,0,!0),r.floatTo16BitPCM(a,44,n),c},this.setString=function(e,t,r){for(var n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))},this.floatTo16BitPCM=function(e,t,r){for(var n=0;n<r.length;n++,t+=2){var i=Math.max(-1,Math.min(1,r[n]));e.setInt16(t,i<0?32768*i:32767*i,!0)}},this.downSampleAudioFrame=function(e,t,r){if(r===t||r>t)return e;for(var n=t/r,i=Math.round(e.length/n),o=new Float32Array(i),s=0,c=0;c<i;){for(var a=Math.round((c+1)*n),u=0,p=0;s<a&&s<e.length;)u+=e[s++],p++;o[c++]=u/p}return o},this.privActualSampleRate=e,this.privDesiredSampleRate=t};t.RiffPcmEncoder=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),i=r(18),o=r(70),s=function(){function e(e){var t=this;this.privReaderIdCounter=1,this.privIsEnded=!1,this.getReader=function(){var e=t.privReaderIdCounter;t.privReaderIdCounter++;var r=new o.Queue,n=t.privStreambuffer.length;t.privReaderQueues[e]=r;for(var i=0;i<n;i++)r.enqueue(t.privStreambuffer[i]);return new c(t.privId,r,(function(){delete t.privReaderQueues[e]}))},this.throwIfClosed=function(){if(t.privIsEnded)throw new n.InvalidOperationError("Stream closed")},this.privId=e||i.createNoDashGuid(),this.privStreambuffer=[],this.privReaderQueues={}}return Object.defineProperty(e.prototype,"isClosed",{get:function(){return this.privIsEnded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.privId},enumerable:!0,configurable:!0}),e.prototype.close=function(){this.privIsEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsEnded=!0)},e.prototype.writeStreamChunk=function(e){for(var t in this.throwIfClosed(),this.privStreambuffer.push(e),this.privReaderQueues)if(!this.privReaderQueues[t].isDisposed())try{this.privReaderQueues[t].enqueue(e)}catch(e){}},e}();t.Stream=s;var c=function(){function e(e,t,r){var i=this;this.privIsClosed=!1,this.read=function(){if(i.isClosed)throw new n.InvalidOperationError("StreamReader closed");return i.privReaderQueue.dequeue().onSuccessContinueWith((function(e){return e.isEnd&&i.privReaderQueue.dispose("End of stream reached"),e}))},this.close=function(){i.privIsClosed||(i.privIsClosed=!0,i.privReaderQueue.dispose("StreamReader closed"),i.privOnClose())},this.privReaderQueue=t,this.privOnClose=r,this.privStreamId=e}return Object.defineProperty(e.prototype,"isClosed",{get:function(){return this.privIsClosed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"streamId",{get:function(){return this.privStreamId},enumerable:!0,configurable:!0}),e}();t.StreamReader=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){var n=e.call(this,r)||this;return n.privTargetChunkSize=t,n.privNextBufferReadyBytes=0,n}return i(t,e),t.prototype.writeStreamChunk=function(t){if(t.isEnd||0===this.privNextBufferReadyBytes&&t.buffer.byteLength===this.privTargetChunkSize)e.prototype.writeStreamChunk.call(this,t);else for(var r=0;r<t.buffer.byteLength;){void 0===this.privNextBufferToWrite&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=t.timeReceived);var n=Math.min(t.buffer.byteLength-r,this.privTargetChunkSize-this.privNextBufferReadyBytes),i=new Uint8Array(this.privNextBufferToWrite),o=new Uint8Array(t.buffer.slice(r,n+r));i.set(o,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=n,r+=n,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(e.prototype.writeStreamChunk.call(this,{buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}},t.prototype.close=function(){0===this.privNextBufferReadyBytes||this.isClosed||e.prototype.writeStreamChunk.call(this,{buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),e.prototype.close.call(this)},t}(r(4).Stream);t.ChunkedArrayBufferStream=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(31),i=r(2),o=r(4);t.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";var s=function(){function e(e,t,r,n){var i=this;this.privRecorder=e,this.deviceId=n,this.privStreams={},this.turnOn=function(){if(i.privInitializeDeferral)return i.privInitializeDeferral.promise();i.privInitializeDeferral=new o.Deferred,i.createAudioContext();var e=window.navigator,t=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia;if(e.mediaDevices&&(t=function(t,r,n){e.mediaDevices.getUserMedia(t).then(r).catch(n)}),t){var r=function(){i.onEvent(new o.AudioSourceInitializingEvent(i.privId)),t({audio:!i.deviceId||{deviceId:i.deviceId},video:!1},(function(e){i.privMediaStream=e,i.onEvent(new o.AudioSourceReadyEvent(i.privId)),i.privInitializeDeferral.resolve(!0)}),(function(e){var t="Error occurred during microphone initialization: "+e,r=i.privInitializeDeferral;i.privInitializeDeferral=null,r.reject(t),i.onEvent(new o.AudioSourceErrorEvent(i.privId,t))}))};"suspended"===i.privContext.state?i.privContext.resume().then(r,(function(e){i.privInitializeDeferral.reject("Failed to initialize audio context: "+e)})):r()}else{var n="Browser does not support getUserMedia.";i.privInitializeDeferral.reject(n),i.onEvent(new o.AudioSourceErrorEvent(n,""))}return i.privInitializeDeferral.promise()},this.id=function(){return i.privId},this.attach=function(e){return i.onEvent(new o.AudioStreamNodeAttachingEvent(i.privId,e)),i.listen(e).onSuccessContinueWith((function(t){return i.onEvent(new o.AudioStreamNodeAttachedEvent(i.privId,e)),{detach:function(){t.close(),delete i.privStreams[e],i.onEvent(new o.AudioStreamNodeDetachedEvent(i.privId,e)),i.turnOff()},id:function(){return e},read:function(){return t.read()}}}))},this.detach=function(e){e&&i.privStreams[e]&&(i.privStreams[e].close(),delete i.privStreams[e],i.onEvent(new o.AudioStreamNodeDetachedEvent(i.privId,e)))},this.turnOff=function(){for(var e in i.privStreams)if(e){var t=i.privStreams[e];t&&t.close()}return i.onEvent(new o.AudioSourceOffEvent(i.privId)),i.privInitializeDeferral=null,i.destroyAudioContext(),o.PromiseHelper.fromResult(!0)},this.listen=function(e){return i.turnOn().onSuccessContinueWith((function(t){var r=new o.ChunkedArrayBufferStream(i.privOutputChunkSize,e);i.privStreams[e]=r;try{i.privRecorder.record(i.privContext,i.privMediaStream,r)}catch(t){throw i.onEvent(new o.AudioStreamNodeErrorEvent(i.privId,e,t)),t}return r.getReader()}))},this.onEvent=function(e){i.privEvents.onEvent(e),o.Events.instance.onEvent(e)},this.createAudioContext=function(){if(!i.privContext){var e=window.AudioContext||window.webkitAudioContext||!1;if(!e)throw new Error("Browser does not support Web Audio API (AudioContext is not available).");i.privContext=new e}},this.destroyAudioContext=function(){if(i.privContext){i.privRecorder.releaseMediaResources(i.privContext);var e=!1;"close"in i.privContext&&(e=!0),e?(i.privContext.close(),i.privContext=null):null!==i.privContext&&"running"===i.privContext.state&&i.privContext.suspend()}},this.privOutputChunkSize=t,this.privId=r||o.createNoDashGuid(),this.privEvents=new o.EventSource}return Object.defineProperty(e.prototype,"format",{get:function(){return e.AUDIOFORMAT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return this.privEvents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceInfo",{get:function(){return this.getMicrophoneLabel().onSuccessContinueWith((function(t){return{bitspersample:e.AUDIOFORMAT.bitsPerSample,channelcount:e.AUDIOFORMAT.channels,connectivity:i.connectivity.Unknown,manufacturer:"Speech SDK",model:t,samplerate:e.AUDIOFORMAT.samplesPerSec,type:i.type.Microphones}}))},enumerable:!0,configurable:!0}),e.prototype.setProperty=function(e,r){if(e!==t.AudioWorkletSourceURLPropertyName)throw new Error("Property '"+e+"' is not supported on Microphone.");this.privRecorder.setWorkletUrl(r)},e.prototype.getMicrophoneLabel=function(){var e=this;if(void 0!==this.privMicrophoneLabel)return o.PromiseHelper.fromResult(this.privMicrophoneLabel);if(void 0===this.privMediaStream||!this.privMediaStream.active)return o.PromiseHelper.fromResult("microphone");this.privMicrophoneLabel="microphone";var t=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(void 0===t)return o.PromiseHelper.fromResult(this.privMicrophoneLabel);var r=new o.Deferred;return navigator.mediaDevices.enumerateDevices().then((function(n){for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s.deviceId===t){e.privMicrophoneLabel=s.label;break}}r.resolve(e.privMicrophoneLabel)}),(function(){return r.resolve(e.privMicrophoneLabel)})),r.promise()},e.AUDIOFORMAT=n.AudioStreamFormat.getDefaultInputFormat(),e}();t.MicAudioSource=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(45),o="Ocp-Apim-Subscription-Key",s=function(e){var t=this;if(this.fetch=function(e){return n.PromiseHelper.fromResult(t.privAuthInfo)},this.fetchOnExpiry=function(e){return n.PromiseHelper.fromResult(t.privAuthInfo)},!e)throw new n.ArgumentNullError("subscriptionKey");this.privAuthInfo=new i.AuthInfo(o,e)};t.CognitiveSubscriptionKeyAuthentication=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(45),o="Authorization",s=function(e,t){var r=this;if(this.fetch=function(e){return r.privFetchCallback(e).onSuccessContinueWith((function(e){return new i.AuthInfo(o,e)}))},this.fetchOnExpiry=function(e){return r.privFetchOnExpiryCallback(e).onSuccessContinueWith((function(e){return new i.AuthInfo(o,e)}))},!e)throw new n.ArgumentNullError("fetchCallback");if(!t)throw new n.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=t};t.CognitiveTokenAuthentication=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22),i=r(1),o=r(2),s="X-ConnectionId",c=function(){function e(){var e=this;this.create=function(t,r,c){var a=t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint);if(!a){var u=t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_IntentRegion);a="wss://speech.platform.bing.com/speech/"+e.getSpeechRegionFromIntentRegion(u)+"/recognition/interactive/cognitiveservices/v1"}var p={format:"simple",language:t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage)},h={};return h[r.headerName]=r.token,h[s]=c,new n.WebsocketConnection(a,p,h,new o.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(t),c)}}return e.prototype.getSpeechRegionFromIntentRegion=function(e){switch(e){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return e}},e}();t.IntentConnectionFactory=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(22),s=r(12),c=r(1),a=r(71),u=function(){function e(){}return e.fromDefaultMicrophoneInput=function(){var e=new o.PcmRecorder;return new p(new o.MicAudioSource(e,a.bufferSize))},e.fromMicrophoneInput=function(e){var t=new o.PcmRecorder;return new p(new o.MicAudioSource(t,a.bufferSize,e))},e.fromWavFileInput=function(e){return new p(new o.FileAudioSource(e))},e.fromStreamInput=function(e){if(e instanceof c.PullAudioInputStreamCallback)return new p(new a.PullAudioInputStreamImpl(e));if(e instanceof c.AudioInputStream)return new p(e);throw new Error("Not Supported Type")},e}();t.AudioConfig=u;var p=function(e){function t(t){var r=e.call(this)||this;return r.privSource=t,r}return i(t,e),Object.defineProperty(t.prototype,"format",{get:function(){return this.privSource.format},enumerable:!0,configurable:!0}),t.prototype.close=function(){this.privSource.turnOff()},t.prototype.id=function(){return this.privSource.id()},t.prototype.turnOn=function(){return this.privSource.turnOn()},t.prototype.attach=function(e){return this.privSource.attach(e)},t.prototype.detach=function(e){return this.detach(e)},t.prototype.turnOff=function(){return this.privSource.turnOff()},Object.defineProperty(t.prototype,"events",{get:function(){return this.privSource.events},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){if(s.Contracts.throwIfNull(t,"value"),void 0===this.privSource.setProperty)throw new Error("This AudioConfig instance does not support setting properties.");this.privSource.setProperty(e,t)},t.prototype.getProperty=function(e,t){if(void 0!==this.privSource.getProperty)return this.privSource.getProperty(e,t);throw new Error("This AudioConfig instance does not support getting properties.")},Object.defineProperty(t.prototype,"deviceInfo",{get:function(){return this.privSource.deviceInfo},enumerable:!0,configurable:!0}),t}(u);t.AudioConfigImpl=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"}(t.CancellationReason||(t.CancellationReason={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){};t.PullAudioInputStreamCallback=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12),i=function(){function e(){this.privDisposed=!1}return e.fromFile=function(e){throw n.Contracts.throwIfFileDoesNotExist(e,"fileName"),new Error("Not yet implemented.")},e.fromStream=function(e){throw n.Contracts.throwIfNull(e,"file"),new Error("Not yet implemented.")},e.prototype.close=function(){this.privDisposed||(this.privDisposed=!0)},e}();t.KeywordRecognitionModel=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privSessionId=e}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!0,configurable:!0}),e}();t.SessionEventArgs=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){var n=e.call(this,r)||this;return n.privOffset=t,n}return i(t,e),Object.defineProperty(t.prototype,"offset",{get:function(){return this.privOffset},enumerable:!0,configurable:!0}),t}(r(1).SessionEventArgs);t.RecognitionEventArgs=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(t.OutputFormat||(t.OutputFormat={}))},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var i=e.call(this,r,n)||this;return i.privResult=t,i}return i(t,e),Object.defineProperty(t.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),t}(r(1).RecognitionEventArgs);t.IntentRecognitionEventArgs=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,n,i,o,s,c){this.privResultId=e,this.privReason=t,this.privText=r,this.privDuration=n,this.privOffset=i,this.privErrorDetails=o,this.privJson=s,this.privProperties=c}return Object.defineProperty(e.prototype,"resultId",{get:function(){return this.privResultId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.privText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.privDuration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offset",{get:function(){return this.privOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"json",{get:function(){return this.privJson},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),e}();t.RecognitionResult=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o,s,c,a){return e.call(this,t,r,n,i,o,s,c,a)||this}return i(t,e),t}(r(1).RecognitionResult);t.SpeechRecognitionResult=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o,s,c,a,u){var p=e.call(this,r,n,i,o,s,c,a,u)||this;return p.privIntentId=t,p}return i(t,e),Object.defineProperty(t.prototype,"intentId",{get:function(){return this.privIntentId},enumerable:!0,configurable:!0}),t}(r(1).SpeechRecognitionResult);t.IntentRecognitionResult=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(12),s=function(){function e(){}return e.fromEndpoint=function(e){o.Contracts.throwIfNull(e,"uri"),o.Contracts.throwIfNullOrWhitespace(e.hostname,"uri");var t=new c,r=e.host.indexOf(".");if(-1===r)throw new Error("Could not determine region from endpoint");t.region=e.host.substr(0,r);var n=e.pathname.lastIndexOf("/")+1;if(-1===n)throw new Error("Could not determine appId from endpoint");if(t.appId=e.pathname.substr(n),t.subscriptionKey=e.searchParams.get("subscription-key"),void 0===t.subscriptionKey)throw new Error("Could not determine subscription key from endpoint");return t},e.fromAppId=function(e){o.Contracts.throwIfNullOrWhitespace(e,"appId");var t=new c;return t.appId=e,t},e.fromSubscription=function(e,t,r){o.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),o.Contracts.throwIfNullOrWhitespace(t,"appId"),o.Contracts.throwIfNullOrWhitespace(r,"region");var n=new c;return n.appId=t,n.region=r,n.subscriptionKey=e,n},e}();t.LanguageUnderstandingModel=s;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(s);t.LanguageUnderstandingModelImpl=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var i=e.call(this,r,n)||this;return i.privResult=t,i}return i(t,e),Object.defineProperty(t.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),t}(r(1).RecognitionEventArgs);t.SpeechRecognitionEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o){var s=e.call(this,i,o)||this;return s.privReason=t,s.privErrorDetails=r,s.privErrorCode=n,s}return i(t,e),Object.defineProperty(t.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorCode",{get:function(){return this.privErrorCode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),t}(r(1).RecognitionEventArgs);t.SpeechRecognitionCanceledEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n){var i=e.call(this,r,n)||this;return i.privResult=t,i}return i(t,e),Object.defineProperty(t.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),t}(r(1).RecognitionEventArgs);t.TranslationRecognitionEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){var n=e.call(this,r)||this;return n.privResult=t,n}return i(t,e),Object.defineProperty(t.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),t}(r(1).SessionEventArgs);t.TranslationSynthesisEventArgs=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o,s,c,a,u){var p=e.call(this,r,n,i,o,s,c,a,u)||this;return p.privTranslations=t,p}return i(t,e),Object.defineProperty(t.prototype,"translations",{get:function(){return this.privTranslations},enumerable:!0,configurable:!0}),t}(r(1).SpeechRecognitionResult);t.TranslationRecognitionResult=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.privReason=e,this.privAudio=t}return Object.defineProperty(e.prototype,"audio",{get:function(){return this.privAudio},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),e}();t.TranslationSynthesisResult=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizingIntent=4]="RecognizingIntent",e[e.RecognizedIntent=5]="RecognizedIntent",e[e.TranslatingSpeech=6]="TranslatingSpeech",e[e.TranslatedSpeech=7]="TranslatedSpeech",e[e.SynthesizingAudio=8]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=9]="SynthesizingAudioCompleted"}(t.ResultReason||(t.ResultReason={}))},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),s=r(12),c=r(1),a=function(){function e(){}return e.fromSubscription=function(e,t){s.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),s.Contracts.throwIfNullOrWhitespace(t,"region");var r=new u;return r.setProperty(c.PropertyId.SpeechServiceConnection_Region,t),r.setProperty(c.PropertyId.SpeechServiceConnection_IntentRegion,t),r.setProperty(c.PropertyId.SpeechServiceConnection_Key,e),r},e.fromEndpoint=function(e,t){s.Contracts.throwIfNull(e,"endpoint"),s.Contracts.throwIfNull(t,"subscriptionKey");var r=new u;return r.setProperty(c.PropertyId.SpeechServiceConnection_Endpoint,e.href),r.setProperty(c.PropertyId.SpeechServiceConnection_Key,t),r},e.fromAuthorizationToken=function(e,t){s.Contracts.throwIfNull(e,"authorizationToken"),s.Contracts.throwIfNullOrWhitespace(t,"region");var r=new u;return r.setProperty(c.PropertyId.SpeechServiceConnection_Region,t),r.setProperty(c.PropertyId.SpeechServiceConnection_IntentRegion,t),r.authorizationToken=e,r},e.prototype.close=function(){},e}();t.SpeechConfig=a;var u=function(e){function t(){var t=e.call(this)||this;return t.privProperties=new c.PropertyCollection,t.speechRecognitionLanguage="en-US",t.outputFormat=c.OutputFormat.Simple,t}return i(t,e),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endPoint",{get:function(){return new URL(this.privProperties.getProperty(c.PropertyId.SpeechServiceConnection_Endpoint))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subscriptionKey",{get:function(){return this.privProperties.getProperty(c.PropertyId.SpeechServiceConnection_Key)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"region",{get:function(){return this.privProperties.getProperty(c.PropertyId.SpeechServiceConnection_Region)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorizationToken",{get:function(){return this.privProperties.getProperty(c.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){this.privProperties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{get:function(){return this.privProperties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage)},set:function(e){this.privProperties.setProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputFormat",{get:function(){return c.OutputFormat[this.privProperties.getProperty(o.OutputFormatPropertyName,void 0)]},set:function(e){this.privProperties.setProperty(o.OutputFormatPropertyName,c.OutputFormat[e])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endpointId",{get:function(){return this.privProperties.getProperty(c.PropertyId.SpeechServiceConnection_EndpointId)},set:function(e){this.privProperties.setProperty(c.PropertyId.SpeechServiceConnection_EndpointId,e)},enumerable:!0,configurable:!0}),t.prototype.setProperty=function(e,t){s.Contracts.throwIfNull(t,"value"),this.privProperties.setProperty(e,t)},t.prototype.getProperty=function(e,t){return this.privProperties.getProperty(e,t)},t.prototype.setProxy=function(e,t,r,n){this.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_ProxyHostName],e),this.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_ProxyUserName],r),this.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_ProxyPassword],n)},t.prototype.clone=function(){var e=new t;return e.privProperties=this.privProperties.clone(),e},t}(a);t.SpeechConfigImpl=u},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),s=r(12),c=r(1),a=function(e){function t(){return e.call(this)||this}return i(t,e),t.fromSubscription=function(e,t){s.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),s.Contracts.throwIfNullOrWhitespace(t,"region");var r=new u;return r.properties.setProperty(c.PropertyId.SpeechServiceConnection_Key,e),r.properties.setProperty(c.PropertyId.SpeechServiceConnection_Region,t),r},t.fromAuthorizationToken=function(e,t){s.Contracts.throwIfNullOrWhitespace(e,"authorizationToken"),s.Contracts.throwIfNullOrWhitespace(t,"region");var r=new u;return r.properties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token,e),r.properties.setProperty(c.PropertyId.SpeechServiceConnection_Region,t),r},t.fromEndpoint=function(e,t){s.Contracts.throwIfNull(e,"endpoint"),s.Contracts.throwIfNull(t,"subscriptionKey");var r=new u;return r.properties.setProperty(c.PropertyId.SpeechServiceConnection_Endpoint,e.href),r.properties.setProperty(c.PropertyId.SpeechServiceConnection_Key,t),r},t}(c.SpeechConfig);t.SpeechTranslationConfig=a;var u=function(e){function t(){var t=e.call(this)||this;return t.privSpeechProperties=new c.PropertyCollection,t.outputFormat=c.OutputFormat.Simple,t}return i(t,e),Object.defineProperty(t.prototype,"authorizationToken",{set:function(e){s.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{set:function(e){s.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subscriptionKey",{get:function(){return this.privSpeechProperties.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_Key])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputFormat",{get:function(){return c.OutputFormat[this.privSpeechProperties.getProperty(o.OutputFormatPropertyName,void 0)]},set:function(e){this.privSpeechProperties.setProperty(o.OutputFormatPropertyName,c.OutputFormat[e])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endpointId",{get:function(){return this.privSpeechProperties.getProperty(c.PropertyId.SpeechServiceConnection_EndpointId)},set:function(e){this.privSpeechProperties.setProperty(c.PropertyId.SpeechServiceConnection_Endpoint,e)},enumerable:!0,configurable:!0}),t.prototype.addTargetLanguage=function(e){s.Contracts.throwIfNullOrWhitespace(e,"value");var t=this.targetLanguages;t.push(e),this.privSpeechProperties.setProperty(c.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(","))},Object.defineProperty(t.prototype,"targetLanguages",{get:function(){return void 0!==this.privSpeechProperties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)?this.privSpeechProperties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"voiceName",{get:function(){return this.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_TranslationVoice])},set:function(e){s.Contracts.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(c.PropertyId.SpeechServiceConnection_TranslationVoice,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"region",{get:function(){return this.privSpeechProperties.getProperty(c.PropertyId.SpeechServiceConnection_Region)},enumerable:!0,configurable:!0}),t.prototype.setProxy=function(e,t,r,n){this.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_ProxyHostName],e),this.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_ProxyUserName],r),this.setProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_ProxyPassword],n)},t.prototype.getProperty=function(e,t){return this.privSpeechProperties.getProperty(e,t)},t.prototype.setProperty=function(e,t){this.privSpeechProperties.setProperty(e,t)},Object.defineProperty(t.prototype,"properties",{get:function(){return this.privSpeechProperties},enumerable:!0,configurable:!0}),t.prototype.close=function(){},t}(a);t.SpeechTranslationConfigImpl=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=function(){function e(){this.privKeys=[],this.privValues=[]}return e.prototype.getProperty=function(e,t){var r;r="string"==typeof e?e:n.PropertyId[e];for(var i=0;i<this.privKeys.length;i++)if(this.privKeys[i]===r)return this.privValues[i];return t},e.prototype.setProperty=function(e,t){var r;r="string"==typeof e?e:n.PropertyId[e];for(var i=0;i<this.privKeys.length;i++)if(this.privKeys[i]===r)return void(this.privValues[i]=t);this.privKeys.push(r),this.privValues.push(t)},e.prototype.clone=function(){for(var t=new e,r=0;r<this.privKeys.length;r++)t.privKeys.push(this.privKeys[r]),t.privValues.push(this.privValues[r]);return t},e}();t.PropertyCollection=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=17]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=18]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=19]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=20]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=21]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=22]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=23]="CancellationDetails_ReasonDetailedText",e[e.LanguageUnderstandingServiceResponse_JsonResult=24]="LanguageUnderstandingServiceResponse_JsonResult"}(t.PropertyId||(t.PropertyId={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(4),o=r(12),s=r(1),c=function(){function e(e,t,r){this.audioConfig=void 0!==e?e:s.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=r,this.implCommonRecognizerSetup()}return e.prototype.close=function(){o.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)},Object.defineProperty(e.prototype,"internalData",{get:function(){return this.privReco},enumerable:!0,configurable:!0}),e.prototype.dispose=function(e){this.privDisposed||(e&&this.privReco&&(this.privReco.audioSource.turnOff(),this.privReco.dispose()),this.privDisposed=!0)},Object.defineProperty(e,"telemetryEnabled",{get:function(){return n.ServiceRecognizerBase.telemetryDataEnabled},enumerable:!0,configurable:!0}),e.enableTelemetry=function(e){n.ServiceRecognizerBase.telemetryDataEnabled=e},e.prototype.implCommonRecognizerSetup=function(){var e=this,t="undefined"!=typeof window?"Browser":"Node",r="unknown",o="unknown";"undefined"!=typeof navigator&&(t=t+"/"+navigator.platform,r=navigator.userAgent,o=navigator.appVersion);var c=this.createRecognizerConfig(new n.SpeechServiceConfig(new n.Context(new n.OS(t,r,o)))),a=this.privProperties.getProperty(s.PropertyId.SpeechServiceConnection_Key,void 0),u=a&&""!==a?new n.CognitiveSubscriptionKeyAuthentication(a):new n.CognitiveTokenAuthentication((function(t){var r=e.privProperties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token,void 0);return i.PromiseHelper.fromResult(r)}),(function(t){var r=e.privProperties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token,void 0);return i.PromiseHelper.fromResult(r)}));this.privReco=this.createServiceRecognizer(u,this.privConnectionFactory,this.audioConfig,c)},e.prototype.implRecognizerStart=function(e,t,r){this.privReco.recognize(e,t,r).on((function(e){}),(function(e){r&&r("Runtime error: "+e)}))},e.prototype.implRecognizerStop=function(){this.privReco&&this.privReco.stopRecognizing()},e}();t.Recognizer=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),s=r(72),c=r(12),a=r(1),u=function(e){function t(t,r){var n=this,i=t;return c.Contracts.throwIfNull(i,"speechConfig"),c.Contracts.throwIfNullOrWhitespace(i.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage),a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage]),(n=e.call(this,r,i.properties,new s.SpeechConnectionFactory)||this).privDisposedSpeechRecognizer=!1,n}return i(t,e),Object.defineProperty(t.prototype,"endpointId",{get:function(){return c.Contracts.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){c.Contracts.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{get:function(){return c.Contracts.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputFormat",{get:function(){return c.Contracts.throwIfDisposed(this.privDisposedSpeechRecognizer),this.properties.getProperty(o.OutputFormatPropertyName,a.OutputFormat[a.OutputFormat.Simple])===a.OutputFormat[a.OutputFormat.Simple]?a.OutputFormat.Simple:a.OutputFormat.Detailed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),t.prototype.recognizeOnceAsync=function(e,t){var r=this;try{c.Contracts.throwIfDisposed(this.privDisposedSpeechRecognizer),this.implRecognizerStop(),this.implRecognizerStart(o.RecognitionMode.Interactive,(function(t){r.implRecognizerStop(),e&&e(t)}),(function(e){r.implRecognizerStop(),t&&t(e)}))}catch(e){if(t)if(e instanceof Error){var n=e;t(n.name+": "+n.message)}else t(e);this.dispose(!0)}},t.prototype.startContinuousRecognitionAsync=function(e,t){try{if(c.Contracts.throwIfDisposed(this.privDisposedSpeechRecognizer),this.implRecognizerStop(),this.implRecognizerStart(o.RecognitionMode.Conversation,void 0,void 0),e){try{e()}catch(e){t&&t(e)}e=void 0}}catch(e){if(t)if(e instanceof Error){var r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}},t.prototype.stopContinuousRecognitionAsync=function(e,t){try{if(c.Contracts.throwIfDisposed(this.privDisposedSpeechRecognizer),this.implRecognizerStop(),e)try{e()}catch(e){t&&t(e)}}catch(e){if(t)if(e instanceof Error){var r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}},t.prototype.startKeywordRecognitionAsync=function(e,t,r){c.Contracts.throwIfNull(e,"model"),r&&r("Not yet implemented.")},t.prototype.stopKeywordRecognitionAsync=function(e,t){e&&e()},t.prototype.close=function(){c.Contracts.throwIfDisposed(this.privDisposedSpeechRecognizer),this.dispose(!0)},t.prototype.dispose=function(t){this.privDisposedSpeechRecognizer||(t&&(this.implRecognizerStop(),this.privDisposedSpeechRecognizer=!0),e.prototype.dispose.call(this,t))},t.prototype.createRecognizerConfig=function(e){return new o.RecognizerConfig(e,this.properties)},t.prototype.createServiceRecognizer=function(e,t,r,n){var i=r;return new o.SpeechServiceRecognizer(e,t,i,n,this)},t}(a.Recognizer);t.SpeechRecognizer=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e,"TestHooksParamName",{get:function(){return"testhooks"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ConnectionIdHeader",{get:function(){return"X-ConnectionId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DeploymentIdParamName",{get:function(){return"cid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FormatParamName",{get:function(){return"format"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LanguageParamName",{get:function(){return"language"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"TranslationFromParamName",{get:function(){return"from"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"TranslationToParamName",{get:function(){return"to"},enumerable:!0,configurable:!0}),e}();t.QueryParameterNames=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),s=r(12),c=r(1),a=function(e){function t(t,r){var n=this;s.Contracts.throwIfNullOrUndefined(t,"speechConfig");var i=t;return s.Contracts.throwIfNullOrUndefined(i,"speechConfig"),(n=e.call(this,r,i.properties,new o.IntentConnectionFactory)||this).privAddedIntents=[],n.privAddedLmIntents={},n.privDisposedIntentRecognizer=!1,n.privProperties=i.properties,s.Contracts.throwIfNullOrWhitespace(n.properties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage),c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage]),n}return i(t,e),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{get:function(){return s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(c.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){this.properties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),t.prototype.recognizeOnceAsync=function(e,t){var r=this;try{if(s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.implRecognizerStop(),0!==Object.keys(this.privAddedLmIntents).length||void 0!==this.privUmbrellaIntent){var n=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",n.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(n.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}this.implRecognizerStart(o.RecognitionMode.Interactive,(function(t){r.implRecognizerStop(),e&&e(t)}),(function(e){r.implRecognizerStop(),t&&t(e)}))}catch(e){if(t)if(e instanceof Error){var i=e;t(i.name+": "+i.message)}else t(e);this.dispose(!0)}},t.prototype.startContinuousRecognitionAsync=function(e,t){try{if(s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.implRecognizerStop(),0!==Object.keys(this.privAddedLmIntents).length){var r=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",r.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(r.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}if(this.implRecognizerStart(o.RecognitionMode.Conversation,void 0,void 0),e){try{e()}catch(e){t&&t(e)}e=void 0}}catch(e){if(t)if(e instanceof Error){var n=e;t(n.name+": "+n.message)}else t(e);this.dispose(!0)}},t.prototype.stopContinuousRecognitionAsync=function(e,t){try{if(s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.implRecognizerStop(),e)try{e()}catch(e){t&&t(e)}}catch(e){if(t)if(e instanceof Error){var r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}},t.prototype.startKeywordRecognitionAsync=function(e,t,r){s.Contracts.throwIfNull(e,"model"),r&&r("Not yet implemented.")},t.prototype.stopKeywordRecognitionAsync=function(e,t){e&&e()},t.prototype.addIntent=function(e,t){s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),s.Contracts.throwIfNullOrWhitespace(t,"intentId"),s.Contracts.throwIfNullOrWhitespace(e,"simplePhrase"),this.privAddedIntents.push([t,e])},t.prototype.addIntentWithLanguageModel=function(e,t,r){s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),s.Contracts.throwIfNullOrWhitespace(e,"intentId"),s.Contracts.throwIfNull(t,"model");var n=t;s.Contracts.throwIfNullOrWhitespace(n.appId,"model.appId"),this.privAddedLmIntents[e]=new o.AddedLmIntent(n,r)},t.prototype.addAllIntents=function(e,t){s.Contracts.throwIfNull(e,"model");var r=e;s.Contracts.throwIfNullOrWhitespace(r.appId,"model.appId"),this.privUmbrellaIntent=new o.AddedLmIntent(r,t)},t.prototype.close=function(){s.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.dispose(!0)},t.prototype.createRecognizerConfig=function(e){return new o.RecognizerConfig(e,this.properties)},t.prototype.createServiceRecognizer=function(e,t,r,n){var i=r;return new o.IntentServiceRecognizer(e,t,i,n,this)},t.prototype.dispose=function(t){this.privDisposedIntentRecognizer||t&&(this.privDisposedIntentRecognizer=!0,e.prototype.dispose.call(this,t))},t.prototype.buildSpeechContext=function(){var e,t,r,n=[];void 0!==this.privUmbrellaIntent&&(e=this.privUmbrellaIntent.modelImpl.appId,t=this.privUmbrellaIntent.modelImpl.region,r=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(var i=0,o=Object.keys(this.privAddedLmIntents);i<o.length;i++){var s=o[i],a=this.privAddedLmIntents[s];if(void 0===e)e=a.modelImpl.appId;else if(e!==a.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(void 0===t)t=a.modelImpl.region;else if(t!==a.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(void 0===r)r=a.modelImpl.subscriptionKey;else if(r!==a.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");var u="luis/"+e+"-PRODUCTION#"+s;n.push(u)}return{Intent:{id:e,key:void 0===r?this.privProperties.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_Key]):r,provider:"LUIS"},ReferenceGrammars:void 0===this.privUmbrellaIntent?n:["luis/"+e+"-PRODUCTION"]}},t}(c.Recognizer);t.IntentRecognizer=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),s=r(12),c=r(1),a=function(e){function t(t,r){var n=this,i=t;return s.Contracts.throwIfNull(i,"speechConfig"),(n=e.call(this,r,i.properties,new o.TranslationConnectionFactory)||this).privDisposedTranslationRecognizer=!1,n.privProperties=i.properties.clone(),void 0!==n.properties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)&&s.Contracts.throwIfNullOrWhitespace(n.properties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationVoice),c.PropertyId[c.PropertyId.SpeechServiceConnection_TranslationVoice]),s.Contracts.throwIfNullOrWhitespace(n.properties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationToLanguages),c.PropertyId[c.PropertyId.SpeechServiceConnection_TranslationToLanguages]),s.Contracts.throwIfNullOrWhitespace(n.properties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage),c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage]),n}return i(t,e),Object.defineProperty(t.prototype,"speechRecognitionLanguage",{get:function(){return s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetLanguages",{get:function(){return s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"voiceName",{get:function(){return s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorizationToken",{get:function(){return this.properties.getProperty(c.PropertyId.SpeechServiceAuthorization_Token)},set:function(e){this.properties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.privProperties},enumerable:!0,configurable:!0}),t.prototype.recognizeOnceAsync=function(e,t){var r=this;try{s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.implRecognizerStop(),this.implRecognizerStart(o.RecognitionMode.Conversation,(function(t){r.implRecognizerStop(),e&&e(t)}),(function(e){r.implRecognizerStop(),t&&t(e)}))}catch(e){if(t)if(e instanceof Error){var n=e;t(n.name+": "+n.message)}else t(e);this.dispose(!0)}},t.prototype.startContinuousRecognitionAsync=function(e,t){try{if(s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.implRecognizerStop(),this.implRecognizerStart(o.RecognitionMode.Conversation,void 0,void 0),e){try{e()}catch(e){t&&t(e)}e=void 0}}catch(e){if(t)if(e instanceof Error){var r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}},t.prototype.stopContinuousRecognitionAsync=function(e,t){try{if(s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.implRecognizerStop(),e)try{e()}catch(e){t&&t(e)}}catch(e){if(t)if(e instanceof Error){var r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0)}},t.prototype.close=function(){s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.dispose(!0)},t.prototype.dispose=function(t){this.privDisposedTranslationRecognizer||t&&(this.implRecognizerStop(),this.privDisposedTranslationRecognizer=!0,e.prototype.dispose.call(this,t))},t.prototype.createRecognizerConfig=function(e){return new o.RecognizerConfig(e,this.properties)},t.prototype.createServiceRecognizer=function(e,t,r,n){var i=r;return new o.TranslationServiceRecognizer(e,t,i,n,this)},t}(c.Recognizer);t.TranslationRecognizer=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=function(){function e(){this.privMap=new n.PropertyCollection}return e.prototype.get=function(e,t){return this.privMap.getProperty(e,t)},e.prototype.set=function(e,t){this.privMap.setProperty(e,t)},e}();t.Translations=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(t.NoMatchReason||(t.NoMatchReason={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(1),o=function(){function e(e){this.privReason=e}return e.fromResult=function(t){var r=n.SimpleSpeechPhrase.fromJSON(t.json),o=i.NoMatchReason.NotRecognized;switch(r.RecognitionStatus){case n.RecognitionStatus.BabbleTimeout:o=i.NoMatchReason.InitialBabbleTimeout;break;case n.RecognitionStatus.InitialSilenceTimeout:o=i.NoMatchReason.InitialSilenceTimeout;break;default:o=i.NoMatchReason.NotRecognized}return new e(o)},Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),e}();t.NoMatchDetails=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,n,i){this.privCancelReason=t,this.privErrorDetails=r,this.privResult=i,this.privSessionId=e,this.privErrorCode=n}return Object.defineProperty(e.prototype,"result",{get:function(){return this.privResult},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.privCancelReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorCode",{get:function(){return this.privErrorCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),e}();t.TranslationRecognitionCanceledEventArgs=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,n,i,o,s){var c=e.call(this,i,o,s)||this;return c.privReason=t,c.privErrorDetails=r,c.privErrorCode=n,c}return i(t,e),Object.defineProperty(t.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorCode",{get:function(){return this.privErrorCode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),t}(r(1).IntentRecognitionEventArgs);t.IntentRecognitionCanceledEventArgs=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(1),o=function(){function e(e,t,r){this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}return e.fromResult=function(t){var r=i.CancellationReason.Error,o=i.CancellationErrorCode.NoError;if(t.json){var s=n.SimpleSpeechPhrase.fromJSON(t.json);r=n.EnumTranslation.implTranslateCancelResult(s.RecognitionStatus)}return t.properties&&(o=i.CancellationErrorCode[t.properties.getProperty(n.CancellationErrorCodePropertyName,i.CancellationErrorCode[i.CancellationErrorCode.NoError])]),new e(r,t.errorDetails,o)},Object.defineProperty(e.prototype,"reason",{get:function(){return this.privReason},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDetails",{get:function(){return this.privErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ErrorCode",{get:function(){return this.privErrorCode},enumerable:!0,configurable:!0}),e}();t.CancellationDetails=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError"}(t.CancellationErrorCode||(t.CancellationErrorCode={}))},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(r(1).SessionEventArgs);t.ConnectionEventArgs=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=function(){function e(){}return e.fromRecognizer=function(t){var r=t.internalData,i=new e;return i.privServiceRecognizer=r,i.privEventListener=i.privServiceRecognizer.connectionEvents.attach((function(e){"ConnectionEstablishedEvent"===e.name?i.connected&&i.connected(new n.ConnectionEventArgs(e.connectionId)):"ConnectionClosedEvent"===e.name&&i.disconnected&&i.disconnected(new n.ConnectionEventArgs(e.connectionId))})),i},e.prototype.openConnection=function(){this.privServiceRecognizer.connect()},e.prototype.closeConnection=function(){this.privServiceRecognizer.disconnect()},e.prototype.close=function(){},e}();t.Connection=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privGrammerBuilder=e.dynamicGrammar}return e.fromRecognizer=function(t){return new e(t.internalData)},e.prototype.addPhrase=function(e){this.privGrammerBuilder.addPhrase(e)},e.prototype.addPhrases=function(e){this.privGrammerBuilder.addPhrase(e)},e.prototype.clear=function(){this.privGrammerBuilder.clearPhrases()},e}();t.PhraseListGrammar=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22),i=r(4),o=r(1),s=r(2),c=r(169),a=function(){function e(t,r,n,a,u){var p=this;if(this.sendTelemetryData=function(){var t=p.privRequestSession.getTelemetry();if(!0!==e.telemetryDataEnabled||p.privIsDisposed||null===t)return i.PromiseHelper.fromResult(!0);if(e.telemetryData)try{e.telemetryData(t)}catch(e){}return p.fetchConnection().onSuccessContinueWith((function(e){return e.send(new c.SpeechConnectionMessage(i.MessageType.Text,"telemetry",p.privRequestSession.requestId,"application/json",t))}))},this.fetchConnection=function(){return p.configureConnection()},this.receiveMessage=function(e,t){return p.fetchConnection().on((function(r){return r.read().onSuccessContinueWithPromise((function(r){if(p.privIsDisposed||!p.privRequestSession.isRecognizing)return i.PromiseHelper.fromResult(void 0);if(!r)return p.privRequestSession.isRecognizing?p.receiveMessage(e,t):i.PromiseHelper.fromResult(!0);var n=c.SpeechConnectionMessage.fromConnectionMessage(r);if(n.requestId.toLowerCase()===p.privRequestSession.requestId.toLowerCase())switch(n.path.toLowerCase()){case"turn.start":p.privMustReportEndOfStream=!0;break;case"speech.startdetected":var a=s.SpeechDetected.fromJSON(n.textBody),u=new o.RecognitionEventArgs(a.Offset,p.privRequestSession.sessionId);p.privRecognizer.speechStartDetected&&p.privRecognizer.speechStartDetected(p.privRecognizer,u);break;case"speech.enddetected":var h=void 0;h=n.textBody.length>0?n.textBody:"{ Offset: 0 }";var l=s.SpeechDetected.fromJSON(h);p.privRequestSession.onServiceRecognized(l.Offset+p.privRequestSession.currentTurnAudioOffset);var f=new o.RecognitionEventArgs(l.Offset+p.privRequestSession.currentTurnAudioOffset,p.privRequestSession.sessionId);p.privRecognizer.speechEndDetected&&p.privRecognizer.speechEndDetected(p.privRecognizer,f);break;case"turn.end":p.sendTelemetryData(),p.privRequestSession.isSpeechEnded&&p.privMustReportEndOfStream&&(p.privMustReportEndOfStream=!1,p.cancelRecognitionLocal(o.CancellationReason.EndOfStream,o.CancellationErrorCode.NoError,void 0,e));var v=new o.SessionEventArgs(p.privRequestSession.sessionId);if(p.privRequestSession.onServiceTurnEndResponse(p.privRecognizerConfig.isContinuousRecognition),!p.privRecognizerConfig.isContinuousRecognition||p.privRequestSession.isSpeechEnded)return p.privRecognizer.sessionStopped&&p.privRecognizer.sessionStopped(p.privRecognizer,v),i.PromiseHelper.fromResult(!0);p.fetchConnection().onSuccessContinueWith((function(e){p.sendSpeechContext(e)}));default:p.processTypeSpecificMessages(n,e,t)}return p.receiveMessage(e,t)}))}),(function(e){}))},this.sendSpeechServiceConfig=function(t,r,n){if(!0!==e.telemetryDataEnabled){var o={context:{system:JSON.parse(n).context.system}};n=JSON.stringify(o)}return n?(p.privSpeechServiceConfigConnectionId=p.privConnectionId,t.send(new c.SpeechConnectionMessage(i.MessageType.Text,"speech.config",r.requestId,"application/json",n))):i.PromiseHelper.fromResult(!0)},this.sendSpeechContext=function(e){var t=p.speechContext.toJSON();return t?e.send(new c.SpeechConnectionMessage(i.MessageType.Text,"speech.context",p.privRequestSession.requestId,"application/json",t)):i.PromiseHelper.fromResult(!0)},this.sendAudio=function(e){var t=new i.Deferred,r=Date.now(),n=p.privAudioSource.format,o=p.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),s=n.avgBytesPerSec/1e3*parseInt(o,10),a=function(){p.privIsDisposed||p.privRequestSession.isSpeechEnded||!p.privRequestSession.isRecognizing||p.fetchConnection().on((function(o){e.read().on((function(e){var u,h;p.privRequestSession.isSpeechEnded?t.resolve(!0):(e.isEnd?(u=null,h=0):(u=e.buffer,p.privRequestSession.onAudioSent(u.byteLength),h=s>=p.privRequestSession.bytesSent?0:Math.max(0,r-Date.now())),setTimeout((function(){null!==u&&(r=Date.now()+1e3*u.byteLength/(2*n.avgBytesPerSec));var s=o.send(new c.SpeechConnectionMessage(i.MessageType.Binary,"audio",p.privRequestSession.requestId,null,u));e.isEnd?(p.privRequestSession.onSpeechEnded(),t.resolve(!0)):s.continueWith((function(e){a()}))}),h))}),(function(e){p.privRequestSession.isSpeechEnded?t.resolve(!0):t.reject(e)}))}),(function(e){t.reject(e)}))};return a(),t.promise()},!t)throw new i.ArgumentNullError("authentication");if(!r)throw new i.ArgumentNullError("connectionFactory");if(!n)throw new i.ArgumentNullError("audioSource");if(!a)throw new i.ArgumentNullError("recognizerConfig");this.privMustReportEndOfStream=!1,this.privAuthentication=t,this.privConnectionFactory=r,this.privAudioSource=n,this.privRecognizerConfig=a,this.privIsDisposed=!1,this.privRecognizer=u,this.privRequestSession=new s.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new i.EventSource,this.privDynamicGrammar=new s.DynamicGrammarBuilder,this.privSpeechContext=new s.SpeechContext(this.privDynamicGrammar)}return Object.defineProperty(e.prototype,"audioSource",{get:function(){return this.privAudioSource},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speechContext",{get:function(){return this.privSpeechContext},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dynamicGrammar",{get:function(){return this.privDynamicGrammar},enumerable:!0,configurable:!0}),e.prototype.isDisposed=function(){return this.privIsDisposed},e.prototype.dispose=function(e){this.privIsDisposed=!0,this.privConnectionConfigurationPromise&&this.privConnectionConfigurationPromise.onSuccessContinueWith((function(t){t.dispose(e)}))},Object.defineProperty(e.prototype,"connectionEvents",{get:function(){return this.privConnectionEvents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recognitionMode",{get:function(){return this.privRecognizerConfig.recognitionMode},enumerable:!0,configurable:!0}),e.prototype.recognize=function(e,t,r){var s=this;return this.privConnectionConfigurationPromise=null,this.privRecognizerConfig.recognitionMode=e,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events),this.connectImpl(),this.audioSource.attach(this.privRequestSession.audioNodeId).continueWithPromise((function(e){var c;return e.isError?(s.cancelRecognitionLocal(o.CancellationReason.Error,o.CancellationErrorCode.ConnectionFailure,e.error,t),i.PromiseHelper.fromError(e.error)):(c=new n.ReplayableAudioNode(e.result,s.audioSource.format),s.privRequestSession.onAudioSourceAttachCompleted(c,!1),s.audioSource.deviceInfo.onSuccessContinueWithPromise((function(e){return s.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:e},s.configureConnection().on((function(e){var n=new o.SessionEventArgs(s.privRequestSession.sessionId);s.privRecognizer.sessionStarted&&s.privRecognizer.sessionStarted(s.privRecognizer,n);var a=s.receiveMessage(t,r),u=s.sendAudio(c);return u.on((function(e){}),(function(e){s.cancelRecognitionLocal(o.CancellationReason.Error,o.CancellationErrorCode.RuntimeError,e,t)})),i.PromiseHelper.whenAll([a,u]).on((function(e){return!0}),(function(e){s.cancelRecognitionLocal(o.CancellationReason.Error,o.CancellationErrorCode.RuntimeError,e,t)}))}),(function(e){s.cancelRecognitionLocal(o.CancellationReason.Error,o.CancellationErrorCode.ConnectionFailure,e,t)})).continueWithPromise((function(e){return e.isError?i.PromiseHelper.fromError(e.error):i.PromiseHelper.fromResult(!0)}))})))}))},e.prototype.stopRecognizing=function(){this.privRequestSession.isRecognizing&&(this.privRequestSession.onStopRecognizing(),this.sendTelemetryData(),this.audioSource.turnOff(),this.sendFinalAudio(),this.privRequestSession.dispose())},e.prototype.connect=function(){this.connectImpl().result()},e.prototype.disconnect=function(){this.cancelRecognitionLocal(o.CancellationReason.Error,o.CancellationErrorCode.NoError,"Disconnecting",void 0),this.privConnectionPromise.result().isCompleted?this.privConnectionPromise.result().isError||(this.privConnectionPromise.result().result.dispose(),this.privConnectionPromise=null):this.privConnectionPromise.onSuccessContinueWith((function(e){e.dispose()}))},e.prototype.cancelRecognitionLocal=function(e,t,r,n){this.privRequestSession.isRecognizing&&(this.privRequestSession.onStopRecognizing(),this.sendTelemetryData(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,t,r,n))},e.prototype.connectImpl=function(e){var t=this;if(void 0===e&&(e=!1),this.privConnectionPromise)return this.privConnectionPromise.result().isCompleted&&(this.privConnectionPromise.result().isError||this.privConnectionPromise.result().result.state()===i.ConnectionState.Disconnected)?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise;this.privAuthFetchEventId=i.createNoDashGuid(),this.privConnectionId=i.createNoDashGuid(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);var r=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=r.continueWithPromise((function(r){if(r.isError)throw t.privRequestSession.onAuthCompleted(!0,r.error),new Error(r.error);t.privRequestSession.onAuthCompleted(!1);var n=t.privConnectionFactory.create(t.privRecognizerConfig,r.result,t.privConnectionId);return t.privRequestSession.listenForServiceTelemetry(n.events),n.events.attach((function(e){t.connectionEvents.onEvent(e)})),n.open().onSuccessContinueWithPromise((function(r){return 200===r.statusCode?(t.privRequestSession.onPreConnectionStart(t.privAuthFetchEventId,t.privConnectionId),t.privRequestSession.onConnectionEstablishCompleted(r.statusCode),i.PromiseHelper.fromResult(n)):403!==r.statusCode||e?(t.privRequestSession.onConnectionEstablishCompleted(r.statusCode,r.reason),i.PromiseHelper.fromError("Unable to contact server. StatusCode: "+r.statusCode+", "+t.privRecognizerConfig.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Endpoint)+" Reason: "+r.reason)):t.connectImpl(!0)}))})),this.privConnectionPromise},e.prototype.configureConnection=function(){var e=this;return this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.result().isCompleted&&(this.privConnectionConfigurationPromise.result().isError||this.privConnectionConfigurationPromise.result().result.state()===i.ConnectionState.Disconnected)?(this.privConnectionConfigurationPromise=null,this.configureConnection()):this.privConnectionConfigurationPromise:(this.privConnectionConfigurationPromise=this.connectImpl().onSuccessContinueWithPromise((function(t){return e.sendSpeechServiceConfig(t,e.privRequestSession,e.privRecognizerConfig.SpeechServiceConfig.serialize()).onSuccessContinueWithPromise((function(r){return e.sendSpeechContext(t).onSuccessContinueWith((function(e){return t}))}))})),this.privConnectionConfigurationPromise)},e.prototype.sendFinalAudio=function(){var e=this,t=new i.Deferred;return this.fetchConnection().on((function(r){r.send(new c.SpeechConnectionMessage(i.MessageType.Binary,"audio",e.privRequestSession.requestId,null,null)).on((function(e){t.resolve(!0)}),(function(e){t.reject(e)}))}),(function(e){t.reject(e)})),t.promise()},e.telemetryDataEnabled=!0,e}();t.ServiceRecognizerBase=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(4),s="path",c="content-type",a="x-requestid",u="x-timestamp",p=function(e){function t(t,r,n,i,p,h,l){var f=this;if(!r)throw new o.ArgumentNullError("path");if(!n)throw new o.ArgumentNullError("requestId");var v={};if(v[s]=r,v[a]=n,v[u]=(new Date).toISOString(),i&&(v[c]=i),h)for(var d in h)d&&(v[d]=h[d]);return(f=l?e.call(this,t,p,v,l)||this:e.call(this,t,p,v)||this).privPath=r,f.privRequestId=n,f.privContentType=i,f.privAdditionalHeaders=h,f}return i(t,e),Object.defineProperty(t.prototype,"path",{get:function(){return this.privPath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return this.privContentType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"additionalHeaders",{get:function(){return this.privAdditionalHeaders},enumerable:!0,configurable:!0}),t.fromConnectionMessage=function(e){var r=null,n=null,i=null,o={};if(e.headers)for(var p in e.headers)p&&(p.toLowerCase()===s.toLowerCase()?r=e.headers[p]:p.toLowerCase()===a.toLowerCase()?n=e.headers[p]:p.toLowerCase()===u.toLowerCase()?e.headers[p]:p.toLowerCase()===c.toLowerCase()?i=e.headers[p]:o[p]=e.headers[p]);return new t(e.messageType,r,n,i,e.body,o,e.id)},t}(o.ConnectionMessage);t.SpeechConnectionMessage=p},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Interactive=0]="Interactive",e[e.Conversation=1]="Conversation",e[e.Dictation=2]="Dictation"}(n=t.RecognitionMode||(t.RecognitionMode={})),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(t.SpeechResultFormat||(t.SpeechResultFormat={}));var i=function(){function e(e,t){this.privRecognitionMode=n.Interactive,this.privSpeechServiceConfig=e||new o(new s(null)),this.privParameters=t}return Object.defineProperty(e.prototype,"parameters",{get:function(){return this.privParameters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recognitionMode",{get:function(){return this.privRecognitionMode},set:function(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===n.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=n[e]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SpeechServiceConfig",{get:function(){return this.privSpeechServiceConfig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recognitionActivityTimeout",{get:function(){return this.privRecognitionActivityTimeout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isContinuousRecognition",{get:function(){return this.privRecognitionMode!==n.Interactive},enumerable:!0,configurable:!0}),e}();t.RecognizerConfig=i;var o=function(){function e(e){var t=this;this.serialize=function(){return JSON.stringify(t,(function(e,t){if(t&&"object"==typeof t){var r={};for(var n in t)Object.hasOwnProperty.call(t,n)&&(r[n&&n.charAt(0).toLowerCase()+n.substring(1)]=t[n]);return r}return t}))},this.context=e}return Object.defineProperty(e.prototype,"Context",{get:function(){return this.context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Recognition",{get:function(){return this.recognition},set:function(e){this.recognition=e.toLowerCase()},enumerable:!0,configurable:!0}),e}();t.SpeechServiceConfig=o;var s=function(e){this.system=new c,this.os=e};t.Context=s;var c=function(){this.name="SpeechSDK",this.version="1.6.0",this.build="JavaScript",this.lang="JavaScript"};t.System=c;var a=function(e,t,r){this.platform=e,this.name=t,this.version=r};t.OS=a;var u=function(e,t,r){this.manufacturer=e,this.model=t,this.version=r};t.Device=u,function(e){e.Bluetooth="Bluetooth",e.Wired="Wired",e.WiFi="WiFi",e.Cellular="Cellular",e.InBuilt="InBuilt",e.Unknown="Unknown"}(t.connectivity||(t.connectivity={})),function(e){e.Phone="Phone",e.Speaker="Speaker",e.Car="Car",e.Headset="Headset",e.Thermostat="Thermostat",e.Microphones="Microphones",e.Deskphone="Deskphone",e.RemoteControl="RemoteControl",e.Unknown="Unknown",e.File="File",e.Stream="Stream"}(t.type||(t.type={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i="\r\n",o=function(){var e=this;this.toConnectionMessage=function(t){var r=new n.Deferred;try{if(t.messageType===n.MessageType.Text){var i=t.textContent,o={},s=null;if(i){var c=i.split("\r\n\r\n");c&&c.length>0&&(o=e.parseHeaders(c[0]),c.length>1&&(s=c[1]))}r.resolve(new n.ConnectionMessage(t.messageType,s,o,t.id))}else if(t.messageType===n.MessageType.Binary){var a=t.binaryContent;if(o={},s=null,!a||a.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");var u=new DataView(a),p=u.getInt16(0);if(a.byteLength<p+2)throw new Error("Invalid binary message format. Header content missing.");for(var h="",l=0;l<p;l++)h+=String.fromCharCode(u.getInt8(l+2));o=e.parseHeaders(h),a.byteLength>p+2&&(s=a.slice(2+p)),r.resolve(new n.ConnectionMessage(t.messageType,s,o,t.id))}}catch(e){r.reject("Error formatting the message. Error: "+e)}return r.promise()},this.fromConnectionMessage=function(t){var r=new n.Deferred;try{if(t.messageType===n.MessageType.Text){var o=""+e.makeHeaders(t)+i+(t.textBody?t.textBody:"");r.resolve(new n.RawWebsocketMessage(n.MessageType.Text,o,t.id))}else if(t.messageType===n.MessageType.Binary){var s=e.makeHeaders(t),c=t.binaryBody,a=new Int8Array(e.stringToArrayBuffer(s)),u=(o=new ArrayBuffer(2+a.byteLength+(c?c.byteLength:0)),new DataView(o));u.setInt16(0,a.length);for(var p=0;p<a.byteLength;p++)u.setInt8(2+p,a[p]);if(c){var h=new Int8Array(c);for(p=0;p<h.byteLength;p++)u.setInt8(2+a.byteLength+p,h[p])}r.resolve(new n.RawWebsocketMessage(n.MessageType.Binary,o,t.id))}}catch(e){r.reject("Error formatting the message. "+e)}return r.promise()},this.makeHeaders=function(e){var t="";if(e.headers)for(var r in e.headers)r&&(t+=r+": "+e.headers[r]+i);return t},this.parseHeaders=function(e){var t={};if(e){var r=e.match(/[^\r\n]+/g);if(t)for(var n=0,i=r;n<i.length;n++){var o=i[n];if(o){var s=o.indexOf(":"),c=s>0?o.substr(0,s).trim().toLowerCase():o,a=s>0&&o.length>s+1?o.substr(s+1).trim():"";t[c]=a}}}return t},this.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new DataView(t),n=0;n<e.length;n++)r.setUint8(n,e.charCodeAt(n));return t}};t.WebsocketMessageFormatter=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22),i=r(1),o=r(2),s="X-ConnectionId",c=function(){this.create=function(e,t,r){var c=e.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint,void 0);c||(c="wss://"+e.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region,void 0)+".s2s.speech.microsoft.com/speech/translation/cognitiveservices/v1");var a={from:e.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage),to:e.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages)};void 0!==e.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)&&(a.voice=e.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice),a.features="texttospeech");var u={};return u[t.headerName]=t.token,u[s]=r,new n.WebsocketConnection(c,a,u,new o.WebsocketMessageFormatter,n.ProxyInfo.fromRecognizerConfig(e),r)}};t.TranslationConnectionFactory=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(2),o=function(){function e(){}return e.implTranslateRecognitionResult=function(e){var t=n.ResultReason.Canceled;switch(e){case i.RecognitionStatus.Success:t=n.ResultReason.RecognizedSpeech;break;case i.RecognitionStatus.NoMatch:case i.RecognitionStatus.InitialSilenceTimeout:case i.RecognitionStatus.BabbleTimeout:case i.RecognitionStatus.EndOfDictation:t=n.ResultReason.NoMatch;break;case i.RecognitionStatus.Error:default:t=n.ResultReason.Canceled}return t},e.implTranslateCancelResult=function(e){var t=n.CancellationReason.EndOfStream;switch(e){case i.RecognitionStatus.Success:case i.RecognitionStatus.EndOfDictation:case i.RecognitionStatus.NoMatch:t=n.CancellationReason.EndOfStream;break;case i.RecognitionStatus.InitialSilenceTimeout:case i.RecognitionStatus.BabbleTimeout:case i.RecognitionStatus.Error:default:t=n.CancellationReason.Error}return t},e}();t.EnumTranslation=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"}(t.SynthesisStatus||(t.SynthesisStatus={})),function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation"}(t.RecognitionStatus||(t.RecognitionStatus={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=function(){function e(e){this.privSynthesisEnd=JSON.parse(e),this.privSynthesisEnd.SynthesisStatus=n.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"SynthesisStatus",{get:function(){return this.privSynthesisEnd.SynthesisStatus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FailureReason",{get:function(){return this.privSynthesisEnd.FailureReason},enumerable:!0,configurable:!0}),e}();t.TranslationSynthesisEnd=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(44),i=function(){function e(e){this.privTranslationHypothesis=JSON.parse(e),this.privTranslationHypothesis.Translation.TranslationStatus=n.TranslationStatus[this.privTranslationHypothesis.Translation.TranslationStatus]}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privTranslationHypothesis.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privTranslationHypothesis.Offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){return this.privTranslationHypothesis.Text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Translation",{get:function(){return this.privTranslationHypothesis.Translation},enumerable:!0,configurable:!0}),e}();t.TranslationHypothesis=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(44),o=function(){function e(e){this.privTranslationPhrase=JSON.parse(e),this.privTranslationPhrase.RecognitionStatus=n.RecognitionStatus[this.privTranslationPhrase.RecognitionStatus],void 0!==this.privTranslationPhrase.Translation&&(this.privTranslationPhrase.Translation.TranslationStatus=i.TranslationStatus[this.privTranslationPhrase.Translation.TranslationStatus])}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"RecognitionStatus",{get:function(){return this.privTranslationPhrase.RecognitionStatus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privTranslationPhrase.Offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privTranslationPhrase.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){return this.privTranslationPhrase.Text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Translation",{get:function(){return this.privTranslationPhrase.Translation},enumerable:!0,configurable:!0}),e}();t.TranslationPhrase=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(4),s=r(1),c=r(2),a=function(e){function t(t,r,n,i,o){var s=e.call(this,t,r,n,i,o)||this;return s.privTranslationRecognizer=o,s}return i(t,e),t.prototype.processTypeSpecificMessages=function(e,t,r){var n=new s.PropertyCollection;switch(e.messageType===o.MessageType.Text&&n.setProperty(s.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"translation.hypothesis":var i=this.fireEventForResult(c.TranslationHypothesis.fromJSON(e.textBody),n);if(this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+i.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,i)}catch(e){}break;case"translation.phrase":var a=c.TranslationPhrase.fromJSON(e.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+a.Offset+a.Duration),a.RecognitionStatus===c.RecognitionStatus.Success){var u=this.fireEventForResult(a,n);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,u)}catch(e){}if(t){try{t(u.result)}catch(e){r&&r(e)}t=void 0,r=void 0}break}var p=c.EnumTranslation.implTranslateRecognitionResult(a.RecognitionStatus),h=new s.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,p,a.Text,a.Duration,this.privRequestSession.currentTurnAudioOffset+a.Offset,void 0,e.textBody,n);if(p===s.ResultReason.Canceled){var l=c.EnumTranslation.implTranslateCancelResult(a.RecognitionStatus),f=new s.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,l,null,l===s.CancellationReason.Error?s.CancellationErrorCode.ServiceError:s.CancellationErrorCode.NoError,h);if(this.privTranslationRecognizer.canceled)try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,f)}catch(e){}}else if(!this.privRequestSession.isSpeechEnded||p!==s.ResultReason.NoMatch||a.RecognitionStatus===c.RecognitionStatus.InitialSilenceTimeout){f=new s.TranslationRecognitionEventArgs(h,h.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,f)}catch(e){}}if(t){try{t(h)}catch(e){r&&r(e)}t=void 0,r=void 0}break;case"translation.synthesis":this.sendSynthesisAudio(e.binaryBody,this.privRequestSession.sessionId);break;case"translation.synthesis.end":var v=c.TranslationSynthesisEnd.fromJSON(e.textBody);switch(v.SynthesisStatus){case c.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){var d=new s.TranslationSynthesisResult(s.ResultReason.Canceled,void 0),g=new s.TranslationSynthesisEventArgs(d,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,g)}catch(e){}}if(this.privTranslationRecognizer.canceled){var y=new s.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,s.CancellationReason.Error,v.FailureReason,s.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,y)}catch(e){}}break;case c.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId)}}},t.prototype.cancelRecognition=function(e,t,r,n,i,o){if(this.privTranslationRecognizer.canceled){var a=new s.PropertyCollection;a.setProperty(c.CancellationErrorCodePropertyName,s.CancellationErrorCode[n]);var u=new s.TranslationRecognitionCanceledEventArgs(e,r,i,n,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,u)}catch(e){}if(o){var p=new s.TranslationRecognitionResult(void 0,t,s.ResultReason.Canceled,void 0,void 0,void 0,i,void 0,a);try{o(p)}catch(e){}}}},t.prototype.fireEventForResult=function(e,t){var r,n;if(void 0!==e.Translation.Translations){r=new s.Translations;for(var i=0,a=e.Translation.Translations;i<a.length;i++){var u=a[i];r.set(u.Language,u.Text)}}n=e instanceof c.TranslationPhrase?e.Translation.TranslationStatus===o.TranslationStatus.Success?s.ResultReason.TranslatedSpeech:s.ResultReason.RecognizedSpeech:s.ResultReason.TranslatingSpeech;var p=e.Offset+this.privRequestSession.currentTurnAudioOffset,h=new s.TranslationRecognitionResult(r,this.privRequestSession.requestId,n,e.Text,e.Duration,p,e.Translation.FailureReason,JSON.stringify(e),t);return new s.TranslationRecognitionEventArgs(h,p,this.privRequestSession.sessionId)},t.prototype.sendSynthesisAudio=function(e,t){var r=void 0===e?s.ResultReason.SynthesizingAudioCompleted:s.ResultReason.SynthesizingAudio,n=new s.TranslationSynthesisResult(r,e),i=new s.TranslationSynthesisEventArgs(n,t);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,i)}catch(e){}},t}(c.ServiceRecognizerBase);t.TranslationServiceRecognizer=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privSpeechStartDetected=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privSpeechStartDetected.Offset},enumerable:!0,configurable:!0}),e}();t.SpeechDetected=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privSpeechHypothesis=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"Text",{get:function(){return this.privSpeechHypothesis.Text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privSpeechHypothesis.Offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privSpeechHypothesis.Duration},enumerable:!0,configurable:!0}),e}();t.SpeechHypothesis=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),s=r(2),c=function(e){function t(t,r,n,i,o){var s=e.call(this,t,r,n,i,o)||this;return s.privSpeechRecognizer=o,s}return i(t,e),t.prototype.processTypeSpecificMessages=function(e,t,r){var n,i=new o.PropertyCollection;switch(i.setProperty(o.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":var c=s.SpeechHypothesis.fromJSON(e.textBody),a=c.Offset+this.privRequestSession.currentTurnAudioOffset;n=new o.SpeechRecognitionResult(this.privRequestSession.requestId,o.ResultReason.RecognizingSpeech,c.Text,c.Duration,a,void 0,e.textBody,i),this.privRequestSession.onHypothesis(a);var u=new o.SpeechRecognitionEventArgs(n,c.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,u)}catch(e){}break;case"speech.phrase":var p=s.SimpleSpeechPhrase.fromJSON(e.textBody),h=s.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+p.Offset+p.Duration),o.ResultReason.Canceled===h){var l=s.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus);if(n=new o.SpeechRecognitionResult(this.privRequestSession.requestId,h,void 0,void 0,void 0,void 0,e.textBody,i),this.privSpeechRecognizer.canceled){var f=new o.SpeechRecognitionCanceledEventArgs(l,void 0,l===o.CancellationReason.Error?o.CancellationErrorCode.ServiceError:o.CancellationErrorCode.NoError,void 0,this.privRequestSession.sessionId);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,f)}catch(e){}}}else if(!this.privRequestSession.isSpeechEnded||h!==o.ResultReason.NoMatch||p.RecognitionStatus===s.RecognitionStatus.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(s.OutputFormatPropertyName)===o.OutputFormat[o.OutputFormat.Simple])n=new o.SpeechRecognitionResult(this.privRequestSession.requestId,h,p.DisplayText,p.Duration,p.Offset+this.privRequestSession.currentTurnAudioOffset,void 0,e.textBody,i);else{var v=s.DetailedSpeechPhrase.fromJSON(e.textBody);n=new o.SpeechRecognitionResult(this.privRequestSession.requestId,h,v.RecognitionStatus===s.RecognitionStatus.Success?v.NBest[0].Display:void 0,v.Duration,v.Offset+this.privRequestSession.currentTurnAudioOffset,void 0,e.textBody,i)}var d=new o.SpeechRecognitionEventArgs(n,n.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,d)}catch(e){}}if(t){try{t(n)}catch(e){r&&r(e)}t=void 0,r=void 0}}},t.prototype.cancelRecognition=function(e,t,r,n,i,c){var a=new o.PropertyCollection;if(a.setProperty(s.CancellationErrorCodePropertyName,o.CancellationErrorCode[n]),this.privSpeechRecognizer.canceled){var u=new o.SpeechRecognitionCanceledEventArgs(r,i,n,void 0,e);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,u)}catch(e){}}if(c){var p=new o.SpeechRecognitionResult(t,o.ResultReason.Canceled,void 0,void 0,void 0,i,void 0,a);try{c(p)}catch(e){}}},t}(s.ServiceRecognizerBase);t.SpeechServiceRecognizer=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=function(){function e(e){this.privDetailedSpeechPhrase=JSON.parse(e),this.privDetailedSpeechPhrase.RecognitionStatus=n.RecognitionStatus[this.privDetailedSpeechPhrase.RecognitionStatus]}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"RecognitionStatus",{get:function(){return this.privDetailedSpeechPhrase.RecognitionStatus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NBest",{get:function(){return this.privDetailedSpeechPhrase.NBest},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privDetailedSpeechPhrase.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privDetailedSpeechPhrase.Offset},enumerable:!0,configurable:!0}),e}();t.DetailedSpeechPhrase=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=function(){function e(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=n.RecognitionStatus[this.privSimpleSpeechPhrase.RecognitionStatus]}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"RecognitionStatus",{get:function(){return this.privSimpleSpeechPhrase.RecognitionStatus},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DisplayText",{get:function(){return this.privSimpleSpeechPhrase.DisplayText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){return this.privSimpleSpeechPhrase.Offset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.privSimpleSpeechPhrase.Duration},enumerable:!0,configurable:!0}),e}();t.SimpleSpeechPhrase=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){this.modelImpl=e,this.intentName=t};t.AddedLmIntent=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(4),s=r(1),c=r(2),a=function(e){function t(t,r,n,i,o){var s=e.call(this,t,r,n,i,o)||this;return s.privIntentRecognizer=o,s.privIntentDataSent=!1,s}return i(t,e),t.prototype.setIntents=function(e,t){this.privAddedLmIntents=e,this.privUmbrellaIntent=t,this.privIntentDataSent=!0},t.prototype.processTypeSpecificMessages=function(e,t,r){var n,i,a=this,u=new s.PropertyCollection;switch(e.messageType===o.MessageType.Text&&u.setProperty(s.PropertyId.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":var p=c.SpeechHypothesis.fromJSON(e.textBody);if(n=new s.IntentRecognitionResult(void 0,this.privRequestSession.requestId,s.ResultReason.RecognizingIntent,p.Text,p.Duration,p.Offset+this.privRequestSession.currentTurnAudioOffset,void 0,e.textBody,u),this.privRequestSession.onHypothesis(n.offset),i=new s.IntentRecognitionEventArgs(n,p.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,i)}catch(e){}break;case"speech.phrase":var h=c.SimpleSpeechPhrase.fromJSON(e.textBody);n=new s.IntentRecognitionResult(void 0,this.privRequestSession.requestId,c.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus),h.DisplayText,h.Duration,h.Offset+this.privRequestSession.currentTurnAudioOffset,void 0,e.textBody,u),i=new s.IntentRecognitionEventArgs(n,n.offset,this.privRequestSession.sessionId);!1===this.privIntentDataSent||s.ResultReason.NoMatch===i.result.reason?(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),function(){if(a.privIntentRecognizer.recognized)try{a.privIntentRecognizer.recognized(a.privIntentRecognizer,i)}catch(e){}if(t){try{t(n)}catch(e){r&&r(e)}t=void 0,r=void 0}}()):this.privPendingIntentArgs=i;break;case"response":if(i=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,void 0===i){if(""===e.textBody)return;i=new s.IntentRecognitionEventArgs(new s.IntentRecognitionResult,0,this.privRequestSession.sessionId)}var l=c.IntentResponse.fromJSON(e.textBody),f=this.privAddedLmIntents[l.topScoringIntent.intent];if(void 0!==this.privUmbrellaIntent&&(f=this.privUmbrellaIntent),null!==l&&void 0!==f){var v=void 0===f.intentName?l.topScoringIntent.intent:f.intentName,d=i.result.reason;void 0!==v&&(d=s.ResultReason.RecognizedIntent);var g=void 0!==i.result.properties?i.result.properties:new s.PropertyCollection;g.setProperty(s.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,e.textBody),i=new s.IntentRecognitionEventArgs(new s.IntentRecognitionResult(v,i.result.resultId,d,i.result.text,i.result.duration,i.result.offset,i.result.errorDetails,i.result.json,g),i.offset,i.sessionId)}if(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,i)}catch(e){}if(t){try{t(i.result)}catch(e){r&&r(e)}t=void 0,r=void 0}}},t.prototype.cancelRecognition=function(e,t,r,n,i,o){if(this.privIntentRecognizer.canceled){var a=new s.PropertyCollection;a.setProperty(c.CancellationErrorCodePropertyName,s.CancellationErrorCode[n]);var u=new s.IntentRecognitionCanceledEventArgs(r,i,n,void 0,void 0,e);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,u)}catch(e){}if(o){var p=new s.IntentRecognitionResult(void 0,t,s.ResultReason.Canceled,void 0,void 0,void 0,i,void 0,a);try{o(p)}catch(e){}}}},t}(c.ServiceRecognizerBase);t.IntentServiceRecognizer=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privIntentResponse=JSON.parse(e)}return e.fromJSON=function(t){return new e(t)},Object.defineProperty(e.prototype,"query",{get:function(){return this.privIntentResponse.query},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topScoringIntent",{get:function(){return this.privIntentResponse.topScoringIntent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entities",{get:function(){return this.privIntentResponse.entities},enumerable:!0,configurable:!0}),e}();t.IntentResponse=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(46),o=r(188),s=function(){function e(e){var t=this;this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.onAudioSourceAttachCompleted=function(e,r,n){t.privAudioNode=e,r?t.onComplete():t.onEvent(new i.ListeningStartedEvent(t.privRequestId,t.privSessionId,t.privAudioSourceId,t.privAudioNodeId))},this.onPreConnectionStart=function(e,r){t.privAuthFetchEventId=e,t.privSessionId=r,t.onEvent(new i.ConnectingToServiceEvent(t.privRequestId,t.privAuthFetchEventId,t.privSessionId))},this.onAuthCompleted=function(e,r){e&&t.onComplete()},this.onConnectionEstablishCompleted=function(e,r){if(200===e)return t.onEvent(new i.RecognitionStartedEvent(t.requestId,t.privAudioSourceId,t.privAudioNodeId,t.privAuthFetchEventId,t.privSessionId)),t.privAudioNode&&t.privAudioNode.replay(),t.privTurnStartAudioOffset=t.privLastRecoOffset,void(t.privBytesSent=0);403===e&&t.onComplete()},this.onServiceTurnEndResponse=function(e){!e||t.isSpeechEnded?t.onComplete():(t.privTurnStartAudioOffset=t.privLastRecoOffset,t.privRequestId=n.createNoDashGuid(),t.privAudioNode.replay())},this.dispose=function(e){if(!t.privIsDisposed){t.privIsDisposed=!0;for(var r=0,n=t.privDetachables;r<n.length;r++){n[r].detach()}t.privServiceTelemetryListener.dispose()}},this.getTelemetry=function(){return t.privServiceTelemetryListener.hasTelemetry?t.privServiceTelemetryListener.getTelemetry():null},this.onEvent=function(e){t.privServiceTelemetryListener&&t.privServiceTelemetryListener.onEvent(e),n.Events.instance.onEvent(e)},this.onComplete=function(){t.privIsRecognizing&&(t.privIsRecognizing=!1,t.detachAudioNode())},this.detachAudioNode=function(){t.privIsAudioNodeDetached||(t.privIsAudioNodeDetached=!0,t.privAudioNode&&t.privAudioNode.detach())},this.privAudioSourceId=e,this.privRequestId=n.createNoDashGuid(),this.privAudioNodeId=n.createNoDashGuid(),this.privRequestCompletionDeferral=new n.Deferred}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.privSessionId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestId",{get:function(){return this.privRequestId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioNodeId",{get:function(){return this.privAudioNodeId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"completionPromise",{get:function(){return this.privRequestCompletionDeferral.promise()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSpeechEnded",{get:function(){return this.privIsSpeechEnded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRecognizing",{get:function(){return this.privIsRecognizing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTurnAudioOffset",{get:function(){return this.privTurnStartAudioOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesSent",{get:function(){return this.privBytesSent},enumerable:!0,configurable:!0}),e.prototype.listenForServiceTelemetry=function(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))},e.prototype.startNewRecognition=function(){this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRequestId=n.createNoDashGuid(),this.privServiceTelemetryListener=new o.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new i.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))},e.prototype.onHypothesis=function(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))},e.prototype.onPhraseRecognized=function(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)},e.prototype.onServiceRecognized=function(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e)},e.prototype.onAudioSent=function(e){this.privBytesSent+=e},e.prototype.onStopRecognizing=function(){this.privIsRecognizing=!1},e.prototype.onSpeechEnded=function(){this.privIsSpeechEnded=!0},e}();t.RequestSession=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(46),o=function(){function e(e,t,r){var o=this;this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.onEvent=function(e){o.privIsDisposed||(e instanceof i.RecognitionTriggeredEvent&&e.requestId===o.privRequestId&&(o.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof n.AudioStreamNodeAttachingEvent&&e.audioSourceId===o.privAudioSourceId&&e.audioNodeId===o.privAudioNodeId&&(o.privMicStartTime=e.eventTime),e instanceof n.AudioStreamNodeAttachedEvent&&e.audioSourceId===o.privAudioSourceId&&e.audioNodeId===o.privAudioNodeId&&(o.privMicStartTime=e.eventTime),e instanceof n.AudioSourceErrorEvent&&e.audioSourceId===o.privAudioSourceId&&(o.privMicMetric||(o.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:o.privMicStartTime})),e instanceof n.AudioStreamNodeErrorEvent&&e.audioSourceId===o.privAudioSourceId&&e.audioNodeId===o.privAudioNodeId&&(o.privMicMetric||(o.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:o.privMicStartTime})),e instanceof n.AudioStreamNodeDetachedEvent&&e.audioSourceId===o.privAudioSourceId&&e.audioNodeId===o.privAudioNodeId&&(o.privMicMetric||(o.privMicMetric={End:e.eventTime,Name:"Microphone",Start:o.privMicStartTime})),e instanceof i.ConnectingToServiceEvent&&e.requestId===o.privRequestId&&(o.privConnectionId=e.sessionId),e instanceof n.ConnectionStartEvent&&e.connectionId===o.privConnectionId&&(o.privConnectionStartTime=e.eventTime),e instanceof n.ConnectionEstablishedEvent&&e.connectionId===o.privConnectionId&&(o.privConnectionEstablishMetric||(o.privConnectionEstablishMetric={End:e.eventTime,Id:o.privConnectionId,Name:"Connection",Start:o.privConnectionStartTime})),e instanceof n.ConnectionEstablishErrorEvent&&e.connectionId===o.privConnectionId&&(o.privConnectionEstablishMetric||(o.privConnectionEstablishMetric={End:e.eventTime,Error:o.getConnectionError(e.statusCode),Id:o.privConnectionId,Name:"Connection",Start:o.privConnectionStartTime})),e instanceof n.ConnectionMessageReceivedEvent&&e.connectionId===o.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path&&(o.privReceivedMessages[e.message.headers.path]||(o.privReceivedMessages[e.message.headers.path]=new Array),o.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)))},this.getTelemetry=function(){var e=new Array;o.privListeningTriggerMetric&&e.push(o.privListeningTriggerMetric),o.privMicMetric&&e.push(o.privMicMetric),o.privConnectionEstablishMetric&&e.push(o.privConnectionEstablishMetric),o.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:o.privPhraseLatencies}),o.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:o.privHypothesisLatencies});var t={Metrics:e,ReceivedMessages:o.privReceivedMessages},r=JSON.stringify(t);return o.privReceivedMessages={},o.privListeningTriggerMetric=null,o.privMicMetric=null,o.privConnectionEstablishMetric=null,o.privPhraseLatencies=[],o.privHypothesisLatencies=[],r},this.dispose=function(){o.privIsDisposed=!0},this.getConnectionError=function(e){switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}},this.privRequestId=e,this.privAudioSourceId=t,this.privAudioNodeId=r,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}return e.prototype.phraseReceived=function(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)},e.prototype.hypothesisReceived=function(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)},Object.defineProperty(e.prototype,"hasTelemetry",{get:function(){return 0!==Object.keys(this.privReceivedMessages).length||null!==this.privListeningTriggerMetric||null!==this.privMicMetric||null!==this.privConnectionEstablishMetric||0!==this.privPhraseLatencies.length||0!==this.privHypothesisLatencies.length},enumerable:!0,configurable:!0}),e}();t.ServiceTelemetryListener=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.privContext={},this.privDynamicGrammar=e}return e.prototype.setSection=function(e,t){this.privContext[e]=t},e.prototype.toJSON=function(){var e=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",e),JSON.stringify(this.privContext)},e}();t.SpeechContext=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.addPhrase=function(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)},e.prototype.clearPhrases=function(){this.privPhrases=void 0},e.prototype.addReferenceGrammar=function(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)},e.prototype.clearGrammars=function(){this.privGrammars=void 0},e.prototype.generateGrammarObject=function(){if(void 0!==this.privGrammars||void 0!==this.privPhrases){var e={};if(e.ReferenceGrammars=this.privGrammars,void 0!==this.privPhrases&&0!==this.privPhrases.length){var t=[];this.privPhrases.forEach((function(e,r,n){t.push({Text:e})})),e.Groups=[{Type:"Generic",Items:t}]}return e}},e}();t.DynamicGrammarBuilder=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(31),i=r(2),o=r(4),s=function(){function e(t,r){var n=this;this.privStreams={},this.turnOn=function(){if("undefined"==typeof FileReader){var t="Browser does not support FileReader.";return n.onEvent(new o.AudioSourceErrorEvent(t,"")),o.PromiseHelper.fromError(t)}if(n.privFile.name.lastIndexOf(".wav")!==n.privFile.name.length-4){t=n.privFile.name+" is not supported. Only WAVE files are allowed at the moment.";return n.onEvent(new o.AudioSourceErrorEvent(t,"")),o.PromiseHelper.fromError(t)}if(n.privFile.size>e.MAX_SIZE){t=n.privFile.name+" exceeds the maximum allowed file size ("+e.MAX_SIZE+").";return n.onEvent(new o.AudioSourceErrorEvent(t,"")),o.PromiseHelper.fromError(t)}return n.onEvent(new o.AudioSourceInitializingEvent(n.privId)),n.onEvent(new o.AudioSourceReadyEvent(n.privId)),o.PromiseHelper.fromResult(!0)},this.id=function(){return n.privId},this.attach=function(e){return n.onEvent(new o.AudioStreamNodeAttachingEvent(n.privId,e)),n.upload(e).onSuccessContinueWith((function(t){return n.onEvent(new o.AudioStreamNodeAttachedEvent(n.privId,e)),{detach:function(){t.close(),delete n.privStreams[e],n.onEvent(new o.AudioStreamNodeDetachedEvent(n.privId,e)),n.turnOff()},id:function(){return e},read:function(){return t.read()}}}))},this.detach=function(e){e&&n.privStreams[e]&&(n.privStreams[e].close(),delete n.privStreams[e],n.onEvent(new o.AudioStreamNodeDetachedEvent(n.privId,e)))},this.turnOff=function(){for(var e in n.privStreams)if(e){var t=n.privStreams[e];t&&!t.isClosed&&t.close()}return n.onEvent(new o.AudioSourceOffEvent(n.privId)),o.PromiseHelper.fromResult(!0)},this.upload=function(t){return n.turnOn().onSuccessContinueWith((function(r){var i=new o.Stream(t);n.privStreams[t]=i;var s=new FileReader,c=0,a=e.CHUNK_SIZE;s.onload=function(t){if(!i.isClosed)if(i.writeStreamChunk({buffer:s.result,isEnd:!1,timeReceived:Date.now()}),a<n.privFile.size){c=a,a=Math.min(a+e.CHUNK_SIZE,n.privFile.size);var r=n.privFile.slice(c,a);s.readAsArrayBuffer(r)}else i.close()},s.onerror=function(e){var r="Error occurred while processing '"+n.privFile.name+"'. "+e;throw n.onEvent(new o.AudioStreamNodeErrorEvent(n.privId,t,r)),new Error(r)};var u=n.privFile.slice(c,a);return s.readAsArrayBuffer(u),i.getReader()}))},this.onEvent=function(e){n.privEvents.onEvent(e),o.Events.instance.onEvent(e)},this.privId=r||o.createNoDashGuid(),this.privEvents=new o.EventSource,this.privFile=t}return Object.defineProperty(e.prototype,"format",{get:function(){return e.FILEFORMAT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return this.privEvents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceInfo",{get:function(){return o.PromiseHelper.fromResult({bitspersample:e.FILEFORMAT.bitsPerSample,channelcount:e.FILEFORMAT.channels,connectivity:i.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:e.FILEFORMAT.samplesPerSec,type:i.type.File})},enumerable:!0,configurable:!0}),e.SAMPLE_RATE=32e3,e.CHUNK_SIZE=2*e.SAMPLE_RATE/5,e.MAX_SIZE=600*e.SAMPLE_RATE+44,e.FILEFORMAT=n.AudioStreamFormat.getWaveFormatPCM(16e3,16,1),e}();t.FileAudioSource=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=function(){function e(){var e=this;this.record=function(t,r,i){var o=function(){var e=0;try{return t.createScriptProcessor(e,1,1)}catch(n){e=2048;for(var r=t.sampleRate;e<16384&&r>=32e3;)e<<=1,r>>=1;return t.createScriptProcessor(e,1,1)}}(),s=new n.RiffPcmEncoder(t.sampleRate,16e3),c=!0;o.onaudioprocess=function(e){var t=e.inputBuffer.getChannelData(0);if(i&&!i.isClosed){var r=s.encode(c,t);r&&(i.writeStreamChunk({buffer:r,isEnd:!1,timeReceived:Date.now()}),c=!1)}};var a=t.createMediaStreamSource(r);e.privSpeechProcessorScript&&t.audioWorklet?t.audioWorklet.addModule(e.privSpeechProcessorScript).then((function(){var n=new AudioWorkletNode(t,"speech-processor");n.port.onmessage=function(e){var t=e.data;if(i&&!i.isClosed){var r=s.encode(c,t);r&&(i.writeStreamChunk({buffer:r,isEnd:!1,timeReceived:Date.now()}),c=!1)}},a.connect(n),n.connect(t.destination),e.privMediaResources={scriptProcessorNode:n,source:a,stream:r}})).catch((function(){a.connect(o),o.connect(t.destination),e.privMediaResources={scriptProcessorNode:o,source:a,stream:r}})):(a.connect(o),o.connect(t.destination),e.privMediaResources={scriptProcessorNode:o,source:a,stream:r})},this.releaseMediaResources=function(t){e.privMediaResources&&(e.privMediaResources.scriptProcessorNode&&(e.privMediaResources.scriptProcessorNode.disconnect(t.destination),e.privMediaResources.scriptProcessorNode=null),e.privMediaResources.source&&(e.privMediaResources.source.disconnect(),e.privMediaResources.stream.getTracks().forEach((function(e){return e.stop()})),e.privMediaResources.source=null))}}return e.prototype.setWorkletUrl=function(e){this.privSpeechProcessorScript=e},e}();t.PcmRecorder=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(73),o=function(){function e(e,t,r,o,s,c){var a=this;if(this.privIsDisposed=!1,this.dispose=function(){a.privIsDisposed=!0,a.privConnectionMessageAdapter&&a.privConnectionMessageAdapter.close()},this.isDisposed=function(){return a.privIsDisposed},this.state=function(){return a.privConnectionMessageAdapter.state},this.open=function(){return a.privConnectionMessageAdapter.open()},this.send=function(e){return a.privConnectionMessageAdapter.send(e)},this.read=function(){return a.privConnectionMessageAdapter.read()},!e)throw new n.ArgumentNullError("uri");if(!o)throw new n.ArgumentNullError("messageFormatter");this.privMessageFormatter=o;var u="",p=0;if(t)for(var h in t){if(h)u+=0===p&&-1===e.indexOf("?")?"?":"&",u+=h+"="+encodeURIComponent(t[h]),p++}if(r)for(var l in r){if(l)u+=0===p?"?":"&",u+=l+"="+encodeURIComponent(r[l]),p++}this.privUri=e+u,this.privId=c||n.createNoDashGuid(),this.privConnectionMessageAdapter=new i.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,s)}return Object.defineProperty(e.prototype,"id",{get:function(){return this.privId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return this.privConnectionMessageAdapter.events},enumerable:!0,configurable:!0}),e}();t.WebsocketConnection=o},function(e,t){},function(e,t){},function(e,t){},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=function(){function e(e,t){var r=this;this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.id=function(){return r.privAudioNode.id()},this.privAudioNode=e,this.privFormat=t}return e.prototype.read=function(){var e=this;if(this.privReplay&&0!==this.privBuffers.length){var t=this.privReplayOffset-this.privBufferStartOffset,r=Math.round(t*this.privFormat.avgBytesPerSec*1e-7);0!=r%2&&r++;for(var i=0;i<this.privBuffers.length&&r>=this.privBuffers[i].chunk.buffer.byteLength;)r-=this.privBuffers[i++].chunk.buffer.byteLength;var s=this.privBuffers[i].chunk.buffer.slice(r);return this.privReplayOffset+=s.byteLength/this.privFormat.avgBytesPerSec*1e7,i===this.privBuffers.length-1&&(this.privReplay=!1),n.PromiseHelper.fromResult({buffer:s,isEnd:!1,timeReceived:this.privBuffers[i].chunk.timeReceived})}return this.privAudioNode.read().onSuccessContinueWith((function(t){return t.buffer&&(e.privBuffers.push(new o(t,e.privBufferSerial++,e.privBufferedBytes)),e.privBufferedBytes+=t.buffer.byteLength),t}))},e.prototype.detach=function(){this.privAudioNode.detach(),this.privBuffers=void 0},e.prototype.replay=function(){0!==this.privBuffers.length&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)},e.prototype.shrinkBuffers=function(e){this.privLastShrinkOffset=e;for(var t=e-this.privBufferStartOffset,r=Math.round(t*this.privFormat.avgBytesPerSec*1e-7),n=0;n<this.privBuffers.length&&r>=this.privBuffers[n].chunk.buffer.byteLength;)r-=this.privBuffers[n++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-r/this.privFormat.avgBytesPerSec*1e7),this.privBuffers=this.privBuffers.slice(n)},e.prototype.findTimeAtOffset=function(e){if(e<this.privBufferStartOffset)return 0;for(var t=0,r=this.privBuffers;t<r.length;t++){var n=r[t],i=n.byteOffset/this.privFormat.avgBytesPerSec*1e7,o=i+n.chunk.buffer.byteLength/this.privFormat.avgBytesPerSec*1e7;if(e>=i&&e<=o)return n.chunk.timeReceived}return 0},e}();t.ReplayableAudioNode=i;var o=function(e,t,r){this.chunk=e,this.serial=t,this.byteOffset=r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=function(){function e(e,t,r,n){this.privProxyHostName=e,this.privProxyPort=t,this.privProxyUserName=r,this.privProxyPassword=n}return e.fromRecognizerConfig=function(t){return new e(t.parameters.getProperty(n.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(t.parameters.getProperty(n.PropertyId.SpeechServiceConnection_ProxyPort),10),t.parameters.getProperty(n.PropertyId.SpeechServiceConnection_ProxyUserName),t.parameters.getProperty(n.PropertyId.SpeechServiceConnection_ProxyPassword))},Object.defineProperty(e.prototype,"HostName",{get:function(){return this.privProxyHostName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Port",{get:function(){return this.privProxyPort},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UserName",{get:function(){return this.privProxyUserName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Password",{get:function(){return this.privProxyPassword},enumerable:!0,configurable:!0}),e}();t.ProxyInfo=i},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=[];return{push:function(r){if(e){var n=e.resolve;e=null,n(r)}else t.push(r)},shift:function(){return t.length?Promise.resolve(t.shift()):(e||(e=(0,i.default)())).promise}}};var i=n(r(200))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(28)),o=n(r(30)),s=function(){function e(){(0,i.default)(this,e),this._phrases=[]}return(0,o.default)(e,[{key:"addFromString",value:function(){throw new Error("JSGF is not supported")}},{key:"phrases",get:function(){return this._phrases},set:function(e){if(Array.isArray(e))this._phrases=e;else{if("string"!=typeof e)throw new Error("The provided value is not an array or of type 'string'");this._phrases=[e]}}}]),e}();t.default=s},function(e,t,r){"use strict";const{AbortController:n,AbortSignal:i}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;e.exports=n,e.exports.AbortSignal=i,e.exports.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=new Event("error");return t.error=e,t}},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=[],t={cancelAll:function(){e.forEach((function(e){return(0,e.cancel)()}))},push:function(t){var r,n=(0,s.default)(),c=(0,s.default)(),a={promise:c.promise},u=a.cancel=function(){t=function(){return{result:Promise.reject(new Error("cancelled before start"))}},r&&r(),n.reject(new Error("cancelled in the midway"))},p=function(){var s=(0,o.default)(i.default.mark((function o(){var s,u,p;return i.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s=t(),u=s.abort,p=s.result,r=u,i.prev=2,i.t0=c,i.next=6,Promise.race([p,n.promise]);case 6:i.t1=i.sent,i.t0.resolve.call(i.t0,i.t1),i.next=13;break;case 10:i.prev=10,i.t2=i.catch(2),c.reject(i.t2);case 13:e=e.filter((function(e){return e!==a}));case 14:case"end":return i.stop()}}),o,null,[[2,10]])})));return function(){return s.apply(this,arguments)}}(),h=e[e.length-1],l=h&&h.promise||Promise.resolve();return e.push(a),l.catch((function(){})).then(p),{cancel:u,result:c.promise}}};return Object.defineProperty(t,"length",{get:function(){return e.length}}),t};var i=n(r(26)),o=n(r(27)),s=n(r(74))},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var n=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).signal,a=void 0===n?{aborted:!1}:n;return new Promise(function(){var n=(0,o.default)(i.default.mark((function n(o,p){var h,l,f,v,d,g,y,m;return i.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,f=function(){return(0,s.default)(r.read())},!a.aborted){n.next=4;break}throw new Error("aborted");case 4:return n.next=6,f();case 6:v=n.sent,d=0;case 8:if(v.isEnd||!(d<1e3)||a.aborted){n.next=25;break}if(!a.aborted){n.next=11;break}return n.abrupt("break",25);case 11:g=u(t,v.buffer),y=c(e,t,g),m=y.buffer.duration,h||(h=e.currentTime),y.connect(e.destination),y.start(h),l=y,h+=m;case 19:return n.next=21,f();case 21:v=n.sent,d++,n.next=8;break;case 25:if(!a.aborted){n.next=29;break}throw new Error("aborted");case 29:l?l.onended=function(){return o()}:o();case 30:n.next=35;break;case 32:n.prev=32,n.t0=n.catch(0),p(n.t0);case 35:case"end":return n.stop()}}),n,null,[[0,32]])})));return function(e,t){return n.apply(this,arguments)}}())};var i=n(r(26)),o=n(r(27)),s=n(r(206));function c(e,t,r){for(var n=t.channels,i=t.samplesPerSec,o=e.createBufferSource(),s=r.length/n,c=e.createBuffer(n,s,i),a=0;a<n;a++)for(var u=c.getChannelData(a),p=0;p<r.length;p++)u[p]=r[p*n+a];return o.buffer=c,o}function a(e,t){for(var r=new Float32Array(e.length),n=0;n<e.length;n++)r[n]=e[n]/t;return r}function u(e,t){switch(e.bitsPerSample){case 8:return a(new Int8Array(t),128);case 16:return a(new Int16Array(t),32768);case 32:return a(new Int32Array(t),2147483648);default:throw new InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return new Promise((function(t,r){return e.on(t,r)}))}},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return h.apply(this,arguments)};var i=n(r(26)),o=n(r(27)),s=r(208),c=n(r(209)),a="SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU3LjU2LjEwMQAAAAAAAAAAAAAA//tAwAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAACAAABhgC7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7u7//////////////////////////////////////////////////////////////////8AAAAATGF2YzU3LjY0AAAAAAAAAAAAAAAAJAUHAAAAAAAAAYYoRBqpAAAAAAD/+xDEAAPAAAGkAAAAIAAANIAAAARMQU1FMy45OS41VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7EMQpg8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV";function u(e,t){return new Promise((function(r,n){var i=e.decodeAudioData(t,r,n);i&&"function"==typeof i.then&&r(i)}))}function p(e,t,r){return new Promise((function(n,i){var o,s,a,u=new c.default,p=new c.default,h=(s="statechange",a=function(e){return"closed"===e.target.state&&u.eventListener()},(o=e).addEventListener(s,a),function(){return o.removeEventListener(s,a)});try{r.buffer=t,r.onended=p.eventListener,r.connect(e.destination),r.start(0),Promise.race([u.upcoming(),p.upcoming()]).then(n)}catch(e){i(e)}finally{h()}}))}function h(){return(h=(0,o.default)(i.default.mark((function e(t){var r,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.createBufferSource(),e.next=3,u(t,(0,s.decode)(a));case 3:return n=e.sent,e.next=6,p(t,n,r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(256),n=0;n<e.length;n++)r[e.charCodeAt(n)]=n;t.encode=function(t){var r,n=new Uint8Array(t),i=n.length,o="";for(r=0;r<i;r+=3)o+=e[n[r]>>2],o+=e[(3&n[r])<<4|n[r+1]>>4],o+=e[(15&n[r+1])<<2|n[r+2]>>6],o+=e[63&n[r+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,n,i,o,s,c=.75*e.length,a=e.length,u=0;"="===e[e.length-1]&&(c--,"="===e[e.length-2]&&c--);var p=new ArrayBuffer(c),h=new Uint8Array(p);for(t=0;t<a;t+=4)n=r[e.charCodeAt(t)],i=r[e.charCodeAt(t+1)],o=r[e.charCodeAt(t+2)],s=r[e.charCodeAt(t+3)],h[u++]=n<<2|i>>4,h[u++]=(15&i)<<4|o>>2,h[u++]=(3&o)<<6|63&s;return p}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(210))&&n.__esModule?n:{default:n};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defers=[],this.upcomingDeferred=null,this.eventListener=this.eventListener.bind(this),this.options=r,this.one=this.one.bind(this),this.upcoming=this.upcoming.bind(this),this[Symbol.iterator]=function(){return{next:function(){return{done:!1,value:t.upcoming()}}}}}var t,r,n;return t=e,(r=[{key:"eventListener",value:function(e){var t=this.defers.shift(),r=this.options.array?[].slice.call(arguments):e;t&&t.resolve(r),this.upcomingDeferred&&(this.upcomingDeferred.resolve(r),this.upcomingDeferred=null)}},{key:"one",value:function(){var e=(0,i.default)();return this.defers.push(e),e.promise}},{key:"upcoming",value:function(){return this.upcomingDeferred||(this.upcomingDeferred=(0,i.default)()),this.upcomingDeferred.promise}}])&&o(t.prototype,r),n&&o(t,n),e}();t.default=s,e.exports=t.default,e.exports.default=t.default},function(e,t,r){"use strict";e.exports=function(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(42)),o=n(r(28)),s=n(r(30)),c=n(r(212)),a=n(r(253)),u=n(r(76));function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(r,!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l=function(){function e(t){var r,n=this,i=t.dialogServiceConnector;(0,o.default)(this,e),this.dialogServiceConnector=i,this.activity$=(0,a.default)(new c.default((function(e){return n._activityObserver=e,r.next(0),r.next(1),r.next(2),function(){}}))),this.connectionStatus$=(0,a.default)(new c.default((function(e){return r=e,function(){}}))),i.activityReceived=function(e,t){var r=t.activity,i=t.audioStream;try{n._activityObserver&&n._activityObserver.next(h({},r,{channelData:h({},r.channelData,{},i?{utterance:new u.default(i)}:{},{directLineSpeechAudioStream:i}),from:h({},r.from,{role:"bot"}),timestamp:(new Date).toISOString()}))}catch(e){console.error(e)}}}return(0,s.default)(e,[{key:"end",value:function(){this.dialogServiceConnector.close()}},{key:"postActivity",value:function(e){try{var t=Math.random().toString(36).substr(2);return!(!e.channelData||!e.channelData.speech)||this.dialogServiceConnector.sendActivityAsync(e),this._activityObserver&&this._activityObserver.next(h({},e,{id:t,timestamp:(new Date).toISOString()})),this._lastRecognizedEventTimestamp=null,c.default.of(t)}catch(e){return new c.default((function(t){return t.error(e)}))}}}]),e}();t.default=l},function(e,t,r){r(213),r(234),r(237),r(239),r(249);var n=r(54);e.exports=n.Observable},function(e,t,r){"use strict";var n=r(77),i=r(19),o=r(224),s=r(87),c=r(15),a=r(24),u=r(226),p=r(20).f,h=r(14),l=r(227),f=r(228),v=r(229),d=r(233),g=r(9),y=r(35),m=g("observable"),S=y.get,b=y.set,R=function(e){return null==e?void 0:s(e)},w=function(e){var t=e.cleanup;if(t){e.cleanup=void 0;try{t()}catch(e){d(e)}}},C=function(e){return void 0===e.observer},P=function(e,t){if(!i){e.closed=!0;var r=t.subscriptionObserver;r&&(r.closed=!0)}t.observer=void 0},I=function(e,t){var r,n=b(this,{cleanup:void 0,observer:c(e),subscriptionObserver:void 0});i||(this.closed=!1);try{(r=R(e.start))&&r.call(e,this)}catch(e){d(e)}if(!C(n)){var o=n.subscriptionObserver=new E(this);try{var a=t(o),u=a;null!=a&&(n.cleanup="function"==typeof a.unsubscribe?function(){u.unsubscribe()}:s(a))}catch(e){return void o.error(e)}C(n)&&w(n)}};I.prototype=l({},{unsubscribe:function(){var e=S(this);C(e)||(P(this,e),w(e))}}),i&&p(I.prototype,"closed",{configurable:!0,get:function(){return C(S(this))}});var E=function(e){b(this,{subscription:e}),i||(this.closed=!1)};E.prototype=l({},{next:function(e){var t=S(S(this).subscription);if(!C(t)){var r=t.observer;try{var n=R(r.next);n&&n.call(r,e)}catch(e){d(e)}}},error:function(e){var t=S(this).subscription,r=S(t);if(!C(r)){var n=r.observer;P(t,r);try{var i=R(n.error);i?i.call(n,e):d(e)}catch(e){d(e)}w(r)}},complete:function(){var e=S(this).subscription,t=S(e);if(!C(t)){var r=t.observer;P(e,t);try{var n=R(r.complete);n&&n.call(r)}catch(e){d(e)}w(t)}}}),i&&p(E.prototype,"closed",{configurable:!0,get:function(){return C(S(S(this).subscription))}});var A=function(e){u(this,A,"Observable"),b(this,{subscriber:s(e)})};l(A.prototype,{subscribe:function(e){var t=arguments.length;return new I("function"==typeof e?{next:e,error:t>1?arguments[1]:void 0,complete:t>2?arguments[2]:void 0}:a(e)?e:{},S(this).subscriber)}}),l(A,{from:function(e){var t="function"==typeof this?this:A,r=R(c(e)[m]);if(r){var n=c(r.call(e));return n.constructor===t?n:new t((function(e){return n.subscribe(e)}))}var i=f(e);return new t((function(e){v(i,(function(t){if(e.next(t),e.closed)return v.stop()}),void 0,!1,!0),e.complete()}))},of:function(){for(var e="function"==typeof this?this:A,t=arguments.length,r=new Array(t),n=0;n<t;)r[n]=arguments[n++];return new e((function(e){for(var n=0;n<t;n++)if(e.next(r[n]),e.closed)return;e.complete()}))}}),h(A.prototype,m,(function(){return this})),n({global:!0},{Observable:A}),o("Observable")},function(e,t,r){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!n.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},function(e,t,r){var n=r(23),i=r(79),o="".split;e.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},function(e,t,r){var n=r(8),i=r(83),o=n.WeakMap;e.exports="function"==typeof o&&/native code/.test(i.call(o))},function(e,t,r){var n=r(13),i=r(218),o=r(78),s=r(20);e.exports=function(e,t){for(var r=i(t),c=s.f,a=o.f,u=0;u<r.length;u++){var p=r[u];n(e,p)||c(e,p,a(t,p))}}},function(e,t,r){var n=r(53),i=r(219),o=r(222),s=r(15);e.exports=n("Reflect","ownKeys")||function(e){var t=i.f(s(e)),r=o.f;return r?t.concat(r(e)):t}},function(e,t,r){var n=r(85),i=r(56).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},function(e,t,r){var n=r(32),i=r(86),o=r(221),s=function(e){return function(t,r,s){var c,a=n(t),u=i(a.length),p=o(s,u);if(e&&r!=r){for(;u>p;)if((c=a[p++])!=c)return!0}else for(;u>p;p++)if((e||p in a)&&a[p]===r)return e||p||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},function(e,t,r){var n=r(55),i=Math.max,o=Math.min;e.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):o(r,t)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(23),i=/#|\.prototype\./,o=function(e,t){var r=c[s(e)];return r==u||r!=a&&("function"==typeof t?n(t):!!t)},s=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},c=o.data={},a=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o},function(e,t,r){"use strict";var n=r(53),i=r(20),o=r(9),s=r(19),c=o("species");e.exports=function(e){var t=n(e),r=i.f;s&&t&&!t[c]&&r(t,c,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(23);e.exports=!!Object.getOwnPropertySymbols&&!n((function(){return!String(Symbol())}))},function(e,t){e.exports=function(e,t,r){if(!(e instanceof t))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return e}},function(e,t,r){var n=r(33);e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},function(e,t,r){var n=r(15),i=r(88);e.exports=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return n(t.call(e))}},function(e,t,r){var n=r(15),i=r(230),o=r(86),s=r(231),c=r(88),a=r(232),u=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,t,r,p,h){var l,f,v,d,g,y,m=s(t,r,p?2:1);if(h)l=e;else{if("function"!=typeof(f=c(e)))throw TypeError("Target is not iterable");if(i(f)){for(v=0,d=o(e.length);d>v;v++)if((g=p?m(n(y=e[v])[0],y[1]):m(e[v]))&&g instanceof u)return g;return new u(!1)}l=f.call(e)}for(;!(y=l.next()).done;)if((g=a(l,m,y.value,p))&&g instanceof u)return g;return new u(!1)}).stop=function(e){return new u(!0,e)}},function(e,t,r){var n=r(9),i=r(29),o=n("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||s[o]===e)}},function(e,t,r){var n=r(87);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){var n=r(15);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&n(o.call(e)),t}}},function(e,t,r){var n=r(8);e.exports=function(e,t){var r=n.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))}},function(e,t,r){r(235)("observable")},function(e,t,r){var n=r(54),i=r(13),o=r(236),s=r(20).f;e.exports=function(e){var t=n.Symbol||(n.Symbol={});i(t,e)||s(t,e,{value:o.f(e)})}},function(e,t,r){t.f=r(9)},function(e,t,r){var n=r(33),i=r(238),o=Object.prototype;i!==o.toString&&n(o,"toString",i,{unsafe:!0})},function(e,t,r){"use strict";var n=r(89),i={};i[r(9)("toStringTag")]="z",e.exports="[object z]"!==String(i)?function(){return"[object "+n(this)+"]"}:i.toString},function(e,t,r){"use strict";var n=r(240).charAt,i=r(35),o=r(90),s=i.set,c=i.getterFor("String Iterator");o(String,"String",(function(e){s(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=c(this),r=t.string,i=t.index;return i>=r.length?{value:void 0,done:!0}:(e=n(r,i),t.index+=e.length,{value:e,done:!1})}))},function(e,t,r){var n=r(55),i=r(48),o=function(e){return function(t,r){var o,s,c=String(i(t)),a=n(r),u=c.length;return a<0||a>=u?e?"":void 0:(o=c.charCodeAt(a))<55296||o>56319||a+1===u||(s=c.charCodeAt(a+1))<56320||s>57343?e?c.charAt(a):o:e?c.slice(a,a+2):s-56320+(o-55296<<10)+65536}};e.exports={codeAt:o(!1),charAt:o(!0)}},function(e,t,r){"use strict";var n=r(91).IteratorPrototype,i=r(93),o=r(47),s=r(94),c=r(29),a=function(){return this};e.exports=function(e,t,r){var u=t+" Iterator";return e.prototype=i(n,{next:o(1,r)}),s(e,u,!1,!0),c[u]=a,e}},function(e,t,r){var n=r(48);e.exports=function(e){return Object(n(e))}},function(e,t,r){var n=r(23);e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,r){var n=r(19),i=r(20),o=r(15),s=r(245);e.exports=n?Object.defineProperties:function(e,t){o(e);for(var r,n=s(t),c=n.length,a=0;c>a;)i.f(e,r=n[a++],t[r]);return e}},function(e,t,r){var n=r(85),i=r(56);e.exports=Object.keys||function(e){return n(e,i)}},function(e,t,r){var n=r(53);e.exports=n("document","documentElement")},function(e,t,r){var n=r(15),i=r(248);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(e){}return function(r,o){return n(r),i(o),t?e.call(r,o):r.__proto__=o,r}}():void 0)},function(e,t,r){var n=r(24);e.exports=function(e){if(!n(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},function(e,t,r){var n=r(8),i=r(250),o=r(251),s=r(14),c=r(9),a=c("iterator"),u=c("toStringTag"),p=o.values;for(var h in i){var l=n[h],f=l&&l.prototype;if(f){if(f[a]!==p)try{s(f,a,p)}catch(e){f[a]=p}if(f[u]||s(f,u,h),i[h])for(var v in o)if(f[v]!==o[v])try{s(f,v,o[v])}catch(e){f[v]=o[v]}}}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,r){"use strict";var n=r(32),i=r(252),o=r(29),s=r(35),c=r(90),a=s.set,u=s.getterFor("Array Iterator");e.exports=c(Array,"Array",(function(e,t){a(this,{type:"Array Iterator",target:n(e),index:0,kind:t})}),(function(){var e=u(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t,r){var n=r(9),i=r(93),o=r(14),s=n("unscopables"),c=Array.prototype;null==c[s]&&o(c,s,i(null)),e.exports=function(e){c[s][e]=!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r=[];return new Observable((function(n){return t||(t=e.subscribe({complete:function(){r.forEach((function(e){return e.complete()}))},error:function(e){r.forEach((function(t){return t.error(e)}))},next:function(e){r.forEach((function(t){return t.next(e)}))}})),r.push(n),function(){(r=r.filter((function(e){return e!==n}))).length||(t.unsubscribe(),t=null)}}))}},function(e,t,r){"use strict";var n=r(6);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t;return e.listenOnceAsync=s(e.listenOnceAsync.bind(e),(function(e,r){t=(0,o.default)();for(var n=arguments.length,i=new Array(n>2?n-2:0),c=2;c<n;c++)i[c-2]=arguments[c];return[s(e,null,(function(e){return t.resolve(e),e})),s(r,null,(function(e){return t.reject(e),error}))].concat(i)})),e.startContinuousRecognitionAsync=function(t,r){e.listenOnceAsync((function(){}),(function(e){t=null,r&&r(e)})),setTimeout((function(){r=null,t&&t()}),0)},e.stopContinuousRecognitionAsync=function(e){e&&t&&t.promise.then(e,e)},e};var i=n(r(64)),o=n(r(74));function s(e,t,r){return function(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];o=t?t.apply(void 0,(0,i.default)(o)):o;var c=e.apply(void 0,(0,i.default)(o));return r?r(c):c}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0),i=r(58);class o{static get instance(){return o.privInstance}}o.privInstance=new i.a,o.setEventSource=e=>{if(!e)throw new n.a("eventSource");o.privInstance=e}}]);